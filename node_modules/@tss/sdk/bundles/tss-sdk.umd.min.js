!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/platform-browser"),require("@angular/router"),require("@angular/forms"),require("@turf/helpers"),require("@turf/nearest-point-on-line"),require("@turf/line-split"),require("@turf/length"),require("util"),require("@turf/destination"),require("@turf/bearing"),require("@turf/distance"),require("@angular/common"),require("rxjs"),require("rxjs/operators"),require("@angular/common/http"),require("@angular/core")):"function"==typeof define&&define.amd?define("@tss/sdk",["exports","@angular/platform-browser","@angular/router","@angular/forms","@turf/helpers","@turf/nearest-point-on-line","@turf/line-split","@turf/length","util","@turf/destination","@turf/bearing","@turf/distance","@angular/common","rxjs","rxjs/operators","@angular/common/http","@angular/core"],t):t((e.tss=e.tss||{},e.tss.sdk={}),e.ng.platformBrowser,e.ng.router,e.ng.forms,e.helpers,e.nearestPointOnLine,e.lineSplit,e.length,e.util,e.destination,e.bearing,e.distance,e.ng.common,e.rxjs,e.rxjs.operators,e.ng.common.http,e.ng.core)}(this,function(e,t,r,n,p,a,f,d,o,h,g,c,i,l,y,m,s){"use strict";a=a&&a.hasOwnProperty("default")?a["default"]:a,f=f&&f.hasOwnProperty("default")?f["default"]:f,d=d&&d.hasOwnProperty("default")?d["default"]:d,h=h&&h.hasOwnProperty("default")?h["default"]:h,g=g&&g.hasOwnProperty("default")?g["default"]:g,c=c&&c.hasOwnProperty("default")?c["default"]:c;var u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function v(e,t){function r(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function b(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(i<3?o(a):3<i?o(t,r,a):o(t,r))||a);return 3<i&&a&&Object.defineProperty(t,r,a),a}function E(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function I(n,o){var i,a,s,e,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function r(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,a&&(s=2&e[0]?a["return"]:e[0]?a["throw"]||((s=a["return"])&&s.call(a),0):a.next)&&!(s=s.call(a,e[1])).done)return s;switch(a=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,a=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=o.call(n,u)}catch(t){e=[6,t],a=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}function S(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a}function P(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}var M=function(){function e(){}return Object.defineProperty(e.prototype,"hasServiceUrl",{get:function(){return Boolean(this.serviceUrl)},enumerable:!0,configurable:!0}),e}(),C={Trace:0,Debug:1,Info:2,Warn:3,Error:4,Fatal:5};function w(e){if("trace"===e)return C.Trace;if("debug"===e)return C.Debug;if("info"===e)return C.Info;if("warn"===e)return C.Warn;if("error"===e)return C.Error;if("fatal"===e)return C.Fatal;throw new Error("Unknown log type: '"+e+"'")}C[C.Trace]="Trace",C[C.Debug]="Debug",C[C.Info]="Info",C[C.Warn]="Warn",C[C.Error]="Error",C[C.Fatal]="Fatal";var T={Imperial:"imperial",Metric:"metric"},L=function(){function e(){this.autoConfig=!0,this.logEnabled=!0,this.logLevel=C.Info,this.defaultNotifyInfoMsg="Info",this.defaultNotifyWarnMsg="Warning",this.defaultNotifyErrorMsg="Error",this.defaultNotifySuccessMsg="Success",this.defaultNotifyWaitMsg="Wait",this.measurementUnit=T.Imperial}return e.moduleConfigs=[{className:"CoreConfig",injectorToken:e}],e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();function R(e,t){return typeof e===t}function O(e){return R(e,"string")}function D(r){return function(e){var t=O(r)?{className:r,injectorToken:e}:r;L.moduleConfigs.push(t)}}var _="default",j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.appId="all",e.queryProfile=!0,e.profileId=null,e.profile=null,e.defaultProfileId=_,e.allowQueryParamInjections=!0,e.continueOnAppBootstrapError=!1,e.appSettingsEndpoint="api/apps/{appId}/settings/{id}",e.appProfileEndpoint="api/apps/{appId}/profiles/{id}",e.pingEndpoint="api/ping",e.statusEndpoint="api/status",e}return v(e,t),e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("AppConfig")],e)}(M);function N(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=[];if(Array.isArray(e[0])&&(e=e[0]),e[0]=e[0]||"",e[0].match(/^[^/:]+:\/*$/)&&1<e.length){var n=e.shift();e[0]=n+e[0]}e[0].match(/^file:\/\/\//)?e[0]=e[0].replace(/^([^/:]+):\/*/,"$1:///"):e[0]=e[0].replace(/^([^/:]+):\/*/,"$1://");for(var o=0;o<e.length;o++){var i=e[o];if("string"!=typeof i)throw new TypeError("Url must be a string. Received "+i);""!==i&&(0<o&&(i=i.replace(/^[\/]+/,"")),i=o<e.length-1?i.replace(/[\/]+$/,""):i.replace(/[\/]+$/,"/"),r.push(i))}var a=r.join("/").replace(/\/(\?|&|#[^!])/g,"$1").split("?");return a.shift()+(0<a.length?"?":"")+a.join("&")}var k=new RegExp("{(.*?)}","gi"),A=new RegExp("{{(.*?)}}","gi"),F="(.*)";function U(e,t){return void 0===t&&(t=""),(e||"").replace(A,t).replace(k,t)}function x(e,t,r){return(e||"").replace(new RegExp("{{"+t+"}}","gi"),r).replace(new RegExp("{"+t+"}","gi"),r)}function G(t,r,e){return void 0===e&&(e=!1),Object.keys(r||{}).forEach(function(e){return t=x(t,e,r[e])}),e&&(t=U(t)),t}function V(e){return O(e)?e.replace(/([^:]\/)\/+/g,"$1"):e}var B="No URL configured for resource service.",H="The 'Get' method is unsupported for this resource",q="The 'Create' method is unsupported for this resource",W="",Y=function(){function e(e,t){if(this.http=e,this.config={url:null,idFieldName:"id",cleanUrl:!0},O(t)?this.config.url=t:Object.assign(this.config,t),!this.config.url)throw B}return e.prototype.getUrlWithEntity=function(e,t,r){return this.getUrlWithId(e?e[this.config.idFieldName]:null,t,r)},e.prototype.getUrlWithId=function(e,t,r){var n={};return n[this.config.idFieldName]=e,this.getUrl(t,Object.assign(n,r))},e.prototype.getUrl=function(e,t){var r=e?N(this.config.url,e):this.config.url;return this.replaceTokens(r,t)},e.prototype.replaceTokens=function(e,t){return t=t||{},this.config.defaultRouteTokens&&(t=Object.assign({},this.config.defaultRouteTokens,t)),e=G(e,t,!0),this.config.cleanUrl&&(e=V(e)),e},e}(),Q=function(n){function e(e,t){var r=n.call(this,e,t.serviceUrl)||this;return r.appConfig=t,r}return v(e,n),e.prototype.ping=function(e,t){var r=this.getUrl(this.appConfig.pingEndpoint,e);return this.http.get(r,{params:t})},e.prototype.status=function(e,t){var r=this.getUrl(this.appConfig.pingEndpoint,e);return this.http.get(r,{params:t})},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:j}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(j))},token:e,providedIn:"root"}),e}(Y),z=function(){function e(e){this.config=e,this.logs=[]}return Object.defineProperty(e.prototype,"level",{get:function(){return this.config.logLevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this.config.logEnabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTrace",{get:function(){return this.level>=C.Trace},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDebug",{get:function(){return this.level>=C.Debug},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWarn",{get:function(){return this.level>=C.Warn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isError",{get:function(){return this.level>=C.Error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFatal",{get:function(){return this.level>=C.Fatal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"traceCount",{get:function(){return this.count("trace")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debugCount",{get:function(){return this.count("debug")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"warnCount",{get:function(){return this.count("warn")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorCount",{get:function(){return this.count("error")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fatalCount",{get:function(){return this.count("fatal")},enumerable:!0,configurable:!0}),e.prototype.count=function(e){return this.logsByType(e).length},e.prototype.logsByType=function(e){return this.logsByLevel(w(e))},e.prototype.logsByLevel=function(t){return this.logs.filter(function(e){return e.level===t})},e.prototype.logEntry=function(e){return this.config.logEnabled&&e.level>=this.config.logLevel&&(this.logs.push(e),this.isDebug&&console.log(C[e.level]+": "+e.msg+" "+(e.error||""))),e},e.prototype.log=function(e,t,r){return void 0===r&&(r=null),this.logEntry({msg:G(e,{error:r}),level:t,error:r,created:new Date})},e.prototype.trace=function(e){return this.log(e,C.Trace)},e.prototype.debug=function(e){return this.log(e,C.Debug)},e.prototype.info=function(e){return this.log(e,C.Info)},e.prototype.warn=function(e,t){return void 0===t&&(t=null),this.log(e,C.Warn,t)},e.prototype.error=function(e,t){return void 0===t&&(t=null),this.log(e,C.Error,t)},e.prototype.fatal=function(e,t){return void 0===t&&(t=null),this.log(e,C.Fatal,t)},e.prototype.clear=function(){this.logs.length=0},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:L}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(L))},token:e,providedIn:"root"}),e}();function K(e){e=e||"";var t=encodeURIComponent(e).match(/%[89ABab]/g);return e.length+(t?t.length:0)}var X=["Bytes","KB","MB","GB","TB"];function $(e){return!R(e,"undefined")}function J(e){return $(e)&&null!==e&&""!==e}function Z(e,t,r){void 0===r&&(r=!1);var n=0;if(!e)return"0 KB";for(;1024<=e&&++n;)e/=1024;return J(t)||(t=10<=e||n<1?0:1),e.toFixed(t)+" "+(r?X[n].toLowerCase():X[n])}var ee=function(){function e(){this.keyPrefix="",this.keySuffix=""}return e.prototype.has=function(e){return Boolean(this.get(e))},e.prototype.size=function(e){return K(this.get(e))+K(e)},e.prototype.sizeFormatted=function(e){return Z(this.size(e))},e.prototype.getObject=function(e){var t=this.get(e);return t?JSON.parse(t):null},e.prototype.setObject=function(e,t){this.set(e,JSON.stringify(t))},e.prototype.formatKey=function(e){return""+this.keyPrefix+e+this.keySuffix},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return localStorage.length},enumerable:!0,configurable:!0}),t.prototype.get=function(e){return localStorage.getItem(this.formatKey(e))},t.prototype.set=function(e,t){localStorage.setItem(this.formatKey(e),t)},t.prototype.remove=function(e){localStorage.removeItem(this.formatKey(e))},t.prototype.clear=function(){localStorage.clear()},t.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=s.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(ee);function re(){return"undefined"!=typeof window}function ne(){return re()?location.href:""}function oe(e){var t;return(e=e||ne())&&(t=e.slice(e.indexOf("?")+1).split("&"))&&t.length&&t[0]&&(1!==t.length||String(t[0]).includes("="))?t.reduce(function(e,t){var r,n=S(t.split("="),2),o=n[0],i=n[1];return Object.assign(e,((r={})[o]=decodeURIComponent(i),r))},{}):{}}function ie(e){return e[e.length-1]}function ae(e){var t=V(e).split("#"),r=1<t.length?ie(t):null;return r&&"/"!==r?r.split("/").filter(function(e){return Boolean(e)&&!e.includes("=")}):[]}function se(e){return S(ae(e),1)[0]||null}function ue(e){return e instanceof Date}function ce(e){return!J(e)}function le(e){return isNaN(Number(e))}function pe(e){return!le(e)}function fe(e){return ce(e)?e:"true"===e||"false"===e?Boolean(e):pe(e)?Number(e):e}function de(e){return String(e).charAt(0).toLowerCase()+e.slice(1)}function he(e,t,r){if(e){var n=t.split(/\./);n.length<2?e[n[0]]=r:(e[n[0]]||(e[n[0]]={}),he(e=e[n.shift()],n.join("."),r))}}var ge=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rolesEnabled=!0,e.storeToken=!0,e.autoSignIn=!0,e.authorizationType="Bearer",e.tokenEndpoint="token",e.signOutEndpoint="api/account/signout",e.userInfoEndpoint="api/account/userinfo",e.usersEndpoint="api/users/{id}",e.rolesEndpoint="api/roles/{id}",e.privilegesEndpoint="api/privileges/{id}",e.userRolesEndpoint="api/users/{userId}/roles/{roleName}",e.rolesPrivilegesEndpoint="api/roles/{roleId}/privileges/{privilegeId}",e.tokenStorageKey="__tss_token",e.tokenInvalidationDateLookup="__tss_token_invalidate_date",e.tdsTokenInclusionExpression="/api/",e.withCredentialsInclusionExpression="(.*?)",e.setWithCredentials=!1,e.accessToken=null,e.defaultUserName=null,e.defaultPassword=null,e.roleSplitterExp="[,|]+",e.tokenBody=function(e,t){return"grant_type=password&username="+e+"&password="+t},e}return v(e,t),e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("SecurityConfig")],e)}(M);function ye(e){return Array.isArray(e)}function me(e){return R(e,"number")}var ve=function(){function e(e){this.config=e,this.roles=new Set,this.roleSplitterExpr=new RegExp(this.config.roleSplitterExp)}return Object.defineProperty(e.prototype,"enabled",{get:function(){return this.config.rolesEnabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roleCount",{get:function(){return this.roles.size},enumerable:!0,configurable:!0}),e.prototype.getRoles=function(){return Array.from(this.roles)},e.prototype.setRoles=function(e){this.clearRoles(),this.addRoles(e)},e.prototype.addRoles=function(e){O(e)&&e.includes(",")&&(e=this.toArray(e)),ye(e)?e.forEach(this.addRole,this):this.addRole(e)},e.prototype.addRole=function(e){this.roles.add(String(e).trim())},e.prototype.clearRoles=function(){this.roles.clear()},e.prototype.hasRole=function(e){return!this.enabled||!!J(e)&&this.hasRoles(String(e))},e.prototype.hasRoles=function(e){var t;return!this.enabled||!!J(e)&&(t=this.toArray(e),String(e).includes(",")?this.hasAllRoles(t):this.hasAnyRoles(t))},e.prototype.hasAllRoles=function(e){return!this.enabled||!!J(e)&&this.toStringArray(e).every(this.forRealHasRole.bind(this))},e.prototype.hasAnyRoles=function(e){return!this.enabled||!!J(e)&&this.toStringArray(e).some(this.forRealHasRole.bind(this))},e.prototype.forRealHasRole=function(e){return this.roles.has(String(e).trim())},e.prototype.toStringArray=function(e){var t=[];return O(e)?t=this.toArray(e):me(e)?t.push(String(e)):t=e,t},e.prototype.toArray=function(e){return String(e).split(this.roleSplitterExpr)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:ge}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(ge))},token:e,providedIn:"root"}),e}(),be={SignedIn:0,SignedOut:1,SignInFailed:2,SignOutFailed:3};be[be.SignedIn]="SignedIn",be[be.SignedOut]="SignedOut",be[be.SignInFailed]="SignInFailed",be[be.SignOutFailed]="SignOutFailed";var Ee=function(){function e(e,t,r,n,o){this.http=e,this.roleMgr=t,this.config=r,this.storage=n,this.log=o,this.stateChangeSubject=new l.Subject,this.rememberMe=r.storeToken,this.stateChange=this.stateChangeSubject.asObservable(),r.autoSignIn&&!this.isAuthenticated&&this.loadStoredToken()}return e.prototype.signIn=function(e,t,r){void 0===r&&(r=this.rememberMe);var n=this.http.post(this.config.serviceUrl+"/"+this.config.tokenEndpoint,this.config.tokenBody(e,t)).pipe(y.publishReplay(1));return this.rememberMe=r,n.subscribe(this.onSignedIn.bind(this),this.onSignInFailed.bind(this)),n},e.prototype.signOut=function(){var e=this.config.serviceUrl+"/"+this.config.signOutEndpoint;if(!this.isFederatedAccount){var t=this.http.get(e).pipe(y.publishReplay(1));return t.subscribe(this.onSignedOut.bind(this),this.onSignedOutFailed.bind(this)),t}this.log.info("Signing out. Authentication Type: STS. Forwarded to: "+e),this.onSignedOut(),"undefined"!=typeof location&&(location.href=e)},e.prototype.getUserInfo=function(){return this.http.get(this.config.serviceUrl+"/"+this.config.userInfoEndpoint)},e.prototype.getToken=function(){return this.isAuthenticated&&this.account.access_token||null},e.prototype.loadStoredToken=function(){var e=this.getLocalToken(),t=!1;e&&e[".expires"]&&(e[".expires"]>new Date&&(this.onSignedIn(e,!0),t=!0));return t},e.prototype.onSignedIn=function(e,t){void 0===t&&(t=!1),this.account=e,this.isAuthenticated=!0,this.isDomainAccount="domain"===(e.foundContextType||"").toLowerCase(),this.isFederatedAccount="federation"===(e.authenticationType||"").toLowerCase(),this.config.accessToken=e.access_token,this.roleMgr.setRoles(e.privileges||e.roles),!t&&this.rememberMe&&(e.lastSignIn=new Date,this.setLocalToken(e)),this.log.debug("User signed in succesfully"),this.stateChangeSubject.next(be.SignedIn)},e.prototype.onSignedOut=function(){this.isAuthenticated=!1,this.isDomainAccount=!1,this.isFederatedAccount=!1,this.account=null,this.roleMgr.clearRoles(),this.setLocalToken(null),this.log.debug("User signed out succesfully"),this.stateChangeSubject.next(be.SignedOut)},e.prototype.onSignInFailed=function(e){this.log.error("Failed to sign in",e),this.stateChangeSubject.next(be.SignInFailed)},e.prototype.onSignedOutFailed=function(e){this.log.error("Failed to sign out",e),this.stateChangeSubject.next(be.SignOutFailed)},e.prototype.getLocalToken=function(){try{var e=this.storage.getObject(this.config.tokenStorageKey);return e&&e.lastSignIn&&O(e.lastSignIn)&&(e.lastSignIn=new Date(e.lastSignIn)),e&&e[".expires"]&&O(e[".expires"])&&(e[".expires"]=new Date(Date.parse(e[".expires"]))),e}finally{}},e.prototype.setLocalToken=function(e){try{e?this.storage.setObject(this.config.tokenStorageKey,e):this.storage.remove(this.config.tokenStorageKey)}finally{}},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:ve},{type:ge},{type:te},{type:z}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(ve),s.inject(ge),s.inject(te),s.inject(z))},token:e,providedIn:"root"}),e}(),Ie=function(n){function e(e,t){var r=n.call(this,e,t)||this;return r.http=e,r}return v(e,n),e.prototype.query=function(e,t){var r=this.getUrl(this.config.queryEndpoint,e);return this.http.get(r,{params:t})},e.prototype.get=function(e,t,r){var n=this.getUrlWithId(e,this.config.getEndpoint,t);return this.http.get(n,{params:r})},e.prototype.create=function(e,t,r){var n=this.getUrl(this.config.createEndpoint,t);return this.http.post(n,e,{params:r})},e.prototype.update=function(e,t,r){var n=this.getUrlWithEntity(e,this.config.updateEndpoint,t);return this.http.put(n,e,{params:r})},e.prototype["delete"]=function(e,t,r){var n=this.getUrlWithId(e,this.config.deleteEndpoint,t);return this.http["delete"](n,{params:r})},e}(Y),Se=function(n){function e(e,t){var r=n.call(this,e,{url:N(t.serviceUrl,t.appProfileEndpoint),defaultRouteTokens:{appId:t.appId}})||this;return r.http=e,r}return v(e,n),e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:j}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(j))},token:e,providedIn:"root"}),e}(Ie),Pe=function(){function o(e,t,r,n,o,i,a,s,u){var c=this;this.router=e,this.auth=t,this.appProfiles=r,this.log=n,this.config=o,this.storage=i,this.securityConfig=a,this.roleMgr=s,this.injector=u,this.ready=!1,this.loading=!1,this.moduleConfigInstances=new Map,this.queryParameters=oe(),this.onReady=new Promise(function(e,t){c.resolveFn=e,c.rejectFn=t})}return o.prototype.initialize=function(){var t=this,e=this.config.appId,r=S(this.router.url.split("/"),1)[0],n=this.queryParameters.profileId||r||se(ne())||this.config.defaultProfileId;this.overrideModuleConfigurationsFromQueryParams(),this.log.debug("Initializing application with profile ID: "+n),this.auth.loadStoredToken(),this.populateModuleConfigInstances(),this.config.queryProfile&&this.config.hasServiceUrl?(this.loading=!0,this.queryProfile(n).then(function(e){return t.resolveFn(e)})["catch"](function(e){t.config.continueOnAppBootstrapError?t.resolveFn(t.config.profile):t.rejectFn(e)})):(this.config.profile={name:"",appId:e,id:n},this.log.debug(this.config.hasServiceUrl?"Profile query skipped due to configuration option":"No service URL configured, can't retrieve profile details - skipping profile retrieval"),this.overrideModuleConfigurationsFromQueryParams(),this.ready=!0,this.resolveFn(this.config.profile))},o.prototype.queryProfile=function(n){var o=this;return new Promise(function(t,r){o.appProfiles.get(n).subscribe(function(e){if(!e)return r("No profile found with ID '"+n+"'");o.config.profileId=e.id,o.config.profile=e,o.checkTokenInvalidationDate(),o.applyModuleConfigurations(),o.overrideModuleConfigurationsFromQueryParams(),o.retrieveUserAccount().then(function(){o.configureRoleManager(),o.ready=!0,o.loading=!1,t(e)})["catch"](function(e){o.loading=!1,r(e)})},function(e){o.loading=!1,o.log.error("Failed to retrieve application profile with app ID '"+o.config.appId+"' and ID '"+n+"'"),r(e)})})},o.prototype.getCachedTokenInvalidationDate=function(){return new Date(this.storage.get(this.securityConfig.tokenInvalidationDateLookup))},o.prototype.setCachedTokenExpireDate=function(e){this.log.debug("Setting cached token invalidation date: "+e),e?(this.log.debug("Setting token invalidation date to: "+e),this.storage.set(this.securityConfig.tokenInvalidationDateLookup,e)):this.storage.remove(this.securityConfig.tokenInvalidationDateLookup)},o.prototype.checkTokenInvalidationDate=function(){var e,t=this.config.profile&&this.config.profile.app&&this.config.profile.app.siteInfo?this.config.profile.app.siteInfo:null;if(t&&t[o.tokenExpireDateKey]){var r=this.getCachedTokenInvalidationDate();e=new Date(t[o.tokenExpireDateKey]);var n=ue(r)&&ue(e)?r.setMilliseconds(0)===e.setMilliseconds(0):r===e;this.auth.account&&this.auth.account.lastSignIn<e&&!n?(this.log.info("Signing out user due to token invalidation date from security configuration"),this.auth.onSignedOut()):this.auth.account&&this.log.debug("User has been authenticated after the token invalidation date"),e&&this.setCachedTokenExpireDate(e)}},o.prototype.retrieveUserAccount=function(){var i=this;return new Promise(function(r,t){try{var e=!1,n=i.config.profile&&i.config.profile.app?i.config.profile.app:null;n&&n.security&&!i.auth.isAuthenticated&&n.security.isAuthenticated?(i.log.debug("Retrieving additional user info do to authentication state"),e=!0,i.auth.getUserInfo().subscribe(function(e){var t=new Date;t.setDate(t.getDate()+n.security.accessTokenExpireDays),i.auth.onSignedIn(Object.assign({".expires":t},e)),r(e)},function(e){t(e)})):i.auth.isAuthenticated&&n.security&&!n.security.isAuthenticated&&(i.log.debug("Signing out user do to out of sync authentication state"),i.auth.onSignedOut()),e||(i.log.debug("No request made for additional user account info"),r(i.auth.account))}catch(o){i.log.error("Failed to do pre-verification of user on app load. {0}",o),t(o)}})},o.prototype.applyModuleConfigurationsFromObject=function(a){var s=this;a=a||{},this.moduleConfigInstances.forEach(function(e){var o=e.config.className,i=e.instance;Object.keys(a).forEach(function(e){var t=fe(a[e]),r=de(o+"."),n=e.replace(r,"");J(t)&&e.toLowerCase().startsWith(r.toLowerCase())&&(s.log.debug("Setting "+o+" property '"+n+"' to "+t),he(i,n,t))})})},o.prototype.applyModuleConfigurations=function(){var e=this.config.profile;e&&e.app&&e.app.siteInfo&&this.applyModuleConfigurationsFromObject(e.app.siteInfo)},o.prototype.overrideModuleConfigurationsFromQueryParams=function(){this.config.allowQueryParamInjections&&this.applyModuleConfigurationsFromObject(this.queryParameters)},o.prototype.populateModuleConfigInstances=function(){var n=this;L.moduleConfigs.forEach(function(e){try{var t=n.injector.get(e.injectorToken);n.moduleConfigInstances.set(e.injectorToken,{instance:t,config:e}),n.log.debug("Created module configuration instance for: "+e.className),("serviceUrl"in t||"hasServiceUrl"in t)&&(t.serviceUrl=n.config.serviceUrl)}catch(r){n.log.error("Failed to get module config: "+e.className,r)}})},o.prototype.configureRoleManager=function(){var e=this.config.profile&&this.config.profile.app&&this.config.profile.app.security?this.config.profile.app.security:null;e&&(e.hasOwnProperty("enabled")&&(this.securityConfig.rolesEnabled=!!e.enabled),this.roleMgr.enabled||this.log.warn("Security is disabled"),e.guestPrivileges=e.guestPrivileges||[],this.roleMgr.addRoles(e.guestPrivileges),this.log.info("Configured default roles (guest roles) - total of "+e.guestPrivileges.length),this.log.info("User has a total of "+this.roleMgr.roleCount+" roles assigned to them"))},o.tokenExpireDateKey="token-expire-date",o.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],o.ctorParameters=function(){return[{type:r.Router},{type:Ee},{type:Se},{type:z},{type:j},{type:te},{type:ge},{type:ve},{type:s.Injector}]},o.ngInjectableDef=s.defineInjectable({factory:function(){return new o(s.inject(r.Router),s.inject(Ee),s.inject(Se),s.inject(z),s.inject(j),s.inject(te),s.inject(ge),s.inject(ve),s.inject(s.INJECTOR))},token:o,providedIn:"root"}),o}();function Me(t){return function(){var e=t.get(Pe);return e.initialize(),e.onReady}}var Ce=function(){function e(){}return e.prototype.transform=function(t){var r=[];return Object.keys(t).forEach(function(e){return r.push({key:e,value:t[e]})}),r},e.decorators=[{type:s.Pipe,args:[{name:"keys"}]}],e}(),we=function(){function e(){}return e.prototype.transform=function(e){return void 0===e&&(e=0),Z(e)},e.decorators=[{type:s.Pipe,args:[{name:"fileSize"}]}],e}(),Te="timestamp '{date}'",Le="TO_DATE('{date}','YYYY-MM-DD HH24:MI:SS')",Re="yyyy-MM-dd HH:mm:ss",Oe=24,De=60,_e=1e3,je=6e4,Ne=36e5,ke=864e5,Ae={ms:"ms",msDecimalPlaces:0,sec:"sec",secDecimalPlaces:0,min:"min",minDecimalPlaces:2,hr:"hr",hrDecimalPlaces:2,days:"days",daysDecimalPlaces:2};function Fe(e,t){var r;if("milliseconds"===t)r=1;else if("seconds"===t)r=_e;else if("minutes"===t)r=je;else if("hours"===t)r=Ne;else{if("days"!==t)throw new Error("Unsuported unit of time supplied: '"+t+"'");r=ke}return(e||0)*r}function Ue(e){return e/_e}function xe(e){return e/je}function Ge(e){return e/Ne}function Ve(e){return e/ke}function Be(e,t){void 0===t&&(t={});var r,n,o=e<_e,i=e<je-1,a=e<Ne-299,s=e<ke-18e3,u=e;if(t=t?Object.assign({},Ae,t):Ae,o)r=t.ms,u=e,n=t.msDecimalPlaces;else if(i){var c=Ue(e);r=t.sec,u=c,n=t.secDecimalPlaces}else if(a){var l=xe(e);r=t.min,u=l,n=t.minDecimalPlaces}else if(s){var p=Ge(e);r=t.hr,u=p,n=t.hrDecimalPlaces}else{var f=Ve(e);r=t.days,u=f,n=t.daysDecimalPlaces}return Number(u.toFixed(n))+" "+r}var He=function(){function e(){}return e.prototype.transform=function(e,t){return void 0===t&&(t="milliseconds"),Be(Fe(e,t))},e.decorators=[{type:s.Pipe,args:[{name:"readableTime"}]}],e}(),qe=function(){function e(e){this.sanitizer=e}return e.prototype.transform=function(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)},e.decorators=[{type:s.Pipe,args:[{name:"safeUrl"}]}],e.ctorParameters=function(){return[{type:t.DomSanitizer}]},e}(),We=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[],declarations:[we,Ce,He,qe],exports:[we,Ce,He,qe],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),Ye=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,We],declarations:[],exports:[],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),Qe=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,We,m.HttpClientModule],declarations:[],exports:[],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),ze=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[We,Qe],declarations:[],exports:[],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),Ke=[{alias:"Single Value",renderType:"simple",description:"Displays a single symbology, regardless of values"},{alias:"Unique Value",renderType:"uniqueValue",description:"Displays different symbologies based on a unique value"},{alias:"Class Break",renderType:"classBreaks",description:"Displays different symbologies based on a classification of values"}],Xe=function(){function e(){}return e.prototype.transform=function(e){var t=O(e)?e:e.type;return Ke.find(function(e){return e.renderType===t}).alias},e.decorators=[{type:s.Pipe,args:[{name:"layerRendererType"}]}],e}(),$e=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,We],declarations:[Xe],exports:[Xe],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),Je=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,We,Qe,m.HttpClientModule],declarations:[],exports:[],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),Ze=function(){function e(e){this.config=e}return e.prototype.intercept=function(e,t){var r=new RegExp(this.config.withCredentialsInclusionExpression);return this.config.accessToken&&new RegExp(this.config.tdsTokenInclusionExpression).test(e.url)?e=e.clone({withCredentials:this.config.setWithCredentials&&r.test(e.url),setHeaders:{Authorization:this.config.authorizationType+" "+this.config.accessToken}}):this.config.setWithCredentials&&r.test(e.url)&&(e=e.clone({withCredentials:!0})),t.handle(e)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:ge}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(ge))},token:e,providedIn:"root"}),e}(),et=function(){function e(e,t,r,n){this.templateRef=e,this.viewContainer=t,this.roleMgr=r,this.log=n}return Object.defineProperty(e.prototype,"hasRoles",{set:function(e){this.roleMgr.hasRoles(e)?(this.viewContainer.createEmbeddedView(this.templateRef),this.log.trace("Granted access: "+e)):(this.viewContainer.clear(),this.log.trace("Denied access: "+e))},enumerable:!0,configurable:!0}),e.decorators=[{type:s.Directive,args:[{selector:"[hasRoles]"}]}],e.ctorParameters=function(){return[{type:s.TemplateRef},{type:s.ViewContainerRef},{type:ve},{type:z}]},e.propDecorators={hasRoles:[{type:s.Input}]},e}(),tt=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,m.HttpClientModule,n.FormsModule,We],declarations:[et],exports:[et],providers:[{provide:m.HTTP_INTERCEPTORS,useClass:Ze,multi:!0}],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),rt=function(){function e(){}return e.prototype.preventDefault=function(e){this.href.length||e.preventDefault()},e.decorators=[{type:s.Directive,args:[{selector:"[href]"}]}],e.propDecorators={href:[{type:s.Input}],preventDefault:[{type:s.HostListener,args:["click",["$event"]]}]},e}(),nt=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[],declarations:[rt],exports:[rt],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),ot=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule],declarations:[],exports:[],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}();function it(e){return R(e,"function")}function at(e,t){var r;if(it(t))return Boolean(t(e));if(O(t)){var n=new RegExp("[*]","gi"),o=U(t,"*").replace(n,".*");r=new RegExp(o,"i")}else r=t;return r.test(e)}var st=function(){function e(){this.paramInjectionsEnabled=!0,this.paramInjectionDefitions=[]}return Object.defineProperty(e.prototype,"hasInjections",{get:function(){return Boolean(this.paramInjectionDefitions.length)},enumerable:!0,configurable:!0}),e.prototype.addOrUpdateParameterInjection=function(t,r,e){var n={route:t,paramName:r,paramValue:e},o=this.paramInjectionDefitions.find(function(e){return e.route===t&&e.paramName===r});return o?(Object.assign(o,n),o):(this.paramInjectionDefitions.push(n),n)},e.prototype.addParameterInjection=function(e,t,r){var n={route:e,paramName:t,paramValue:r};return this.paramInjectionDefitions.push(n),n},e.prototype.getInjectionDefinitions=function(t){return this.paramInjectionDefitions.filter(function(e){return at(t,e.route)})},e.prototype.getFirstInjectionDefinition=function(t){return this.paramInjectionDefitions.find(function(e){return at(t,e.route)})},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("HttpConfig")],e)}(),ut=function(){function e(e,t){this.config=e,this.log=t}return e.prototype.intercept=function(e,t){var r=this.config.paramInjectionsEnabled?this.config.getInjectionDefinitions(e.urlWithParams):[];return r.length&&(e=this.generateRequestWithParams(e,r)),t.handle(e)},e.prototype.generateRequestWithParams=function(t,e){var r=this,n=t.params;return e.forEach(function(e){r.log.debug("Injecting URL '"+t.url+"' with parameter value (name: '"+e.paramName+"')"),n=n.set(e.paramName,e.paramValue)}),t.clone({params:n})},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:st},{type:z}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(st),s.inject(z))},token:e,providedIn:"root"}),e}(),ct=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,m.HttpClientModule,We],declarations:[],exports:[],providers:[{provide:m.HTTP_INTERCEPTORS,useClass:ut,multi:!0}],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),lt=Me,pt=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[m.HttpClientModule,r.RouterModule,We,nt,ct,Qe,ot,tt],declarations:[],exports:[],providers:[Se,Q,Pe,{provide:s.APP_INITIALIZER,useFactory:lt,multi:!0,deps:[s.Injector]}],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),ft=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[pt,ze,Ye,$e,Je],declarations:[],exports:[],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),dt=function(n){function e(e,t){var r=n.call(this,e,{url:N(t.serviceUrl,t.appSettingsEndpoint),defaultRouteTokens:{appId:t.appId}})||this;return r.http=e,r}return v(e,n),e.prototype.queryAllApps=function(e,t){return(e=e||{}).appId="all",n.prototype.query.call(this,e,t)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:j}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(j))},token:e,providedIn:"root"}),e}(Ie),ht={NetworkFirst:"network-first",CacheFirst:"cache-first",Fastest:"fastest",CacheOnly:"cache-only"},gt=function(){function e(){this.cacheEnabled=!1,this.cacheDefitions=[],this.forcedGlobalCacheStrategy=null}var r;return(r=e).create=function(e){return Object.assign(new r,e)},e.enable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.create({cacheEnabled:!0,cacheDefitions:e})},e.prototype.getCacheDefinition=function(t){return this.cacheDefitions.find(function(e){return at(t,e.route)})},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=r=b([D("CacheConfig")],e)}(),yt="No cache available",mt="http-cache:",vt=function(t){function e(){var e=t.call(this)||this;return e.keyPrefix=mt,e}return v(e,t),e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(te),bt=function(){function e(e){this.cache=e}return e.prototype.get=function(e){var t,r=this.cache.getObject(e),n=new Date;return r&&r.expires&&r.expires.getTime()<n.getTime()?this.cache.remove(e):t=r?Object.assign(new m.HttpResponse,r.value):null,t},e.prototype.set=function(e,t,r){void 0===r&&(r=null);var n={expires:r?this.getExpireDate(r):null,value:t};this.cache.setObject(e,n)},e.prototype.has=function(e){return this.cache.has(e)},e.prototype.getExpireDate=function(e){void 0===e&&(e=null);var t=new Date;return t.setSeconds(t.getSeconds()+e),t},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:vt}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(vt))},token:e,providedIn:"root"}),e}();function Et(e){return k.test(e)}function It(e){return(e||"").replace(/{{/gi,"{").replace(/}}/gi,"}")}function St(e){return(e||"").replace(new RegExp("{","gi"),"").replace(new RegExp("}","gi"),"")}function Pt(e,t){var n={},r=U(e=It(e),F),o=new RegExp(r).exec(t);if(o&&o.length){var i=e.match(k);o.shift(),o.forEach(function(e,t){if(i[t]){var r=St(i[t]);n[r]=(e||"").replace(new RegExp("/","gi"),"")}})}return n}function Mt(e,t){var r=e.cacheId||t;Et(r)&&O(e.route)&&(r=G(r,Pt(e.route,t),!0));return r}var Ct=function(){function e(e,t,r){this.config=e,this.cache=t,this.log=r}return e.prototype.intercept=function(e,t){var r,n="GET"===e.method&&this.config.cacheEnabled;if(n){var o=(r=this.config.getCacheDefinition(e.urlWithParams))?this.config.forcedGlobalCacheStrategy||r.strategy:null;if(r&&function c(e){return e===ht.CacheFirst||e===ht.Fastest||e===ht.CacheOnly}(o)){var i=Mt(r,e.url),a=o===ht.CacheOnly,s=this.cache.get(i);if(s)return this.log.debug("Resolving HTTP request from cache: '"+e.url+"'"),l.of(s);if(a)return l.throwError(new Error(yt))}}this.log.trace("Making HTTP request: '"+e.url+"'");var u=t.handle(e);return n&&r&&(u=this.cacheResponse(u,e,r)),u},e.prototype.cacheResponse=function(e,r,t){var n=this,o=Mt(t,r.url);return e.pipe(y.tap(function(e){t&&e instanceof m.HttpResponse&&(n.log.debug("Caching HTTP request: '"+r.url+"'"),n.cache.set(o,e,t.expires))}),y.catchError(function(e){var t=n.cache.get(o);if(t)return n.log.debug("Failed to resolve cacheable HTTP request from URL '"+r.url+"', fallingback to cache"),l.of(t);throw n.log.debug("Failed to resolve cacheable HTTP request from URL '"+r.url+"' and no cached data available"),e}))},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:gt},{type:bt},{type:z}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(gt),s.inject(bt),s.inject(z))},token:e,providedIn:"root"}),e}(),wt=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,m.HttpClientModule,We],declarations:[],exports:[],providers:[gt,vt,bt,{provide:m.HTTP_INTERCEPTORS,useClass:Ct,multi:!0}],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}();function Tt(e,t){e.push.apply(e,P(t))}function Lt(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];e.forEach(function(e){var t=r.indexOf(e);-1<t&&r.splice(t,1)})}function Rt(e,t){var r=e.filter(function(e){return t(e)});Lt.apply(void 0,P([e],r))}function Ot(e){return JSON.parse(JSON.stringify(e))}function Dt(e){return"#"+((1<<24)+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1)}function _t(e){return 1-.01*e}function jt(e,t){var r=(t=t||new Date).getTime()+e;return t.setTime(r),t}function Nt(e,t){return jt(e*je,t)}function kt(e,t){return Nt(e*Oe,t)}function At(e,t){return Nt(e*De,t)}function Ft(e,t){return jt(e*_e,t)}function Ut(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())}function xt(e,t){void 0===t&&(t=Re);var r=new i.DatePipe("en-US");return t===Te||t===Le?G(t,{date:r.transform(e,Re)}):""+r.transform(e,t)}function Gt(e){return Ut(e).getTime()}function Vt(e,t){void 0===t&&(t=Re);var r=!0;t!==Te&&t!==Le||(r=!1);var n=xt(e,t);return r?"'"+n+"'":""+n}var Bt={Standardized:0,Literal:1,Oracle:2};function Ht(e,t){return t=t||new Date,Math.abs(e.getTime()-t.getTime())}function qt(e,t){return Ht(e,t)/1e3}function Wt(e){e.setHours(0,0,0,0)}Bt[Bt.Standardized]="Standardized",Bt[Bt.Literal]="Literal",Bt[Bt.Oracle]="Oracle";var Yt=function(){function e(){var e=this;this.internalConnectionChanged=new l.Subject,this.connectionChanged=this.internalConnectionChanged.asObservable(),window.addEventListener("online",function(){return e.updateOnlineStatus()}),window.addEventListener("offline",function(){return e.updateOnlineStatus()})}return Object.defineProperty(e.prototype,"isOnline",{get:function(){return!!window.navigator.onLine},enumerable:!0,configurable:!0}),e.prototype.updateOnlineStatus=function(){this.internalConnectionChanged.next(window.navigator.onLine)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),Qt=7;function zt(e,t,r){void 0===r&&(r=Qt);var n=.5*Math.pow(10,-r);return Math.abs(e-t)<n}function Kt(e,t,r,n,o){return void 0===o&&(o=Qt),zt(e,r,o)&&zt(t,n,o)}var Xt="An error occurred";function $t(e,t){return O(e=e||Xt)?G(e,{error:t?$t(t):""}):$t(e.innerException||e.InnerException||e.exceptionMessage||e.ExceptionMessage||e.message||e.Message||e.msg||e.Msg||e.error_description||e.error||e.Error||e.data||e.Data||e.exception||e.Exception)}function Jt(e,t,r){return new i.DecimalPipe("en-US").transform(e,t,r)}var Zt=/^[a-z]|\s[a-z]/gm,er=/(?=[A-Z])/,tr=/^[\s_]+|[\s_]+$/gm,rr=/^[\s-]+|[\s-]+$/gm,nr=/[_\s]+/gm,or=/[-\s]+/gm;function ir(e){return(e||"").replace(Zt,function(e){return e.toUpperCase()})}function ar(e){return String(e).charAt(0).toUpperCase()+e.slice(1)}function sr(e,t){return void 0===t&&(t=" "),e.endsWith(t)&&(e=e.substr(0,e.length-1)),e}function ur(e,t){return void 0===t&&(t=" "),e.startsWith(t)&&(e=e.substr(1)),e}var cr=/data:([a-zA-Z0-9]+\/[a-zA-Z0-9-.+]+).*,.*/,lr="application/json",pr="text/plain";function fr(e){var t=null,r=e.match(cr);return r&&r.length&&(t=r[1]),t}function dr(e){return ie(e.split(",")).trim()}function hr(e){var t,r=dr(e),n=atob(r),o=n.length,i=Math.ceil(o/1024),a=new Array(i);for(t=0;t<i;++t){var s=1024*t,u=Math.min(s+1024,o),c=new Array(u-s),l=void 0,p=void 0;for(l=s,p=0;l<u;++p,++l)c[p]=n[l].charCodeAt(0);a[t]=new Uint8Array(c)}return a}function gr(e,t){return void 0===t&&(t=null),t=t||fr(e),new Blob(hr(e),{type:t})}function yr(e){return R(e,"object")&&!Array.isArray(e)&&J(e)}function mr(o,i,a){return void 0===a&&(a={}),yr(o)&&yr(i)&&Object.keys(i).forEach(function(e){var t,r=i[e];if(yr(r))o[e]||(o[e]={}),mr(o[e],r,a);else{var n=!0;(a.ignoreArrays&&Array.isArray(r)||it(r)&&!a.copyFunctions)&&(n=!1),n&&Object.assign(o,((t={})[e]=r,t))}}),o}function vr(r,n,o){r&&n&&(o=Object.assign({},{identifier:"id",addMissing:!0,beforeMerge:function(){return undefined},afterMerge:function(){return undefined}},o),r.forEach(function(e){var t=e[o.identifier],r=n.find(function(e){return t&&e[o.identifier]===t});r&&(!1!==o.beforeMerge(e,r)&&mr(e,r),o.afterMerge(e,r))}),o.addMissing&&n.filter(function(t){return!r.find(function(e){return t[o.identifier]&&t[o.identifier]===e[o.identifier]})}).forEach(function(e){return r.push(e)}))}var br=function(){function e(e,t,r){void 0===r&&(r={logErrors:!0}),this.notify=e,this.log=t,this.config=r,this.eventWatchers=[]}return e.prototype.wait=function(e,t,r){return this.waitResponse=this.notify.wait(e,t,r),this.emit("wait"),this},e.prototype.waitIf=function(e,t,r,n){return(it(e)?e():Boolean(e))?this.wait(t,r,n):this},e.prototype.success=function(e,t,r){return this.config.showSuccess=!0,this.config.successMsg=e,this.config.successTitle=t,this.config.successConfiguration=r,this.emit("success"),this},e.prototype.error=function(e,t,r){return this.config.showError=!0,this.config.errorMsg=e,this.config.errorTitle=t,this.config.errorConfiguration=r,this.emit("error"),this},e.prototype.warn=function(e,t,r){return this.config.showWarn=!0,this.config.warnMsg=e,this.config.warnTitle=t,this.config.warnConfiguration=r,this.emit("warn"),this},e.prototype.info=function(e,t,r){return this.config.showInfo=!0,this.config.infoMsg=e,this.config.infoTitle=t,this.config.infoConfiguration=r,this.emit("info"),this},e.prototype["finally"]=function(e){return this.onDone=e,this.emit("finally"),this},e.prototype.on=function(e,t){this.eventWatchers.push({eventType:e,callback:t})},e.prototype.emit=function(t,r){this.eventWatchers.filter(function(e){return e.eventType===t}).forEach(function(e){return e.callback(r)})},e.prototype.done=function(e){this.waitResponse&&this.notify.clear(this.waitResponse.notifyId,this.waitResponse.containerId),this.onDone&&this.onDone(e)},e.prototype.onSuccess=function(e){this.config.showSuccess&&this.notify.success(this.config.successMsg,this.config.successTitle,this.config.successConfiguration),this.config.showInfo&&this.notify.info(this.config.infoMsg,this.config.infoTitle,this.config.infoConfiguration),this.done(e)},e.prototype.onFail=function(e){var t=e.error||e||e,r=$t(this.config.errorMsg,t);this.log&&this.config.logErrors&&this.log.error(r),this.config.showError&&this.notify.error(r,this.config.errorTitle,t,this.config.errorConfiguration),this.config.showWarn&&this.notify.warn(r,this.config.infoTitle,this.config.warnConfiguration),this.done()},e}(),Er=function(i){function e(e,t,r,n){void 0===n&&(n={});var o=i.call(this,t,r,n)||this;return o.source=e,o}return v(e,i),e.prototype.wait=function(e,t){var r=this;return i.prototype.wait.call(this,e,t),this.source=this.source.then(function(e){return r.onSuccess(e),e})["catch"](function(e){throw r.onFail(e),e}),this},e.prototype.waitIf=function(e,t,r){return i.prototype.waitIf.call(this,e,t,r)},e.prototype.success=function(e,t){return i.prototype.success.call(this,e,t)},e.prototype.error=function(e,t){return i.prototype.error.call(this,e,t)},e.prototype.warn=function(e,t){return i.prototype.warn.call(this,e,t)},e.prototype.info=function(e,t){return i.prototype.info.call(this,e,t)},e.prototype["finally"]=function(e){return i.prototype["finally"].call(this,e)},e.prototype.then=function(e){return this.source.then(e)},e.prototype["catch"]=function(e){return this.source["catch"](e)},e}(br),Ir=function(i){function e(e,t,r,n){void 0===n&&(n={});var o=i.call(this,t,r,n)||this;return o.source=e,o.source=o.source.pipe(y.tap(function(e){setTimeout(function(){return o.onSuccess(e)})},function(e){setTimeout(function(){return o.onFail(e)})})),o.config.useSingletonSubscriptionEmission&&(o.source=o.source.pipe(y.publishReplay())),o}return v(e,i),e.prototype.wait=function(e,t,r){return i.prototype.wait.call(this,e,t,r)},e.prototype.waitIf=function(e,t,r,n){return i.prototype.waitIf.call(this,e,t,r,n)},e.prototype.success=function(e,t,r){return i.prototype.success.call(this,e,t,r)},e.prototype.error=function(e,t,r){return i.prototype.error.call(this,e,t,r)},e.prototype.warn=function(e,t,r){return i.prototype.warn.call(this,e,t,r)},e.prototype.info=function(e,t,r){return i.prototype.info.call(this,e,t,r)},e.prototype["finally"]=function(e){return i.prototype["finally"].call(this,e)},e.prototype.subscribe=function(e,t,r){return this.source.subscribe(e,t,r)},e}(br),Sr={Wait:0,Success:1,Info:2,Warn:3,Error:4};Sr[Sr.Wait]="Wait",Sr[Sr.Success]="Success",Sr[Sr.Info]="Info",Sr[Sr.Warn]="Warn",Sr[Sr.Error]="Error";var Pr=function(){function e(e,t){this.config=e,this.log=t}return e.prototype.notify=function(e,t,r,n){return{}},e.prototype.clear=function(e,t){},e.prototype["with"]=function(e){return new Ir(e,this,this.log)},e.prototype.promise=function(e){return new Er(e,this,this.log)},e.prototype.wait=function(e,t,r){return void 0===t&&(t=this.config.defaultNotifyWaitMsg),this.notify(Sr.Wait,e,t,r)},e.prototype.success=function(e,t,r){return void 0===t&&(t=this.config.defaultNotifySuccessMsg),this.notify(Sr.Success,e,t,r)},e.prototype.error=function(e,t,r,n){return void 0===t&&(t=this.config.defaultNotifyErrorMsg),void 0===r&&(r=null),this.notify(Sr.Error,G(e,{error:r}),t,n)},e.prototype.warn=function(e,t,r,n){return void 0===t&&(t=this.config.defaultNotifyWarnMsg),void 0===r&&(r=null),this.notify(Sr.Warn,G(e,{error:r}),t,n)},e.prototype.info=function(e,t,r){return void 0===t&&(t=this.config.defaultNotifyInfoMsg),this.notify(Sr.Info,e,t,r)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:L},{type:z}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(L),s.inject(z))},token:e,providedIn:"root"}),e}();function Mr(e){var r=-1;e.sort(function(e,t){return!me(t.order)||e.order<t.order?r=-1:!me(e.order)||e.order>t.order?r=1:e.order===t.order&&(r=0),r})}var Cr={Ascending:0,Descending:1};function wr(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return Tr.apply(void 0,P([e,Cr.Ascending],t))}function Tr(e,a){void 0===a&&(a=Cr.Ascending);for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return e.sort(function(n,o){var i=0;return t&&t.length?t.forEach(function(e){if(0===i){var t=Lr(n,e),r=Lr(o,e);i=Rr(t,r,a)}}):i=Rr(n,o,a),i}),e}function Lr(e,t){return it(t)?t(e):e[t]}function Rr(e,t,r){return r===Cr.Ascending?function i(e,t){e=Or(e),t=Or(t);var r=O(e)?e.toUpperCase():e,n=O(t)?t.toUpperCase():t,o=0;r<n?o=-1:n<r&&(o=1);return o}(e,t):function a(e,t){var r=O(e)?e.toUpperCase():e,n=O(t)?t.toUpperCase():t,o=0;n<r?o=-1:r<n&&(o=1);return o}(e,t)}function Or(e){return null===e||e===undefined?"":e}function Dr(e){return(e=e.filter(function(e){return me(e)})).reduce(function(e,t){return e+t},0)/e.length}function _r(e,t,r,n,o,i){return(o-e)*(n-t)-(i-t)*(r-e)}function jr(e,t,r){var n=-1;return 0<e&&(n=t/e*r),n}function Nr(e,t,r){var n=Math.min(t,r),o=Math.max(t,r);return n<=e&&e<=o}function kr(e,n){return e.reduce(function(e,t){var r=n(t);return e+(r=me(r)?r:0)},0)}Cr[Cr.Ascending]="Ascending",Cr[Cr.Descending]="Descending";var Ar=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.progressables=e||[]}return e.prototype.add=function(e){return this.progressables.push(e),this},e.prototype.getPercentComplete=function(){var e=kr(this.progressables,function(e){return e.percentComplete})/this.progressables.length;return Math.round(e)},e}();function Fr(e){return kr(e,function(e){return e})}var Ur=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cache=new Map,e}return v(e,t),Object.defineProperty(e.prototype,"length",{get:function(){return this.cache.size},enumerable:!0,configurable:!0}),e.prototype.get=function(e){return this.cache.get(this.formatKey(e))},e.prototype.set=function(e,t){this.cache.set(this.formatKey(e),t)},e.prototype.remove=function(e){this.cache["delete"](this.formatKey(e))},e.prototype.clear=function(){this.cache.clear()},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(ee);function xr(e){return(e=It(e)).match(new RegExp(k))}function Gr(e){return xr(e).map(function(e){return St(e)})}function Vr(e){return R(e,"boolean")}function Br(e){return!ye(e)}function Hr(e){return!it(e)}function qr(e){return!me(e)}function Wr(e){return Hr(e)&&this.isNotObject(e)&&Br(e)}var Yr={Foot:"foot",Degree:"degree",Radian:"radian",Mile:"mile",Meter:"meter",Kilometer:"kilometer"};var Qr=function Iu(){var e={};return e[Yr.Foot]=.3048,e[Yr.Kilometer]=1e3,e[Yr.Meter]=1,e[Yr.Mile]=1609.34,e}();function zr(e,t){var r=Qr[t];if(qr(r))throw new Error("Can not convert unsupported unit: '"+t+"'");return e*r}function Kr(e,t){var r=Qr[t];if(!me(r))throw new Error("Can not convert unsupported unit: '"+t+"'");return e/r}function Xr(e,t,r){return Kr(zr(e,t),r)}function $r(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return G(N.apply(void 0,P(t)),e)}var Jr=/(&?\w+=((?=$)|(?=&)))/g;function Zr(e){return sr(e,"/")}var en="Invalid GUID value provided";function tn(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}function rn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new RegExp("[xy]","g"),tn)}var nn=function(){function t(e){if(this.value=e||t.empty,!t.isValid(e))throw new Error(en)}return Object.defineProperty(t.prototype,"isEmpty",{get:function(){return this.value===t.empty},enumerable:!0,configurable:!0}),t.newGuid=function(){return new t(rn())},t.isValid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},t.prototype.equals=function(e){return e.toString()===this.toString()},t.prototype.toString=function(){return this.value},t.prototype.toJSON=function(){return this.value},t.empty="00000000-0000-0000-0000-000000000000",t}(),on=function(){function e(){this.violaters=[]}return Object.defineProperty(e.prototype,"failed",{get:function(){return this.ran&&!this.passed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skipped",{get:function(){return this.validationSkipped},set:function(e){this.validationSkipped=e,this.ran=!0},enumerable:!0,configurable:!0}),e.prototype.add=function(e){return e.failed&&(this.passed=!1),e.warned&&(this.warned=!0),this},e}(),an=1,sn=function(){function e(e,t){this.subChecks=[],this.description=e,this.passCheck=t,this.id=an++}return e.prototype.hasId=function(e){return this.id=e,this},e.prototype.message=function(e){return this.description=e,this},e.prototype.pass=function(e){return this.passCheck=e,this},e.prototype.fail=function(e){return this.failCheck=e,this},e.prototype.warn=function(e){return this.warnCheck=e,this},e.prototype.onlyIf=function(e){return this.onlyIfCheck=e,this},e.prototype.add=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.forEach(function(e){return t.subChecks.push(e)}),this},e.prototype.check=function(r){var n=new on;return this.onlyIfCheck&&!this.onlyIfCheck(r)?n.skipped=!0:(this.passCheck&&(n.passed=this.passCheck(r)),this.failCheck&&(n.passed=!this.failCheck(r)),this.warnCheck&&(n.warned=!this.warnCheck(r)),this.subChecks&&this.subChecks.forEach(function(e){var t=e.check(r);n.add(t)})),n},e}(),un=function(){function e(){}return e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("CsvConfig")],e)}(),cn="\r",ln=",",pn=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,We],declarations:[],exports:[],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}();function fn(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=S(e,1)[0],o="";if(n){var i=""+(t=t&&t.length?t:Object.keys(Ot(n))).join(ln),a=e.map(function(r){return t.map(function(e){var t=r[e];return $(t)?t:""}).join(ln)});o=""+i+cn+a.join(cn)}return o}function dn(e){return Boolean(e&&e.type&&String(e.type).toLowerCase().includes("linestring"))}function hn(e){return Boolean(e&&e.length&&ye(e[0])&&ye(e[0][0]))}function gn(e){if(ye(e)){var t=e;return hn(t)?t:[t]}var r=e;return"LineString"===r.type?[r.coordinates]:r.coordinates}function yn(e){var t=[];return gn(e).forEach(function(e){e.forEach(function(e){t.push(e)})}),t}function mn(e){return!(!e||!e.type)&&("Point"===e.type||"MultiPoint"===e.type)}function vn(e){var t=ye(e)?e:e.coordinates;return Boolean(t&&t.length&&ye(t[0]))}function bn(e){var t=ye(e)?e:e.coordinates;return vn(t)?t:[t]}function En(e){return!(!e||!e.type)&&("Polygon"===e.type||"MultiPolygon"===e.type)}var In=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataSourcesEndpoint="api/data/sources/{id}",e.tablesEndpoint="api/data/sources/{id}/tables",e.columnsEndpoint="api/data/sources/{id}/tables/{table}/columns/{column}/{action}",e.tableActionEndpoint="api/data/sources/{id}/tables/{table}/{action}/{subaction}",e.editDataEndpoint="api/data/sources/{id}/tables/{table}/edit",e.applyEditsEndpoint="api/data/sources/{id}/applyedits",e.attachmentsEndpoint="api/attachments/{id}/{action}",e.skipColumnQuotes=!1,e}return v(e,t),e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("DataSourceConfig")],e)}(M),Sn=function(n){function e(e,t){var r=n.call(this,e,{url:t.serviceUrl})||this;return r.http=e,r.dsConfig=t,r}return v(e,n),e.prototype.applyEdits=function(e,t){if(!e)throw new Error("Missing or invalid apply edits seed data provided");if(!e.dataSourceId)throw new Error("Missing 'dataSourceId' from the apply edits seed data");var r=this.getUrlWithId(e.dataSourceId,this.dsConfig.applyEditsEndpoint,{});return this.http.post(r,e,{params:t})},e.prototype.createRecord=function(e,t,r,n,o){var i=this.getUrlWithId(e,this.dsConfig.editDataEndpoint,{table:t});return o=(o||new m.HttpParams).set("version",n||W),this.http.post(i,r,{params:o})},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:In}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(In))},token:e,providedIn:"root"}),e}(Y),Pn={Video:"video",Image:"image",Audio:"audio",Text:"text"};function Mn(e,t){var r;return void 0===t&&(t=!0),J(r=ce(e)?"":yr(e)||ye(e)?JSON.stringify(e):e.toString())&&t?encodeURIComponent(r):r}var Cn="attachment",wn=function(n){function e(e,t){var r=n.call(this,e,{url:t.serviceUrl,queryEndpoint:t.attachmentsEndpoint,getEndpoint:t.attachmentsEndpoint,updateEndpoint:t.attachmentsEndpoint,deleteEndpoint:t.attachmentsEndpoint,createEndpoint:t.attachmentsEndpoint})||this;return r.http=e,r}return v(e,n),e.prototype.create=function(e,t,r){var n,o=this.getUrl(this.config.createEndpoint,t),i=new FormData;return n=e.type===Pn.Image&&O(e.data)?gr(e.data):e.type===Pn.Text?new Blob([e.data]):e.data,delete e.data,i.append("file",n),i.append(Cn,Mn(e)),this.http.post(o,i,{params:r,reportProgress:!0})},e.prototype.download=function(e,t,r){throw new Error("Not implemented yet")},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:In}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(In))},token:e,providedIn:"root"}),e}(Ie),Tn={SqlServer:"System.Data.SqlClient",SqlLite:"System.Data.SQLite",SqlCompactEdition:"System.Data.SqlServerCe.4.0",Oracle:"Oracle.ManagedDataAccess.Client",OracleDevArt:"Devart.Data.Oracle"},Ln=[{alias:"SQL Server",provider:Tn.SqlServer,canUseEF:!0,schedulingCompatible:!0},{alias:"SQLite",provider:Tn.SqlLite,canUseEF:!1,schedulingCompatible:!0},{alias:"SQL Server Compact Edition",provider:Tn.SqlCompactEdition,canUseEF:!0,schedulingCompatible:!1},{alias:"Oracle",provider:Tn.Oracle,canUseEF:!1,schedulingCompatible:!1},{alias:"Oracle",provider:Tn.OracleDevArt,canUseEF:!0,efOnly:!0,schedulingCompatible:!1}],Rn=[{name:"SQL Server Connection",providerName:Tn.SqlServer,connectionString:"data source=YOUR_HOST, 1433;initial catalog=YOUR_DB;persist security info=True;user id=YOUR_USER;password=YOUR_PASSWORD;MultipleActiveResultSets=true;"},{name:"SQL Server Compact (SQL CE) Connection",providerName:Tn.SqlCompactEdition,connectionString:"Data Source=|DataDirectory|\\YOUR_DB_NAME.sdf;Max Database Size=4091"},{name:"SQLite",providerName:Tn.SqlLite,connectionString:"Data Source=|DataDirectory|\\YOUR_DB_NAME.sqlite;Version=3"},{name:"Oracle Connection (without TNS names entry)",providerName:Tn.Oracle,connectionString:"Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=YOUR_HOST)(PORT=1522)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=YOUR_SERVICE)));User Id=YOUR_USER;Password=YOUR_PASSWORD;"},{name:"Oracle Connection (with TNS names entry)",providerName:Tn.Oracle,connectionString:"Data Source=YOUR_SOURCE;User Id=YOUR_USER;Password=YOUR_PASSWORD;"},{name:"Oracle Connection (without TNS names entry)",providerName:Tn.OracleDevArt,connectionString:"Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=YOUR_HOST)(PORT=1522)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=YOUR_SERVICE)));User Id=YOUR_USER;Password=YOUR_PASSWORD;"},{name:"Oracle Connection (with TNS names entry)",providerName:Tn.OracleDevArt,connectionString:"Data Source=YOUR_SOURCE;User Id=YOUR_USER;Password=YOUR_PASSWORD;"}],On=function(n){function e(e,t){var r=n.call(this,e,{url:t.serviceUrl,queryEndpoint:t.dataSourcesEndpoint,getEndpoint:t.dataSourcesEndpoint,updateEndpoint:t.dataSourcesEndpoint,deleteEndpoint:t.dataSourcesEndpoint,createEndpoint:t.dataSourcesEndpoint})||this;return r.http=e,r.dsConfig=t,r}return v(e,n),e.prototype.testConnection=function(e,t,r){throw new Error("Not implemented yet")},e.prototype.testExistingConnection=function(e,t){throw new Error("Not implemented yet")},e.prototype.getTables=function(e,t){var r=this.getUrlWithId(e,this.dsConfig.tablesEndpoint,{});return this.http.get(r,{params:t})},e.prototype.getTableDetails=function(e,t){var r=this.getUrlWithId(e,this.dsConfig.tableActionEndpoint,{action:"details"});return this.http.get(r,{params:t})},e.prototype.getColumns=function(e,t,r){var n=this.getUrlWithId(e,this.dsConfig.columnsEndpoint,{table:t});return this.http.get(n,{params:r})},e.prototype.getColumnValues=function(e,t,r,n,o){void 0===n&&(n=!1);var i=this.getUrlWithId(e,this.dsConfig.columnsEndpoint,{table:t,column:r,action:"values"});return o=(o||new m.HttpParams).set("unique",String(n)),this.http.get(i,{params:o})},e.prototype.getUniqueColumnValues=function(e,t,r,n){return this.getColumnValues(e,t,r,!0,n)},e.prototype.getRecordCount=function(e,t,r,n,o){void 0===r&&(r="1=1");var i=this.getUrlWithId(e,this.dsConfig.tableActionEndpoint,{table:t,action:"count"});return o=(o||new m.HttpParams).set("where",r).set("version",n||W),this.http.get(i,{params:o})},e.prototype.queryData=function(e,t,r,n,o,i,a,s,u){return this.querySpatialData(e,t,r,n,o,i,a,s,"json",u)},e.prototype.queryGeoJsonData=function(e,t,r,n,o,i,a,s,u){return this.querySpatialData(e,t,r,n,o,i,a,s,"geojson",u)},e.prototype.querySpatialData=function(e,t,r,n,o,i,a,s,u,c){var l=this.getUrlWithId(e,this.dsConfig.tableActionEndpoint,{table:t,action:"query/details"});return c=(c||new m.HttpParams).set("where",r||W).set("version",n||W).set("page",J(o)?String(o):W).set("pageSize",J(i)?String(i):W).set("includeGeometry",J(a)?String(a):W).set("shapeField",s||W).set("format",u||W),this.http.get(l,{params:c})},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:In}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(In))},token:e,providedIn:"root"}),e}(Ie);function Dn(e){return(e||"").split(".").slice(-1)[0]}function _n(e){var t;if(O(e))t=e;else{e&&(t=e.id)}return t}function jn(e){return e===Tn.Oracle||e===Tn.OracleDevArt}function Nn(e){return e?jn(e)?Le:Re:Te}var kn="id-string",An="geometry",Fn="globalId",Un="integer",xn="esriFieldTypeOID",Gn="esriFieldTypeString",Vn="esriFieldTypeNumber",Bn="esriFieldTypeXML",Hn="esriFieldTypeBlob",qn="esriFieldTypeDate",Wn="esriFieldTypeDouble",Yn="esriFieldTypeGUID",Qn="esriFieldTypeGeometry",zn="esriFieldTypeGlobalID",Kn="esriFieldTypeInteger",Xn="esriFieldTypeRaster",$n="esriFieldTypeSingle",Jn="esriFieldTypeSmallInteger",Zn=[{alias:"ID",isNumeric:!0,types:["id",xn]},{alias:"ID",isNumeric:!1,types:[kn]},{alias:"string",isNumeric:!1,types:["string",Gn]},{alias:"number",isNumeric:!0,types:["number",Vn]},{alias:"double",isNumeric:!0,types:["double",Wn]},{alias:"int",isNumeric:!0,types:[Un,Kn,Jn]},{alias:"date",isNumeric:!1,types:["date",qn]},{alias:"geometry",isNumeric:!1,types:[An,Qn]},{alias:"xml",isNumeric:!1,types:["xml",Bn]},{alias:"blob",isNumeric:!1,types:["blob",Hn]},{alias:"guid",isNumeric:!1,types:["guid",Yn]},{alias:"globalId",isNumeric:!1,types:[Fn,zn]},{alias:"integer",isNumeric:!0,types:[Un,Kn]},{alias:"raster",isNumeric:!1,types:["raster",Xn]},{alias:"single",isNumeric:!1,types:["single",$n]}];function eo(e){return"esriFieldTypeGeometry"===e||"geometry"===e}function to(e){return"esriFieldTypeOID"===e||"id"===e}function ro(e){return(e||[]).find(function(e){return eo(e.type)})}function no(e){var t=ro(e);return t?t.name:null}function oo(e){return(e||[]).find(function(e){return to(e.type)})}function io(e){var t=oo(e);return t?t.name:null}function ao(e){return Et(e)}function so(e){return O(e)?e:e.type}function uo(e){return O(e)?e:e.name}function co(t,e){return e.find(function(e){return e.name===t})||null}function lo(e,t){var r=null,n=co(e,t);return n&&n.alias&&(r=n.alias),r}function po(e){var t=so(e),r=Zn.filter(function(e){return e.isNumeric}).find(function(e){return-1<e.types.indexOf(t)});return Boolean(r)}function fo(e,t){return(!to(so(e))||!le(t))&&po(e)}var ho={Equals:"=",DoesNotEqual:"<>",GreaterThan:">",LessThan:"<",GreaterOrEqualTo:">=",LessThanOrEqualTo:"<="},go={Is:"IS",Not:"NOT",In:"IN",Like:"LIKE",Between:"BETWEEN"},yo={Wildcard:"%",Null:"NULL"},mo={And:"AND",Or:"OR"},vo={quoteFields:!0},bo=function(){function e(e){this.statements=[],this.options=Object.assign({},vo,e)}return Object.defineProperty(e.prototype,"criteriaCount",{get:function(){return this.statements.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){return this.statements.push(e),this},e.prototype.whereEqual=function(e,t){return null===t?this.whereIsNull(e.name):this.where(e.name,ho.Equals,t,fo(e,t))},e.prototype.whereLike=function(e,t){return this.add(this.formatField(e)+" "+go.Like+" '%"+t+"%'")},e.prototype.whereStartsWith=function(e,t){return this.add(this.formatField(e)+" "+go.Like+" '"+t+"%'")},e.prototype.whereEndsWith=function(e,t){return this.add(this.formatField(e)+" "+go.Like+" '%"+t+"'")},e.prototype.whereNotEqual=function(e,t){return null===t?this.whereIsNotNull(e.name):this.where(e.name,ho.DoesNotEqual,t,fo(e,t))},e.prototype.whereIsNull=function(e){return this.add(this.formatField(e)+" "+go.Is+" "+yo.Null)},e.prototype.whereIsNotNull=function(e){return this.add(this.formatField(e)+" "+go.Is+" "+go.Not+" "+yo.Null)},e.prototype.where=function(e,t,r,n){return void 0===n&&(n=!1),r=n?r:"'"+r+"'",this.add(""+this.formatField(e)+t+r),this},e.prototype.whereNumeric=function(e,t){return this.where(e,t,!0),this},e.prototype.toWhereClause=function(){return this.statements.join(" "+mo.And+" ")},e.prototype.toString=function(){return this.toWhereClause()},e.prototype.clear=function(){this.statements.length=0},e.prototype.formatField=function(e){if(e=e||"",this.options.quoteFields)return e.startsWith('"')||(e='"'+e),e.endsWith('"')||(e+='"'),e;var t=new RegExp('"',"i");return e.replace(t,"")},e}(),Eo="No LRS temporal layers supplied",Io="No LRS reference layer supplied",So="(({fromDateFieldName} IS NULL OR {fromDateFieldName} <= {dateEndOfDay}) AND ({toDateFieldName} IS NULL OR {toDateFieldName} > {date}))",Po="({fromMeasureFieldName} between {fromMeasure} and {toMeasure})",Mo="(({fromMeasureFieldName} between {fromMeasure} AND {toMeasure}) OR ({toMeasureFieldName} between {fromMeasure} AND {toMeasure}) OR ({fromMeasureFieldName} < {fromMeasure} AND {toMeasureFieldName} > {toMeasure})) AND NOT (({fromMeasureFieldName} < {fromMeasure} AND {toMeasureFieldName} <= {fromMeasure}) OR ({toMeasureFieldName} > {toMeasure} AND {fromMeasureFieldName} >= {toMeasure}))";function Co(e,t,r,n){Wt(n=Ut(n||new Date));var o=Nn(r);return G(So,{fromDateFieldName:e,toDateFieldName:t,date:Vt(n,o),dateEndOfDay:Vt(n,o)})}var wo=function(t){function e(e){return t.call(this,e)||this}return v(e,t),e.prototype.withDataSource=function(e){return this.withDataProvider(e.providerName)},e.prototype.withDataProvider=function(e){return this.sourceDbType=e,this},e.prototype.withEventLayer=function(e){return this.withTemporalLayer(e).withReferenceLayer(e)},e.prototype.withReferenceLayer=function(e){return this.referenceLayer=e,this},e.prototype.withNetworkLayer=function(e){return this.withTemporalLayer(e)},e.prototype.withTemporalLayer=function(e){return this.temporalLayer=e,this},e.prototype.withRouteId=function(e,t){return this.where(t||this.referenceLayer.routeIdFieldName,ho.Equals,e)},e.prototype.withViewDate=function(e,t,r){if(this.temporalLayer&&(t=t||this.temporalLayer.fromDateFieldName,r=r||this.temporalLayer.toDateFieldName),!Boolean(this.temporalLayer||t&&r))throw new Error(Eo);if(t&&r){var n=Co(this.formatField(t),this.formatField(r),this.sourceDbType,e);this.add(n)}return this},e.prototype.betweenMeasures=function(e,t,r,n){if(this.referenceLayer&&(r=r||this.referenceLayer.fromMeasureFieldName,n=n||this.referenceLayer.toMeasureFieldName),!Boolean(this.referenceLayer||r))throw new Error(Io);var o=G(n?Mo:Po,{fromMeasureFieldName:this.formatField(r),toMeasureFieldName:this.formatField(n),fromMeasure:e,toMeasure:t});return this.add(o)},e}(bo),To=function(){function e(e,t,r,n){this.http=e,this.config=t,this.dataConfig=r,this.log=n}return e.prototype.shouldUsePostMethod=function(e){return"force-post"===this.config.arcgisQueryMethodStrategy||JSON.stringify(e||"").length>this.config.arcgisMaxWhereLengthGetThreshold},e.prototype.handleEsriResponseError=function(e,t){var r=e;if(r&&r.error){var n=new Error("Failed to query map service: "+r.error.message);throw this.log.error("Failed to execute map service request: "+t,n),n}},e.prototype.getWhereBuilder=function(){return new wo({quoteFields:!this.dataConfig.skipColumnQuotes})},e}(),Lo=function(){function e(){this.arcgis={},this.arcgisQueryMethodStrategy="prefer-get",this.arcgisMaxWhereLengthGetThreshold=3500}return Object.defineProperty(e.prototype,"hasGeometryUrl",{get:function(){return Boolean(this.arcgis&&this.arcgis.geometryUrl)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"arcGisGeometryUrl",{get:function(){return this.hasGeometryUrl?this.arcgis.geometryUrl:null},enumerable:!0,configurable:!0}),e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("EsriConfig")],e)}(),Ro="$$$sorted",Oo=6371,Do=4326;function _o(e){return ye(e)?e:e.coordinates}function jo(e,t){var r=_o(e),n=_o(t);return ie(r)-ie(n)}function No(e,t){if(void 0===t&&(t=!1),!e[Ro]){var r=bn(e);Boolean(r.length&&2<r[0].length)&&(r.sort(jo),t&&(e[Ro]=!0))}}function ko(e){return ye(e)?e:e.coordinates}function Ao(e){return ye(e)?e:e.coordinates}function Fo(e){var t=ko(e);return Boolean(t&&t.length&&2<t[0].length)}function Uo(e){var t=Ao(e);return Boolean(t.length&&Fo(t[0]))}function xo(e){if(!e[Ro]){var t=gn(e);Uo(t)&&(t.forEach(function(e){return No(e)}),t.sort(function(e,t){return jo(e[0],t[0])}),e[Ro]=!0)}}function Go(e){var t=_o(e);return Boolean(t&&t.length&&2<t.length)?ie(t):null}function Vo(e){var t,r,n=gn(e);if(n.length){xo(e);var o=n[0],i=ie(n),a=o[0],s=ie(i);t=Go(a),r=Go(s)}return{min:t,max:r}}function Bo(e){var t=bn(e),r=t[0],n=ie(t);return No(t),{min:Go(r),max:Go(n)}}function Ho(e){var t;dn(e)?t=Vo(e):t=Bo(e);return t}function qo(e,t){return e.domain?e.domain.codedValues.find(function(e){return e.code===t}):undefined}function Wo(e,t){var r=qo(e,t);return r?r.name:undefined}function Yo(e,t){var r=Wo(e,t);return J(r)?r:String(t)}var Qo=new RegExp("^layer_(\\d+)_field_(\\w+|\\*):?(\\w+)?","i");function zo(e){return Qo.test(e)}var Ko="*";function Xo(t,e){void 0===e&&(e="*");for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return $o.apply(void 0,P([e],r.filter(function(e){return e.layerId===t})))}function $o(t){void 0===t&&(t=Ko);for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.map(function(e){return t===Ko?e.properties:e.properties[t]})}function Jo(e){return e.filter(function(e){return o.isNumber(e)}).map(function(e){return Number(e)})}function Zo(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];var n=Gr(e),o=e;return n.filter(function(e){return zo(e)}).forEach(function(e){var t=function l(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n,o=e.match(Qo);if(o&&2<o.length){var i=Number(o[1]),a=o[2],s=(o[3]||"first").toLocaleLowerCase(),u=Xo.apply(void 0,P([i,a],t));if("first"===s)n=u[0];else if("last"===s)n=u[u.length-1];else if("sum"===s||"add"===s)n=Fr(c=Jo(u));else if("avg"===s||"average"===s)n=Dr(c=Jo(u));else if("concat"===s)n=u.join(", ");else if("min"===s){var c=Jo(u);n=Math.min.apply(Math,P(c))}else{if("max"!==s)throw new Error("Unsupported dynamic data expression subset keyword '"+s+"'");c=Jo(u),n=Math.max.apply(Math,P(c))}return yr(n)?JSON.stringify(n):String(n)}}.apply(void 0,P([e],r));o=x(o,e,t)}),o}function ei(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=Zo.apply(void 0,P([e],t)),o=t&&t.length?t[0].properties:{};return G(n,Object.assign({},o,{RecordCount:t.length}))}var ti=function(){function e(e,t,r){void 0===r&&(r=Do),this.id=e.id,this.properties=e.properties,this.type=e.type,this.bbox=e.bbox,this.layer=t,this.spatialReferenceId=r;var n=this.getIdFieldName();this.id=this.id||this.getValue(n),this.displayValue=this.getValue(t.displayField),this.setGeometry(e.geometry)}return Object.defineProperty(e.prototype,"layerId",{get:function(){return this.layer?this.layer.id:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasZ",{get:function(){return this.layer.hasZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasM",{get:function(){return this.layer.hasM},enumerable:!0,configurable:!0}),e.prototype.getIdFieldName=function(){return io(this.layer.fields)},e.prototype.getValue=function(e){return ao(e)?ei(e,this):this.properties&&this.properties[e]},e.prototype.getCodedValueNameOrDefault=function(e){var t=this.getValue(e);return Yo(this.layer.getField(e),t)},e.prototype.setValue=function(e,t){return this.properties[e]=t,this},e.prototype.setId=function(e){return this.id=e,this.setValue(io(this.layer.fields),e),this},e.prototype.setGeometry=function(e){return this.geometry=e,this.setGeometryTypeProperties()},e.prototype.setMeasureFromGeometry=function(){if(this.geometry){var e=Ho(this.geometry);this.fromMeasure=e.min,this.toMeasure=e.max}return this},e.prototype.isSpatialReferenceWgs84=function(){return this.spatialReferenceId===Do},e.prototype.clone=function(){return new e(Ot(this.toFeature()),this.layer)},e.prototype.toFeature=function(){return{type:"Feature",geometry:this.geometry,properties:this.properties,id:this.id,bbox:this.bbox}},e.prototype.toGeoJson=function(){return this.toFeature()},e.prototype.setGeometryTypeProperties=function(){return this.isLinear=dn(this.geometry),this.isPoint=mn(this.geometry),this.isPolygon=En(this.geometry),this},e}(),ri=function(o){function e(e,t,r){void 0===r&&(r=Do);var n=o.call(this,e,t,r)||this;if(n.geometry&&n.isGeometryTypeInvalid())throw new Error("Unsupported geometry type of "+n.geometry.type+" detected.");return n}return v(e,o),Object.defineProperty(e.prototype,"layerId",{get:function(){return this.layer?this.layer.id:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fromDate",{get:function(){return this.getValue(this.layer.fromDateFieldName)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toDate",{get:function(){return this.getValue(this.layer.toDateFieldName)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRetired",{get:function(){return Boolean(this.toDate)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isActive",{get:function(){return!this.isRetired},enumerable:!0,configurable:!0}),e.prototype.setFromDate=function(e){return this.setValue(this.layer.fromDateFieldName,e)},e.prototype.setToDate=function(e){return this.setValue(this.layer.toDateFieldName,e)},e.prototype.retire=function(){return this.layer.toDateFieldName&&this.setValue(this.layer.toDateFieldName,new Date),this},e.prototype.clone=function(){return new e(Ot(this.toFeature()),this.layer)},e.prototype.isGeometryTypeValid=function(){return dn(this.geometry)||mn(this.geometry)},e.prototype.isGeometryTypeInvalid=function(){return!this.isGeometryTypeValid()},e}(ti),ni=function(o){function n(e,t,r){void 0===r&&(r=Do);var n=o.call(this,e,t,r)||this;return n.routeId=n.getValue(t.routeIdFieldName),n.fromMeasure=n.getValue(t.fromMeasureFieldName),n.toMeasure=n.getValue(t.toMeasureFieldName),n}return v(n,o),n.create=function(e,t,r){return void 0===t&&(t={}),void 0===r&&(r=null),new n(oi(t,r),e)},n.prototype.setRouteId=function(e){return this.routeId=e,this.setValue(e,this.layer.routeIdFieldName)},n.prototype.setFromMeasure=function(e){return this.fromMeasure=e,this.setValue(this.layer.fromMeasureFieldName,e)},n.prototype.setToMeasure=function(e){if(!this.isLinear)throw new Error("Cannot set to measure for a point-based feature");return this.toMeasure=e,this.setValue(this.layer.toMeasureFieldName,e)},n.prototype.setMeasureExtent=function(e,t){return this.setFromMeasure(e).setToMeasure(t)},n.prototype.clone=function(){return new n(Ot(this.toFeature()),this.layer)},n.prototype.setGeometryTypeProperties=function(){return this.isLinear=Boolean(this.layer.toMeasureFieldName),this.isPoint=!this.isLinear,this.isPolygon=!1,this},n}(ri);function oi(e,t){return void 0===e&&(e={}),void 0===t&&(t=null),{type:"Feature",geometry:t,properties:e}}function ii(e,r){var o=[];gn(e).forEach(function(e){var t=function n(e,r){return e.map(function(e,t){return function o(e,t,r){var n=Go(e);return{pointCoordinate:e,distance:Math.abs(n-t),pointMeasure:n,index:r}}(e,r,t)})}(e,r);Tt(o,t)});var t=o.reduce(function(e,t){return function i(e,t,r){var n=t.distance<=e.distance,o=t.pointMeasure<=r;return n&&o?t:e}(e,t,r)}),n=o.reduce(function(e,t){return function i(e,t,r){var n=e.distance<=t.distance,o=e.pointMeasure>=r;return n&&o?e:t}(e,t,r)}),i=function a(e,t,r){return t!==e?(r-e)/(t-e):0}(t.pointMeasure,n.pointMeasure,r);return[function s(e,t,r){var n=S(e,1)[0],o=S(t,1)[0];return n+r*(o-n)}(t.pointCoordinate,n.pointCoordinate,i),function u(e,t,r){var n=S(e,2)[1],o=S(t,2)[1];return n+r*(o-n)}(t.pointCoordinate,n.pointCoordinate,i),0,r]}function ai(e){return{bbox:null,type:"MultiLineString",coordinates:gn(e)}}function si(e){return ye(e)?{bbox:null,type:"LineString",coordinates:e}:e}function ui(e){if(!ye(e))return e;var t=e;return hn(t)?ai(t):si(t)}function ci(e){return e*Math.PI/180}function li(e,t){var r=_o(e),n=_o(t);return pi(r[0],r[1],n[0],n[1])}function pi(e,t,r,n){var o=Math.pow(r-e,2),i=Math.pow(n-t,2),a=Math.sqrt(o+i);if(isNaN(a))throw new Error("Unable to calculate distance between points ("+e+","+r+" and "+t+","+n+"). Invalid or missing data was provided");return a}function fi(e,t,r,n){var o=ci(r-e),i=ci(n-t);e=ci(e),r=ci(r);var a=Math.sin(o/2)*Math.sin(o/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(e)*Math.cos(r),s=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return Oo*s}function di(e,t,r,n){return hi(e,t,r,n,Yr.Meter)}function hi(e,t,r,n,o){return Xr(fi(e,t,r,n),Yr.Kilometer,o)}function gi(e,t,r){r=Object.assign({lengthUnit:"miles",coordinateSystem:"wgs84"},r);var n=a(e,t);if(!n||!n.geometry)throw new Error("Unable to get measure for geometry");var o=Go(n.geometry);if(null!==o)return o;var i=ui(e);if(hn(i.coordinates))throw new Error("MultiLineString is not supported in getMeasure function yet.");return function l(e,t,r){var n=_o(t),o=f({type:"Feature",geometry:e,properties:{}},{type:"Feature",geometry:{type:"Point",coordinates:n},properties:{}}).features[0],i=ie(o.geometry.coordinates),a=o.geometry.coordinates.length-2,s=o.geometry.coordinates[a],u=p.lineString([s,i]),c="flat"===r.coordinateSystem?li(s,i):d(u,{units:r.lengthUnit});return Go(s)+c}(i,n.geometry,r)}var yi=function(o){function n(e,t,r){void 0===r&&(r=Do);var n=o.call(this,e,t,r)||this;return n.routeId=n.getValue(t.compositeRouteIdFieldName),n.displayValue=n.displayValue||n.routeId,n.setMeasureFromGeometry(),n}return v(n,o),n.create=function(e,t,r){return void 0===t&&(t={}),void 0===r&&(r=null),new n(oi(t,r),e)},n.prototype.getMeasure=function(e){return gi(this.geometry,e)},n.prototype.getPoint=function(e){return ii(this.geometry,e)},n.prototype.clone=function(){return new n(Ot(this.toFeature()),this.layer)},n}(ri),mi=function(){function r(e){this.bbox=e.bbox,this.type=e.type}return r.create=function(e,t){return new r({type:"FeatureCollection",features:e,bbox:t})},r.prototype.toGeoJson=function(){return{type:"FeatureCollection",bbox:this.bbox,features:this.features.map(function(e){return e.toGeoJson()})}},r}(),vi=function(o){function n(e,t,r){void 0===r&&(r=Do);var n=o.call(this,e)||this;return n.features=e.features.map(function(e){return new ni(e,t,r)}),n}return v(n,o),n.fromFeatures=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new n({type:"FeatureCollection",features:t},e)},n}(mi),bi=function(o){function e(e,t,r){void 0===r&&(r=Do);var n=o.call(this,e)||this;return n.features=e.features.map(function(e){return new yi(e,t,r)}),n}return v(e,o),e}(mi);function Ei(e,t){void 0===t&&(t="json");var r=new m.HttpHeaders;return e=e||new m.HttpParams,t&&(e=e.set("f",t)),r.append("Content-Type","application/json"),r.append("Access-Control-Allow-Origin","*"),{withCredentials:!0,headers:r,params:e}}function Ii(r,n){Object.keys(n).filter(function(e){return J(n[e])}).forEach(function(e){var t=n[e];r.params=r.params.set(e,Mn(t,!1))})}function Si(t){var r=new FormData;return Object.keys(t).map(function(e){return{key:e,value:Mn(t[e])}}).forEach(function(e){return r.append(e.key,e.value)}),r}var Pi=/(\/MapServer$|\/MapServer\/)/,Mi=/(MapServer|MapServer\/)$/,Ci=/(FeatureServer|FeatureServer\/)$/,wi=/FeatureServer\/(\d+|\d+\/)$/,Ti=/(\/MapServer\/(\d+|\d+\/)|\/MapServer\/(\d+|\d+\/)\/)/,Li=/MapServer\/(\d+|\d+\/)$/,Ri=/(MapServer\/exts\/LRSServer|MapServer\/exts\/LRSServer\/)$/,Oi=/(MapServer\/exts\/LRSServer\/layers|MapServer\/exts\/LRSServer\/layers\/)$/,Di="{layerId}",_i="{layerId}/query",ji="exts/LRSServer",Ni="exts/LRSServer/layers",ki="exts/LRSServer/applyEdits",Ai="exts/LRSServer/networkLayers/{layerId}/geometryToMeasure",Fi="sharing",Ui="sharing/oauth2/authorize",xi="sharing/rest/oauth2/token",Gi="sharing/generateToken",Vi={responseType:"token",urlParamsBreak:"#",redirectUrl:window.location.href},Bi={locations:[],inSR:4326,outSR:4326,f:"json"};function Hi(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Object.assign({},Bi);return(e||[]).forEach(function(e){return Object.assign(r,e)}),o.isDate(r.temporalViewDate)&&(r.temporalViewDate=Gt(r.temporalViewDate)),r}var qi={where:"1=1",text:"",objectIds:"",time:"",geometry:"",geometryType:"esriGeometryEnvelope",spatialRel:"esriSpatialRelIntersects",relationParam:"",outFields:"*",returnGeometry:!0,returnTrueCurves:!1,maxAllowableOffset:"",geometryPrecision:"",inSR:Do,outSR:Do,returnIdsOnly:!1,returnCountOnly:!1,orderByFields:"",groupByFieldsForStatistics:"",outStatistics:"",returnZ:!1,returnM:!0,gdbVersion:"",returnDistinctValues:!1,resultOffset:"",resultRecordCount:"",queryByDistance:"",returnExtentsOnly:!1,datumTransformation:"",parameterValues:"",rangeValues:"",f:"geojson"};function Wi(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Object.assign({},qi);return(e||[]).forEach(function(e){return Object.assign(r,e)}),r}function Yi(r,n){return n=n||new m.HttpParams,Object.keys(r).forEach(function(e){var t=r[e];J(t)&&(n=n.set(e,t))}),n}function Qi(e,t){e&&t&&e.versionName&&t.gdbVersion&&e.versionName.toLowerCase()===t.gdbVersion.toLowerCase()&&(t.gdbVersion=undefined)}function zi(e){return me(e)?e:e.id}function Ki(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=zi(e);return $r.apply(void 0,P([Object.assign({},t,{layerId:o})],r))}function Xi(e){return!e||!e.classMaxValue&&!e.label&&!e.description&&!Object.keys(e.symbol||{}).length}function $i(e){return!e||!e.value&&!e.label&&!e.description&&!Object.keys(e.symbol||{}).length}var Ji={type:"esriSLS",style:"esriSLSSolid",color:"#000000",width:2};function Zi(e){return Object.keys(e).length===Object.keys(Ji).length&&e.type===Ji.type&&e.style===Ji.style&&e.color===Ji.color&&e.width===Ji.width}var ea=function(){function e(e){Object.assign(this,e),this.type=this.type||"simple",this.minValue=this.minValue||0,this.classBreakInfos=this.classBreakInfos||[],this.uniqueValueInfos=this.uniqueValueInfos||[],this.symbol=Object.assign({},Ji,this.symbol),this.label=this.label||"",this.description=this.description||"",this.standardizeRenderSymbols()}return Object.defineProperty(e.prototype,"isSimple",{get:function(){return"simple"===this.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUniqueValue",{get:function(){return"uniqueValue"===this.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClassBreak",{get:function(){return"classBreaks"===this.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return!this.minValue&&!this.classBreakInfos.length&&!this.uniqueValueInfos.length&&Zi(this.symbol)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"field",{get:function(){return this.field1},set:function(e){this.field1=e},enumerable:!0,configurable:!0}),e.prototype.getSymbol=function(e){var t=this.symbol||this.defaultSymbol;if(this.isUniqueValue){var r=this.getUniqueValueInfoOrDefault(e);t=$i(r)?null:r.symbol}else if(this.isClassBreak){var n=this.getClassBreakInfoOrDefault(e);t=Xi(n)?null:n.symbol}return t||this.defaultSymbol||null},e.prototype.getUniqueValueInfo=function(t){return this.uniqueValueInfos&&this.uniqueValueInfos.length?this.uniqueValueInfos.find(function(e){return e.value===t||String(e.value)===String(t)}):null},e.prototype.getUniqueValueInfoOrDefault=function(e){return this.getUniqueValueInfo(e)||null},e.prototype.getClassBreakInfo=function(r){var n=this;return this.classBreakInfos&&this.classBreakInfos.length?this.classBreakInfos.find(function(e,t){return n.isValueInClassBreakRange(e,r,t)}):null},e.prototype.getClassBreakInfoOrDefault=function(e){return this.getClassBreakInfo(e)||null},e.prototype.isValueInClassBreakRange=function(e,t,r){var n=0===r?this.minValue:this.classBreakInfos[r-1].classMaxValue,o=e.classMaxValue;return n<t&&t<o},e.prototype.clearEmptyInfos=function(){Rt(this.uniqueValueInfos,function(e){return $i(e)}),Rt(this.classBreakInfos,function(e){return Xi(e)})},e.prototype.getBestRepresentativeColor=function(e){var t=this.defaultSymbol||this.symbol;if(this.isUniqueValue&&this.uniqueValueInfos.length)t=(r=this.getUniqueValueInfo(e))?r.symbol:this.uniqueValueInfos[0].symbol;else if(this.isClassBreak&&this.classBreakInfos.length){var r;t=(r=this.getClassBreakInfo(e))?r.symbol:this.classBreakInfos[0].symbol}return t.color},e.prototype.standardizeRenderSymbols=function(){ta(this.defaultSymbol),ta(this.symbol),this.uniqueValueInfos.forEach(function(e){return ta(e.symbol)}),this.classBreakInfos.forEach(function(e){return ta(e.symbol)})},e}();function ta(e){e&&(ye(e.color)&&(e.color=Dt(e.color)),e.outline&&ye(e.outline.color)&&(e.outline.color=Dt(e.outline.color)))}var ra=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.merge.apply(this,P(e)),this.transparency=this.transparency||0,this.zIndex=this.zIndex||null,this.renderer=new ea(this.renderer),this.positionRenderer=new ea(this.positionRenderer),this.labelingInfo=this.labelingInfo||null}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return!this.transparency&&!this.zIndex&&this.renderer.isEmpty&&this.positionRenderer.isEmpty&&!Object.keys(this.labelingInfo||{}).length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"opacity",{get:function(){return _t(this.transparency)},enumerable:!0,configurable:!0}),e.prototype.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.map(function(e){return e&&e.toProperties?e.toProperties():e});return Object.assign.apply(Object,P([this],r)),this},e.prototype.getRendererSymbol=function(e){return this.renderer.getSymbol(e)},e.prototype.getPositionRendererSymbol=function(e){return this.positionRenderer.getSymbol(e)},e.prototype.getBestRepresentativeColor=function(e){return this.renderer.getBestRepresentativeColor(e)},e.prototype.toProperties=function(){var e={};return this.labelingInfo&&(e.labelingInfo=this.labelingInfo),this.positionRenderer&&!this.positionRenderer.isEmpty&&(e.positionRenderer=this.positionRenderer),this.renderer&&!this.renderer.isEmpty&&(e.renderer=this.renderer),this.transparency&&(e.transparency=this.transparency),e},e}(),na=["point","esriGeometryPoint"],oa=["line","esriGeometryPolyline"],ia=["polygon","esriGeometryPolygon"];function aa(e){return-1<na.indexOf(e)}function sa(e){return-1<oa.indexOf(e)}function ua(e){return-1<ia.indexOf(e)}var ca=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Object.assign.apply(Object,P([this],e)),this.subLayers=this.subLayers||[],this.fields=this.fields||[],this.indexes=this.indexes||[],this.relationships=this.relationships||[],this.supportedQueryFormats=this.supportedQueryFormats||[],this.drawingInfo=new ra(this.drawingInfo)}return Object.defineProperty(e.prototype,"isPoint",{get:function(){return aa(this.geometryType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLinear",{get:function(){return sa(this.geometryType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPolygon",{get:function(){return ua(this.geometryType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayFieldAlias",{get:function(){return this.getFieldAlias(this.displayField)},enumerable:!0,configurable:!0}),e.prototype.getField=function(e){return co(e,this.fields)},e.prototype.getFieldAlias=function(e){return lo(e,this.fields)},e.prototype.applyFieldDomains=function(e){return e.length&&this.fields.filter(function(e){return e.domainName}).forEach(function(t){return t.domain=e.find(function(e){return e.name===t.domainName})||t.domain}),this},e.prototype.clone=function(){return new e(Ot(this))},e}(),la=function(o){function e(e,t,r,n){return o.call(this,e,t,r,n)||this}return v(e,o),e.prototype.getMapLayers=function(t){var r=this,e=N(t,"layers");return this.http.get(e,Ei()).pipe(y.tap(function(e){return r.handleEsriResponseError(e,t)}))},e.prototype.getMapLayer=function(t,e){var r=this,n=Ki(e,{},t,Di);return this.http.get(n,Ei()).pipe(y.tap(function(e){return r.handleEsriResponseError(e,t)}),y.map(function(e){return new ca(e)}))},e.prototype.getLrsLayers=function(t){var r=this,e=N(t,Ni);return this.http.get(e,Ei()).pipe(y.tap(function(e){return r.handleEsriResponseError(e,t)}))},e.prototype.getLrsServer=function(t){var r=this,e=N(t,ji);return this.http.get(e,Ei()).pipe(y.tap(function(e){return r.handleEsriResponseError(e,t)}))},e.prototype.getVersions=function(e,r){return this.getLrsServer(e).pipe(y.map(function(e){var t=e?e.lrs[0]:null;if(!t)throw new Error("No LRS infos found");if(r&&!(t=e.lrs.find(function(e){return e.id===r})))throw new Error("No LRS info found with ID '"+r+"'");return t.versions}))},e.prototype.singleGeometryToMeasure=function(e,t,r,n,o,i,a,s){void 0===a&&(a=4326),void 0===s&&(s=4326);var u=[{routeId:r,geometry:{x:n,y:o}}];return this.geometryToMeasure(e,t,{locations:u,temporalViewDate:i,inSR:a,outSR:s}).pipe(y.map(function(e){var t={m:null,x:null,y:null,z:null};if(e.locations.length&&e.locations[0].results.length){var r=S(e.locations[0].results,1)[0];t.m=r.measure,t.x=r.geometry.x,t.y=r.geometry.y}return t}))},e.prototype.geometryToMeasure=function(t,e,r){var n=this,o=G(Ai,{layerId:e}),i=N(t,o),a=Ei(),s=Hi(r),u=!this.shouldUsePostMethod(s);return u&&Ii(a,s),(u?this.http.get(i,a):this.http.post(i,Si(s),a)).pipe(y.tap(function(e){return n.handleEsriResponseError(e,t)}))},e.prototype.applyEdits=function(t,e,r){var n=this,o=N(t,ki),i=Ei(),a=!this.shouldUsePostMethod(e);return a&&(i.params=i.params.set("edits",JSON.stringify(e)).set("gdbVersion",r)),(a?this.http.get(o,i):this.http.post(o,Si({edits:e,gdbVersion:r}),i)).pipe(y.tap(function(e){return n.handleEsriResponseError(e,t)}))},e.prototype.getUniqueValues=function(e,t,r,n){var o=uo(r),i=Wi({outFields:o,returnDistinctValues:!0,returnGeometry:!1},n);return this.query(e,zi(t),i).pipe(y.map(function(e){return e.features.map(function(e){return e.properties[o]})}))},e.prototype.getQueryCount=function(e,t,r,n){var o=Wi({returnCountOnly:!0,returnGeometry:!1,where:r},n);return this.query(e,zi(t),o).pipe(y.map(function(e){return(e||{count:0}).count}))},e.prototype.getEvent=function(e,t,r,n){throw Qi(t,n),new Error("Not implemented yet")},e.prototype.queryEvents=function(e,t,r,n,o,i,a){Qi(t,a);var s=Wi({where:this.getWhereBuilder().withEventLayer(t).withRouteId(r).withViewDate(i).betweenMeasures(n,o).toWhereClause(),returnGeometry:!1},a);return this.query(e,t.id,s).pipe(y.map(function(e){return new vi(e,t)}))},e.prototype.searchEventsByText=function(t,r,e,n){var o=this;return this.searchByText(t,r.id,e,n).pipe(y.tap(function(e){return o.handleEsriResponseError(e,t)}),y.map(function(e){return new vi(e,r)}))},e.prototype.getRoute=function(e,t,r,n,o){Qi(r,o);var i=Wi({where:this.getWhereBuilder().withNetworkLayer(r).where(r.compositeRouteIdFieldName,ho.Equals,t).withViewDate(n).toWhereClause()},o);return this.query(e,r.id,i).pipe(y.map(function(e){return e&&e.features&&e.features.length?new yi(e.features[0],r):null}))},e.prototype.queryRoutes=function(e,t,r,n){var o=Wi({where:r},n);return this.query(e,t.id,o).pipe(y.map(function(e){return new bi(e,t,n.outSR)}))},e.prototype.searchRoutesByText=function(e,t,r,n){return this.searchByText(e,t.id,r,n).pipe(y.map(function(e){return new bi(e,t)}))},e.prototype.searchByText=function(e,t,r,n){var o=Wi({text:r},n);return delete o.where,this.query(e,t,o)},e.prototype.query=function(e,t,r){var n=this,o=Ki(t,r,e,_i),i=Ei(),a=this.shouldUsePostMethod(r.where);return a||(i.params=Yi(r,i.params)),(a?this.http.post(o,r,i):this.http.get(o,i)).pipe(y.map(function(e){return n.handleEsriResponseError(e,o),e}))},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:Lo},{type:In},{type:z}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(Lo),s.inject(In),s.inject(z))},token:e,providedIn:"root"}),e}(To);function pa(e){return Ci.test(e)}function fa(e){return Mi.test(e)}function da(e){return Ri.test(e)}function ha(e){return Oi.test(e)}function ga(e){var t=S((e||"").split(Fi),1)[0];return t.endsWith("/")?Zr(t):t}function ya(e,t){var r={accessToken:e.access_token||e.accessToken||e.token||null,refreshToken:e.refresh_token||e.refreshToken||null,expiresIn:e.expires_in||e.expiresIn||0,isSecure:e.ssl||e.isSecure||!1,server:e.server||t||null,username:e.username||null,expires:e.expires||null};return r.expires&&(r.expires=new Date(r.expires)),r.server&&ga(r.server),r.expires||(r.expires=Ft(r.expiresIn,new Date)),r}function ma(e){var t={token:e.token||null,isSecure:e.ssl||e.isSecure||!1,expires:e.expires||0};return t.expires&&(t.expires=new Date(t.expires)),t}function va(e){void 0===e&&(e=window.location.hash);var t=e.lastIndexOf("#"),r=e.substr(t);return e.replace(r,"")}var ba=function(o){function e(e,t,r,n){return o.call(this,e,t,r,n)||this}return v(e,o),e.prototype.getTokenByCode=function(t,e,r,n,o){var i=Si(Object.assign({client_id:e,code:r,redirect_uri:va(window.location.href),grant_type:"authorization_code"},n));return this.doPost(t,xi,i,o).pipe(y.map(function(e){return ya(e,t)}))},e.prototype.refreshToken=function(t,e,r,n,o){var i=Si(Object.assign({client_id:e,refresh_token:r,grant_type:"refresh_token"},n));return this.doPost(t,xi,i,o).pipe(y.map(function(e){return ya(e,t)}))},e.prototype.getServerToken=function(e,t,r,n){var o={request:"getToken",serverUrl:r,token:t,referer:window.location.host};return this.doGet(e,Gi,o,n).pipe(y.map(function(e){return ma(e)}))},e.prototype.doGet=function(e,t,r,n){var o=this,i=N(ga(e),t),a=Ei(n);return Ii(a,r),this.http.get(i,a).pipe(y.tap(function(e){return o.handleEsriResponseError(e,i)}))},e.prototype.doPost=function(e,t,r,n){var o=this,i=N(ga(e),t),a=Ei(n);return this.http.post(i,r,a).pipe(y.tap(function(e){return o.handleEsriResponseError(e,i)}))},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:Lo},{type:In},{type:z}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(Lo),s.inject(In),s.inject(z))},token:e,providedIn:"root"}),e}(To);var Ea=function(){function e(){}return e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("ExportConfig")],e)}(),Ia="export.geojson",Sa=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,We],declarations:[],exports:[],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),Pa=function(){function e(){}return e.prototype.replaceTokens=function(e,t,r){return void 0===t&&(t={}),G(e,Object.assign(this.getReplaceTokens(),t),r)},e.prototype.exportFeatureCollection=function(e){void 0===e&&(e=Ia);for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.replaceTokens(e,{featureLength:t.length}),o={type:"FeatureCollection",features:t};return this.exportFile(this.stringify(o),n,lr)},e.prototype.exportFeature=function(e,t){return void 0===e&&(e=Ia),this.exportFile(this.stringify(t),e,lr)},e.prototype.stringify=function(e){return JSON.stringify(e,function(e,t){return e.startsWith("$$")?undefined:t},2)},e.prototype.exportJson=function(e,t){var r=O(e)?e:this.stringify(e);return this.exportFile(r,t,lr)},e.prototype.exportBase64=function(e,t,r){var n=this.replaceTokens(t),o=gr(e,r=r||fr(e));return this.exportFromUrl(URL.createObjectURL(o),n)},e.prototype.exportFile=function(e,t,r){void 0===r&&(r=pr);var n=new Blob([e],{type:r}),o=this.replaceTokens(t);return this.exportBlob(n,o)},e.prototype.exportBlob=function(e,t){var r=this.replaceTokens(t);return this.exportFromUrl(window.URL.createObjectURL(e),r)},e.prototype.exportFromUrl=function(e,t){var r=document.createElement("a");return r.href=e,r.download=t,r.click(),this},e.prototype.getReplaceTokens=function(){return{date:new Date,shortDate:xt(new Date,"yyyy-MM-dd"),year:(new Date).getFullYear()}},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),Ma=function(){function e(){this.gpsDisplayDecimalPlaces=3,this.gpsWarnableAccuracyMeters=5,this.gpsRequiredAccuracyMeters=10,this.gpsWarnableDilutionOfPrecision=2,this.gpsRequiredDilutionOfPrecision=5,this.gpsEnableHighAccuracy=!0,this.gpsNoAccuracyReading="--",this.allowGpsMocking=!0,this.emitDuplicateGpsPositions=!1,this.gpsPositionDuplicatePrecision=Qt,this.gpsAntennaHeight=0,this.adjustForGpsAntennaHeight=!0,this.calculateMissingPositionValues=!0,this.geolocationGeolocatorName="Built-in (default)",this.geolocationGeolocatorDescription="Uses the device's built-in GPS sensor within the hardware. Devices without a GPS sensor will defer the location retrieval to the Inernet Service Provider (ISP)."}return e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("GeolocationConfig")],e)}(),Ca="calculated-calibration-point",wa=[],Ta="built-in";function La(t){return function(e){wa.push({id:t,constructor:e})}}var Ra={Meter:"meters",Pdop:"pdop",Hdop:"hdop",Vdop:"vdop",Tdop:"tdop"},Oa=function(){function e(e){this.log=e,this.capabilities=[],this.accuracyUnit=Ra.Meter}return e.prototype.hasCapability=function(e){return-1<this.capabilities.indexOf(e)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:z}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(z))},token:e,providedIn:"root"}),e}();function Da(e){return{timestamp:e.timestamp,accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,latitude:e.coords.latitude,longitude:e.coords.longitude,heading:e.coords.heading,speed:e.coords.speed}}var _a={Accuracy:"accuracy",Altitude:"altitude",AltitudeAccuracy:"altitude",Heading:"heading",Speed:"speed",MagneticVariation:"magneticVariation",Satellites:"satellites",PDOP:"pdop",HDOP:"hdop",VDOP:"vdop",TDOP:"tdop"},ja=function(n){function e(e,t){var r=n.call(this,e)||this;return r.config=t,r.capabilities=[_a.Accuracy,_a.Altitude,_a.AltitudeAccuracy,_a.Heading,_a.Speed],r}return v(e,n),Object.defineProperty(e.prototype,"name",{get:function(){return this.config.geolocationGeolocatorName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this.config.geolocationGeolocatorDescription},enumerable:!0,configurable:!0}),e.prototype.getCurrentPosition=function(r){var n=this;return new Promise(function(t,e){return navigator.geolocation.getCurrentPosition(function(e){n.log.trace("Received current position for "+n.name),t(Da(e))},e,r)})},e.prototype.watchPosition=function(e){var t=this,r=new l.Subject,n=navigator.geolocation.watchPosition(function(e){t.log.trace("Received watch position for "+t.name),r.next(Da(e))},function(e){return r.error(e)},e);return r.pipe(y.finalize(function(){return navigator.geolocation.clearWatch(n)}))},e.prototype.isAvailable=function(){return l.of("geolocation"in navigator)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:z},{type:Ma}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(z),s.inject(Ma))},token:e,providedIn:"root"}),e=b([La(Ta),E("design:paramtypes",[z,Ma])],e)}(Oa),Na=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,We],declarations:[],exports:[],providers:[{provide:Oa,useClass:ja}],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}();function ka(e,t){return e&&e.accuracy<=t}function Aa(e){return!e||me(e.code)}function Fa(e){var t=[e.longitude,e.latitude];return $(e.altitude)&&(t[2]=e.altitude),t}function Ua(e){return me(e)&&Nr(e,-90,90)}function xa(e){return me(e)&&Nr(e,-180,180)}function Ga(e){return Ua(e.latitude)&&xa(e.longitude)}function Va(e){return!Ga(e)}function Ba(e,t,r){return void 0===r&&(r=Qt),Kt(e.longitude,e.latitude,t.longitude,t.latitude,r)}var Ha=function(){function e(e,t,r,n){this.log=t,this.notify=r,this.config=n,this.isTrackingPosition=!1,this.geolocator=e,this.positionChangeSubject=new l.ReplaySubject(1),this.positionRecievedSubject=new l.Subject,this.positionChange=this.positionChangeSubject.asObservable(),this.positionRecieved=this.positionRecievedSubject.asObservable()}return Object.defineProperty(e.prototype,"positionText",{get:function(){return this.position?this.position.longitude.toFixed(this.config.gpsDisplayDecimalPlaces)+"\n       , "+this.position.latitude.toFixed(this.config.gpsDisplayDecimalPlaces):""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positionReceivedEllapsedTime",{get:function(){return this.positionRecievedTime?Be(Date.now()-this.positionRecievedTime.getTime())+" ago":""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPositionAcceptable",{get:function(){var e=this.geolocator.accuracyUnit===Ra.Meter?this.config.gpsRequiredAccuracyMeters:this.config.gpsRequiredDilutionOfPrecision;return ka(this.position,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPositionUnacceptable",{get:function(){return!this.isPositionAcceptable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPositionWarnable",{get:function(){var e=this.geolocator.accuracyUnit===Ra.Meter?this.config.gpsWarnableAccuracyMeters:this.config.gpsWarnableDilutionOfPrecision;return!ka(this.position,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasAccuracyCapability",{get:function(){return-1<this.geolocator.capabilities.indexOf(_a.Accuracy)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPositionAccuracyKnown",{get:function(){return this.position&&me(this.position.accuracy)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPositionAccuracyUnknown",{get:function(){return!this.isPositionAccuracyKnown},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPositionAccuracyInMeters",{get:function(){return this.geolocator.accuracyUnit===Ra.Meter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPositionAccuracyInDilutionOfPrecision",{get:function(){return this.geolocator.accuracyUnit===Ra.Pdop||this.geolocator.accuracyUnit===Ra.Hdop||this.geolocator.accuracyUnit===Ra.Vdop||this.geolocator.accuracyUnit===Ra.Tdop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"geolocatorService",{get:function(){return this.geolocator},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accuracyStatement",{get:function(){if(!this.position)return this.config.gpsNoAccuracyReading;var e,t=this.isPositionAccuracyKnown,r=t?this.position.accuracy:null;return t&&this.geolocator.hasCapability(_a.Accuracy)?e=this.geolocator.accuracyUnit===Ra.Meter?"m":String(this.geolocator.accuracyUnit).toUpperCase():this.geolocator.hasCapability(_a.PDOP)?(r=this.position.pdop,e=String(_a.PDOP).toUpperCase()):this.geolocator.hasCapability(_a.HDOP)?(r=this.position.hdop,e=String(_a.HDOP).toUpperCase()):this.geolocator.hasCapability(_a.VDOP)?(r=this.position.vdop,e=String(_a.VDOP).toUpperCase()):this.geolocator.hasCapability(_a.TDOP)&&(r=this.position.tdop,e=String(_a.TDOP).toUpperCase()),qr(r)?this.config.gpsNoAccuracyReading:Jt(r)+" "+e},enumerable:!0,configurable:!0}),e.prototype.enableGpsTracking=function(){var t=this,e={enableHighAccuracy:this.config.gpsEnableHighAccuracy};return this.position=null,this.tryUnsubscribe(),this.log.debug("Subscribing to GPS watching for '"+this.geolocator.name+"' with high accuracy set to '"+e.enableHighAccuracy+"'"),this.gpsLocatorSubscription=this.geolocator.watchPosition(e).subscribe(function(e){return t.onPositionRecieved(e)},function(e){return t.onLocationError(e)}),this},e.prototype.disableGpsTracking=function(){return this.isTrackingPosition=!1,this.tryUnsubscribe(),this},e.prototype.setGeoLocator=function(e){return this.tryUnsubscribe(),this.geolocator=e,this.isTrackingPosition&&this.enableGpsTracking(),this},e.prototype.setGpsTracking=function(e){return e?this.enableGpsTracking():this.disableGpsTracking(),this},e.prototype.toggleGpsTracking=function(){return this.setGpsTracking(!this.isTrackingPosition),this},e.prototype.mockGpsPosition=function(e){if(!this.config.allowGpsMocking)throw new Error("Permission denied to mock GPS location");return this.onPositionRecieved(e)},e.prototype.onPositionRecieved=function(e){if(Aa(e))return this.onLocationError(e),this;var t=e;return Va(t)||(this.position&&Ba(this.position,t,this.config.gpsPositionDuplicatePrecision)&&!this.config.emitDuplicateGpsPositions?this.positionRecievedSubject.next(t):(this.log.trace("Location recieved from '"+this.geolocator.name+"': "+t.latitude+", "+t.longitude),this.adjustCoordinates(t),this.position=t,this.isTrackingPosition=!0,this.positionRecievedTime=new Date(this.position.timestamp||Date.now()),this.positionRecievedSubject.next(this.position),this.positionChangeSubject.next(this.position))),this},e.prototype.onLocationError=function(e){var t=$t("Failed to retrieve location position. {error}",e);return this.positionChangeSubject.error(e),this.log.error(t),this.notify.error(t),this},e.prototype.adjustCoordinates=function(e){if(this.tryAdjustMissingPositionValues(e),this.config.adjustForGpsAntennaHeight&&this.config.gpsAntennaHeight){var t=e.altitude-this.config.gpsAntennaHeight;t=t<0?0:t,this.log.trace("Adjusting coordinate altitude from "+e.altitude+" to "+t),Object.assign(e,{altitude:t})}return this},e.prototype.tryAdjustMissingPositionValues=function(e){var t=ce(e.speed),r=ce(e.heading),n=t||r;if(this.position&&n&&this.config.calculateMissingPositionValues){var o=Fa(this.position),i=Fa(e);if(t){var a=c(o,i,{units:"kilometers"});if(a){var s=Xr(a,Yr.Kilometer,Yr.Meter)/Ue(Math.abs(e.timestamp-this.position.timestamp));Object.assign(e,{speed:s})}}if(r){var u=g(o,i);Object.assign(e,{heading:u})}}},e.prototype.tryUnsubscribe=function(){return this.gpsLocatorSubscription&&(this.log.debug("Unsubscribing from watching GPS stream from '"+this.geolocator.name+"'"),this.gpsLocatorSubscription.unsubscribe()),this},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:Oa},{type:z},{type:Pr},{type:Ma}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(Oa),s.inject(z),s.inject(Pr),s.inject(Ma))},token:e,providedIn:"root"}),e}(),qa=function(){function e(e){this.injector=e}return e.prototype.getGeolocator=function(t){var e=wa.find(function(e){return e.id===t});return this.getLocatorFromRegistry(e)},e.prototype.getGeolocators=function(){var t=this;return wa.map(function(e){return t.getLocatorFromRegistry(e)})},e.prototype.getGeolocatorSource=function(t){return this.getGeolocatorSources().pipe(y.map(function(e){return e.find(function(e){return e.id===t})}))},e.prototype.getAvailableGeolocatorSources=function(){return this.getGeolocatorSources().pipe(y.map(function(e){return e.filter(function(e){return e.isAvailable})}))},e.prototype.getGeolocatorSources=function(){var n=this,e=wa.map(function(e){var t=n.getLocatorFromRegistry(e),r={id:e.id,name:t.name,description:t.description,accuracyUnit:t.accuracyUnit,capabilities:t.capabilities,isAvailable:!1};return t.isAvailable().pipe(y.tap(function(e){return r.isAvailable=e}),y.map(function(){return r}))});return 0===e.length?l.of([]):l.forkJoin(e)},e.prototype.getLocatorFromRegistry=function(e){return this.injector.get(e.constructor)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:s.Injector}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(s.INJECTOR))},token:e,providedIn:"root"}),e}();var Wa=0,Ya={units:"miles",hasZValues:!0,calibrationPositions:[]};function Qa(e,n){var t=gn(e);n=Object.assign({},Ya,n);var o=0;t.forEach(function(e,t){!function i(e,t,r,n){n.calibrationPositions.some(function(e){return e.partIndex===r})?function o(i,a,t,s){var e=s.calibrationPositions.filter(function(e){return e.partIndex===t}),u=0;if(wr(e,function(e){return e.measure}),e.forEach(function(e){var t=i[u],r=i[e.vertexIndex],n=e.vertexIndex-u,o=Math.abs(e.measure-a)/n;Xa(t,a,s.hasZValues),Xa(r,e.measure,s.hasZValues),za(i,u,e.vertexIndex).forEach(function(e,t){Xa(e,a+(t+1)*o,s.hasZValues)}),u=e.vertexIndex,a=e.measure}),u<i.length-1){var r=za(i,u-1,i.length);Ka(r,a,s)}}(e,t,r,n):Ka(e,t,n)}(e,o,t,n);var r=e[e.length-1];o+=Go(r)})}function za(e,t,r){for(var n=t+1,o=[];n<r;n++){var i=e[n];o.push(i)}return o}function Ka(e,t,n){var o,i=t;e.forEach(function(e,t){if(0!==t){var r=c(o,e,n);i+=r}Xa(e,i,n.hasZValues),o=e})}function Xa(e,t,r){var n=r||3<e.length;e[n?3:2]=t,n&&function o(e){qr(e[2])&&(e[2]=Wa)}(e)}var $a="pending",Ja={gpsRequiredAccuracyMeters:10,requireAccuracy:!0,pointEquivalencyPrecision:8,returnZValues:!0,returnMValues:!0,mValueUnit:"miles",storeUnfilteredPath:!1,calibrationMeasureSnappingDistanceDelta:2,calibrationMeasureSnappingDistanceDeltaUnit:Yr.Foot},Za=function(){function e(e){this.parts=[[]],this.unfilteredPath=[],this.calibratedMeasures=new Map,this.options=Object.assign({},Ja,e)}return Object.defineProperty(e.prototype,"positionCount",{get:function(){return Fr(this.parts.map(function(e){return e.length}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPartIndex",{get:function(){return this.parts.length-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPart",{get:function(){return this.parts[this.currentPartIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastPosition",{get:function(){return ie(this.currentPart)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasPosition",{get:function(){return Boolean(this.lastPosition)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.currentPart.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValidPath",{get:function(){return 1<this.currentPart.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSinglePoint",{get:function(){return 1===this.parts.length&&1===this.currentPart.length},enumerable:!0,configurable:!0}),e.prototype.trackPosition=function(e){var t=this;return this.trackSubscription=e.subscribe(function(e){return t.addPosition(e)}),this},e.prototype.addPosition=function(e,t){var r=!this.options.requireAccuracy||ka(e,this.options.gpsRequiredAccuracyMeters);if(!e||!r)return this.tryStoreUnfilteredPath(e);if(this.isEmpty)return this.forceAddPosition(e);var n=this.arePositionsEquivalent(this.lastPosition,e);return 0===this.lastPosition.speed&&0===e.speed||n?this.tryStoreUnfilteredPath(e).replaceLastPositionIfBetter(e):(this.forceAddPosition(e),me(t)&&this.addCalibrationMeasureToLastPosition(t)),this},e.prototype.startNewPart=function(){return this.parts.push([]),this},e.prototype.removePositionByIndex=function(e,t){void 0===t&&(t=0);var r=this.parts[t];if(!r)throw new Error('Invalid part index" '+t);r.splice(e,1);var n=this.getCalibrationMeasureLookupKey(t,e);return this.calibratedMeasures.has(n)&&this.calibratedMeasures["delete"](n),this},e.prototype.removePosition=function(n){var o=-1,i=-1;return this.parts.forEach(function(e,t){var r=e.indexOf(n);-1<r&&(o=t,i=r)}),-1<o&&-1<i?this.removePositionByIndex(i,o):this},e.prototype.removeCalibrationMeasure=function(t){var r=this;return Array.from(this.calibratedMeasures.values()).filter(function(e){return e.measure===t}).forEach(function(e){return r.removeCalibrationMeasureByIndex(e.vertexIndex,e.partIndex)}),this},e.prototype.removeCalibrationMeasureByIndex=function(e,t){void 0===t&&(t=0);var r=this.getCalibrationMeasureLookupKey(t,e);return this.calibratedMeasures.has(r)&&this.calibratedMeasures["delete"](r),this},e.prototype.addCalibrationMeasure=function(e){var t=(new Date).getTime(),r=S(this.currentPart.slice(-1),1)[0];if(r&&r.timestamp&&r.timestamp===t)return this.addCalibrationMeasureToLastPosition(e);var n=this.currentPartIndex;return this.calibratedMeasures.set("pending",{measure:e,partIndex:n,vertexIndex:null,timestamp:t}),this},e.prototype.addCalibrationMeasureToLastPosition=function(e){var t=this.currentPartIndex,r=this.currentPart.length-1;return this.addCalibrationMeasureAtIndex(e,r,t)},e.prototype.addCalibrationMeasureAtIndex=function(e,t,r){void 0===r&&(r=0);var n=this.getCalibrationMeasureLookupKey(r,t);return this.calibratedMeasures.set(n,{measure:e,partIndex:r,vertexIndex:t,timestamp:(new Date).getTime()}),this},e.prototype.forceAddPosition=function(e){return this.tryStoreUnfilteredPath(e),this.addPositionToPath(e),this},e.prototype.toPointFeature=function(e){return void 0===e&&(e={}),{type:"Feature",geometry:this.toPointGeometry(),properties:e}},e.prototype.toLineFeature=function(e){return void 0===e&&(e={}),{type:"Feature",geometry:this.toLineGeometry(),properties:e}},e.prototype.toSingleLineFeature=function(e){return void 0===e&&(e={}),{type:"Feature",geometry:this.toSingleLineGeometry(),properties:e}},e.prototype.toMultiLineFeature=function(e){return void 0===e&&(e={}),{type:"Feature",geometry:this.toMultiLineGeometry(),properties:e}},e.prototype.toPolygonFeature=function(e){return void 0===e&&(e={}),{type:"Feature",geometry:this.toPolygonGeometry(),properties:e}},e.prototype.toMultiPolygonFeature=function(e){return void 0===e&&(e={}),{type:"Feature",geometry:this.toMultiPolygonGeometry(),properties:e}},e.prototype.toSinglePolygonFeature=function(e){return void 0===e&&(e={}),{type:"Feature",geometry:this.toSinglePolygonGeometry(),properties:e}},e.prototype.toFeature=function(){return this.isSinglePoint?this.toPointFeature():this.toLineFeature()},e.prototype.toGeometry=function(){return this.isSinglePoint?this.toPointGeometry():this.toLineGeometry()},e.prototype.toSingleLineGeometry=function(e){void 0===e&&(e=!0);var t=this.toLineGeometry(e);if(hn(t.coordinates))throw new Error("Cannot convert MultiLineString to LineString. Data would be lost");return t},e.prototype.toMultiLineGeometry=function(e){void 0===e&&(e=!0);var t=this.toLineGeometry(e);return!hn(t.coordinates)&&(t={type:"MultiLineString",bbox:t.bbox,coordinates:[t.coordinates]}),t},e.prototype.toLineGeometry=function(e){void 0===e&&(e=!0);var t=this.toMultiPartArray(),r=1<t.length?{type:"MultiLineString",coordinates:t}:{type:"LineString",coordinates:t[0]};if(this.options.returnMValues){var n=e?Array.from(this.calibratedMeasures.values()):[];Qa(r,{units:this.options.mValueUnit,hasZValues:this.options.returnZValues,calibrationPositions:n})}return r},e.prototype.toMultiPolygonGeometry=function(){var e=this.toPolygonGeometry();return"Polygon"===e.type&&(e={type:"MultiPolygon",bbox:e.bbox,coordinates:[e.coordinates]}),e},e.prototype.toSinglePolygonGeometry=function(){var e=this.toPolygonGeometry();if("MultiPolygon"===e.type)throw new Error("Cannot convert MultiPolygon to Polygon. Data would be lost");return e},e.prototype.toPolygonGeometry=function(){var t=this,e=this.toMultiPartArray();return e.forEach(function(e){return t.ensurePolygonIsClosed(e)}),1<e.length?{type:"MultiPolygon",coordinates:[e]}:{type:"Polygon",coordinates:e}},e.prototype.toPointGeometry=function(){var e=this.toMultiPartArray();return 1<e.length?{type:"MultiPoint",coordinates:e.map(function(e){return e[0]})}:{type:"Point",coordinates:e[0][0]}},e.prototype.replaceLastPositionIfBetter=function(e){var t=!0;return this.isEmpty?this.addPositionToPath(e):this.lastPosition.accuracy>e.accuracy?this.replaceLastPosition(e):t=!1,t},e.prototype.replaceLastPosition=function(e){return this.currentPart[this.currentPart.length-1]=e,this},e.prototype.getBestPosition=function(){throw new Error("Not implemented yet")},e.prototype.getUnfilteredPath=function(){var t=this;return this.unfilteredPath.map(function(e){return Object.assign({included:t.pathContains(e)},e)})},e.prototype.getGeometryPathSummary=function(){var r=this;return this.toMultiLineGeometry(!1).coordinates.map(function(e,t){return r.getGeometryLinePartSummary(e,t)})},e.prototype.pathContains=function(t){var e=this.parts.find(function(e){return-1<e.indexOf(t)});return Boolean(e)},e.prototype.getPositionByIndex=function(e,t){return this.parts[e][t]},e.prototype.dispose=function(){this.trackSubscription&&this.trackSubscription.unsubscribe(),this.parts.length=0},e.prototype.getGeometryLinePartSummary=function(e,i){var a=this;return e.map(function(e,t){var r=a.getPositionByIndex(i,t),n=a.getCalibrationMeasureLookupKey(i,t),o=a.calibratedMeasures.has(n)?a.calibratedMeasures.get(n).measure:null;return Object.assign({geometricMeasure:Go(e),partIndex:i,vertexIndex:t,calibrationPointMeasureValue:o},r)})},e.prototype.getCalibrationMeasureLookupKey=function(e,t){return e+"_"+t},e.prototype.toMultiPartArray=function(){var r=this,n=[];return this.parts.forEach(function(e){var t=e.map(function(e){return r.options.returnZValues?[e.longitude,e.latitude,e.altitude||0]:[e.longitude,e.latitude]});n.push(t)}),n},e.prototype.ensurePolygonIsClosed=function(e){if(1<e.length){var t=S(e,1)[0],r=ie(e),n=S(t,3),o=n[0],i=n[1],a=n[2],s=S(r,2),u=s[0],c=s[1];if(!this.arePointsEquivalent(o,i,u,c)){var l=[o,i,a||0];e.push(l)}}},e.prototype.addPositionToPath=function(e){this.currentPart.push(e),this.calibratedMeasures.has($a)&&this.addPendingCalibrationPoint()},e.prototype.addPendingCalibrationPoint=function(){var e=this.calibratedMeasures.get($a),t=e.timestamp,r=S(this.currentPart.slice(-2),2),n=r[0],o=r[1];if(t>n.timestamp&&t<o.timestamp){var i=Math.abs(o.timestamp-n.timestamp),a=Math.abs(t-n.timestamp)/i,s=hi(n.latitude,n.longitude,o.latitude,o.longitude,Yr.Mile),u=a*s;if(this.trySnapCalibrationMeasureToVertex(e.measure,s,u))return;var c=g([n.longitude,n.latitude],[o.longitude,o.latitude]),l=h([n.longitude,n.latitude],u,c,{units:"kilometers"}),p=this.currentPart.length-1,f=Object.assign({},o,{longitude:l.geometry.coordinates[0],latitude:l.geometry.coordinates[1],deviceSource:Ca});this.calibratedMeasures["delete"]($a),this.addCalibrationMeasureAtIndex(e.measure,p,this.currentPartIndex),this.currentPart.splice(p,0,f)}else{if(!(t>=o.timestamp))throw new Error("Calibration measure timestamp '"+e.timestamp+"' can not be located between '"+n.timestamp+"' and '"+o.timestamp+"'");this.addCalibrationMeasureToLastPosition(e.measure)}},e.prototype.trySnapCalibrationMeasureToVertex=function(e,t,r){var n=t-r,o=Xr(this.options.calibrationMeasureSnappingDistanceDelta,this.options.calibrationMeasureSnappingDistanceDeltaUnit,Yr.Kilometer);if(r<o||n<o){var i=this.currentPart.length-2,a=this.currentPart.length-1,s=r<n?i:a;return this.addCalibrationMeasureAtIndex(e,s,this.currentPartIndex),this.calibratedMeasures["delete"]($a),!0}return!1},e.prototype.arePositionsEquivalent=function(e,t){return this.arePointsEquivalent(e.longitude,e.latitude,t.longitude,t.latitude)},e.prototype.arePointsEquivalent=function(e,t,r,n){return Kt(e,t,r,n,this.options.pointEquivalencyPrecision)},e.prototype.tryStoreUnfilteredPath=function(e){return this.options.storeUnfilteredPath&&this.unfilteredPath.push(e),this},e}();function es(e){return 180*e/Math.PI}var ts=function(){function e(){}return e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("GeometryConfig")],e)}();function rs(e){return e*e}function ns(e,t){return rs(e.x-t.x)+rs(e.y-t.y)}function os(e,t,r){return Math.sqrt(function i(e,t,r){var n=ns(t,r);if(0===n)return ns(e,t);var o=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return ns(e,o<0?t:1<o?r:{x:t.x+o*(r.x-t.x),y:t.y+o*(r.y-t.y)})}(e,t,r))}function is(e,t,r){var n=_o(e),o=_o(t),i=_o(r),a=S(n,2),s=a[0],u=a[1],c=S(o,2),l=c[0],p=c[1],f=S(i,2);return os({x:s,y:u},{x:l,y:p},{x:f[0],y:f[1]})}function as(e,r,n){void 0===n&&(n=!0);var t,o,i,a,s=[];gn(e).forEach(function(e){var t=function o(e,r,n){return e.map(function(e,t){return function a(e,t,r,n){var o=r?function i(e,t){var r=_o(t);return di(e[1],e[0],r[1],r[0])}(e,t):li(e,t);return{pointCoordinate:e,distance:o,index:n}}(e,r,n,t)})}(e,r,n);Tt(s,t)}),s.forEach(function(e){(!t||e.distance<t.distance)&&(t=e),(!o||e.distance>o.distance)&&(o=e),(!i||e.pointMeasure<i.pointMeasure)&&(i=e),(!a||e.pointMeasure>a.pointMeasure)&&(a=e)});var u=s[t.index-1],c=s[t.index+1],l=c,p=u;u&&c&&(is(r,t.pointCoordinate,u.pointCoordinate)<is(r,t.pointCoordinate,c.pointCoordinate)&&(p=s[(l=u).index-2]));return{nearestPoint:t,furthestPoint:o,nextPoint:l,previousPoint:p,minPoint:i,maxPoint:a}}function ss(e,t,r){void 0===r&&(r=!0);var n=as(e,t,r);return[n.nearestPoint?n.nearestPoint.pointCoordinate:null,n.nextPoint?n.nextPoint.pointCoordinate:null]}function us(e,t,r){return e<r&&r<t}function cs(e,t,r,n,o,i){throw new Error("AHHH!")}function ls(e,t,r,n){void 0===n&&(n=0);var o=_o(e),i=_o(t),a=_o(r),s=S(o,2),u=s[0],c=s[1],l=S(i,2),p=l[0],f=l[1],d=S(a,2),h=d[0],g=d[1],y=(f-c)/(p-u)*h+c;return y<=g+n&&g-n<=y&&u<=h&&h<=p}var ps=function(){function e(){this.refreshInterval=1e3,this.urlTemplate="http://localhost:12175/gps/{endpoint}?noCache={cacheBuster}",this.getInfoEndpoint="getGpsInfo",this.getVersionEndpoint="getVersion",this.jsonpParameterName="jsonp",this.geolocatorName="GpsGate Client",this.geolocatorDescription="GpsGate client that can connect to a variety of GPS data sources."}return e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("GpsGateConfig")],e)}(),fs=function(o){function e(e,t,r){var n=o.call(this,e)||this;return n.http=t,n.config=r,n.capabilities=[_a.Altitude,_a.AltitudeAccuracy,_a.Heading,_a.Speed,_a.HDOP],n.accuracyUnit=Ra.Hdop,n}return v(e,o),Object.defineProperty(e.prototype,"name",{get:function(){return this.config.geolocatorName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this.config.geolocatorDescription},enumerable:!0,configurable:!0}),e.prototype.getCurrentPosition=function(e){var n=this,t=G(this.config.urlTemplate,{endpoint:this.config.getInfoEndpoint,cacheBuster:(new Date).getTime()});return this.http.jsonp(t,this.config.jsonpParameterName).pipe(y.map(function(e){var t=new Date(e.trackPoint.utc).getTime(),r=Object.assign({timestamp:t,accuracy:e.trackPoint.precision.hdop,altitudeAccuracy:null,speed:e.trackPoint.velocity.groundSpeed,heading:e.trackPoint.velocity.heading,hdop:e.trackPoint.precision.hdop},e.trackPoint.position);return n.log.trace("Received current position for "+n.name),r})).toPromise()},e.prototype.watchPosition=function(e){var t,r=this,o=new l.Subject,n=setInterval(function(){r.getCurrentPosition(e).then(function(e){(function n(e,t){return!function r(e,t){return e&&t&&e.timestamp===t.timestamp&&e.latitude===t.latitude&&e.longitude===t.longitude&&e.accuracy===t.accuracy&&e.speed===t.speed&&e.heading===t.heading&&e.altitude===t.altitude&&e.altitudeAccuracy===t.altitudeAccuracy&&e.pdop===t.pdop&&e.hdop===t.hdop&&e.vdop===t.vdop&&e.tdop===t.tdop}(e,t)})(e,t)&&o.next(e),r.log.trace("Received watch position for "+r.name),t=e})["catch"](function(e){return o.error(e)})},this.config.refreshInterval);return o.pipe(y.finalize(function(){return clearInterval(n)}))},e.prototype.isAvailable=function(){return this.getVersion().pipe(y.map(function(e){return Boolean(e)}),y.catchError(function(){return l.of(!1)}))},e.prototype.getVersion=function(){var e=G(this.config.urlTemplate,{endpoint:this.config.getVersionEndpoint,cacheBuster:(new Date).getTime()});return this.http.jsonp(e,this.config.jsonpParameterName)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:z},{type:m.HttpClient},{type:ps}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(z),s.inject(m.HttpClient),s.inject(ps))},token:e,providedIn:"root"}),e=b([La("gps-gate"),E("design:paramtypes",[z,m.HttpClient,ps])],e)}(Oa);var ds=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,We,Na],declarations:[],exports:[],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),hs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t}(ca),gs={Center:"center",Left:"left",Right:"right",Sld:"sld",Map:"map",Lane:"lane",Shoulder:"shoulder",Curb:"curb"},ys=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t}(ca),ms=function(){function e(e,t,r){this.mapService=e,this.dataSourceService=t,this.dataSourceConfig=r}return e.prototype.getUniqueValues=function(e,t,r,n){var o,i={gdbVersion:t.versionName};return n&&(i.where=n,o=(new m.HttpParams).set("where",n)),e.serviceUrl?this.mapService.getUniqueValues(e.serviceUrl,t,r,i):this.dataSourceService.getUniqueColumnValues(e.id,t.featureClassName,uo(r),o)},e.prototype.getQueryCount=function(e,t,r){return e.serviceUrl?this.mapService.getQueryCount(e.serviceUrl,t,r,{gdbVersion:t.versionName}):this.dataSourceService.getRecordCount(e.id,t.featureClassName,r,t.versionName)},e.prototype.queryRoutesByIds=function(e,t,r){if(!r||!r.length)throw new Error("Failed to query routes. No route IDs supplied.");if(!t.compositeRouteIdFieldName)throw new Error("Failed to query routes. No 'compositeRouteIdFieldName' property found for layer.");var n=t.compositeRouteIdFieldName+" IN ('"+r.join("','")+"')";return this.queryRoutes(e,t,n)},e.prototype.queryRoutes=function(e,t,r){var n=no(t.fields);return e.serviceUrl?this.mapService.queryRoutes(e.serviceUrl,t,r,{gdbVersion:t.versionName}):this.dataSourceService.querySpatialData(e.id,t.featureClassName,r,t.versionName,null,null,!0,n)},e.prototype.searchRoutesByText=function(e,t,r){var n,o=Boolean(e.serviceUrl),i=no(t.fields);return o||(n=new bo({quoteFields:!this.dataSourceConfig.skipColumnQuotes}).whereLike(t.displayField,r).toWhereClause()),o?this.mapService.searchRoutesByText(e.serviceUrl,t,r,{gdbVersion:t.versionName}):this.dataSourceService.querySpatialData(e.id,t.featureClassName,n,t.versionName,null,null,!0,i)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:la},{type:On},{type:In}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(la),s.inject(On),s.inject(In))},token:e,providedIn:"root"}),e}(),vs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataSourceLrsMetadataEndpoint="api/spatial/data/sources/{dataSourceId}/lrs/meta",e.cacheInSessionLrsMetadata=!0,e}return v(e,t),e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("LrsConfig")],e)}(M),bs=function(n){function e(e,t){var r=n.call(this,e,{url:N(t.serviceUrl,t.dataSourceLrsMetadataEndpoint),idFieldName:"dataSourceId"})||this;return r.http=e,r}return v(e,n),e.prototype.create=function(e,t,r){return(t=t||{}).id=e.dataSourceId,n.prototype.create.call(this,e,t,r)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:vs}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(vs))},token:e,providedIn:"root"}),e}(Ie);var Es=function(n){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=n.apply(this,P(e))||this;return r.capturePositions=r.capturePositions?r.capturePositions:[],r}return v(e,n),e.prototype.getPositionByValue=function(t){return this.capturePositions.find(function(e){return e.value===t})},e.prototype.getPositions=function(t){return this.capturePositions.filter(function(e){return e.position===t})},e.prototype.hasPosition=function(e){return 0<this.getPositions(e).length},Object.defineProperty(e.prototype,"hasAnyPositions",{get:function(){return 0<this.capturePositions.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasLanePosition",{get:function(){return 0<this.getPositions(gs.Lane).length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasLeftPosition",{get:function(){return 0<this.getPositions(gs.Left).length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasRightPosition",{get:function(){return 0<this.getPositions(gs.Right).length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasCenterPosition",{get:function(){return 0<this.getPositions(gs.Center).length},enumerable:!0,configurable:!0}),e}(ca),Is=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t}(Es);function Ss(o){return o.routeIdFields.map(function(t,e){var r=0===e,n=o.fields.find(function(e){return e.name===t});if(!n)throw new Error("Invalid network layer 'routeIdFields' configuration. Field '"+t+"' not found on layer.");return{isRoot:r,label:n.alias,networkLayerIdFieldName:n.name}})}var Ps=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t}(ca);function Ms(t){for(var r,e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach(function(e){r=r||(e||[]).find(function(e){return e&&e.id===t})}),r}var Cs=function(n){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=n.apply(this,P(e))||this;return r.routeIdFields=r.routeIdFields||[],r.eventLayers=r.eventLayers||[],r.intersectionLayers=r.intersectionLayers||[],r.hierarchyFilter=r.hierarchyFilter&&r.hierarchyFilter.length?r.hierarchyFilter:Ss(r),r}return v(e,n),e}(Es),ws=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),Object.defineProperty(t.prototype,"effectiveDateFieldName",{get:function(){return this.fromDateFieldName},set:function(e){this.fromDateFieldName=e},enumerable:!0,configurable:!0}),t}(Es),Ts=function(){function t(){}return t.prototype.assign=function(e){return Object.assign(this,e),this},t.prototype.clone=function(){var e=Ot(this);return(new t).assign(e)},t}(),Ls=new sn("Layer '{name}'").add(new sn("should have list of fields").pass(function(e){return Boolean(e.fields&&e.fields.length)}),new sn("should have an ID field in list of fields").pass(function(e){return Boolean(oo(e.fields))})),Rs=new sn("Network layer '{name}' (ID: {id})").add(new sn("should have a 'Composite Route ID Field Name' value specified").pass(function(e){return Boolean(e.compositeRouteIdFieldName)})),Os=new sn("Event layer '{name}' (ID: {id})").add(new sn("should have a 'From Measure Field Name' value specified").pass(function(e){return Boolean(e.compositeRouteIdFieldName)})),Ds=new sn("LRS Metadata").add(new sn("should have network layers").pass(function(e){return Boolean(e.networkLayers&&e.networkLayers.length)}),new sn("should have event layers").pass(function(e){return Boolean(e.eventLayers&&e.eventLayers.length)})),_s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t}(ca);function js(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return Ms.apply(void 0,P([e],t))}var Ns=function(r){function t(e){var t=r.call(this)||this;return t.networkLayers=[],t.eventLayers=[],t.redlineLayers=[],t.centerlineLayers=[],t.calibrationPointLayers=[],t.intersectionLayers=[],t.nonLRSLayers=[],t.lrs=[],t.domains=[],e&&(t.dataSource=e,t.dataSourceId=e.id),t}return v(t,r),t.prototype.getLayer=function(e){return js(e,this.getAllLayers())},t.prototype.getLrsLayer=function(e){return js(e,this.networkLayers,this.eventLayers,this.redlineLayers)},t.prototype.getLayerDetail=function(e){var t=this.isLrsLayer(e),r=this.isEventLayer(e),n=!r&&this.isNetworkLayer(e),o=!r&&!n&&this.isCalibrationPointLayer(e),i=!r&&!n&&!o&&this.isCenterlineLayer(e),a=!r&&!n&&!o&&!i&&this.isIntersectionLayer(e),s=!r&&!n&&!o&&!i&&!a&&this.isRedlineLayer(e),u=!r&&!n&&!o&&!i&&!a&&!s&&this.isTable(e),c=!r&&!n&&!o&&!i&&!a&&!s&&!u&&this.isNonLRSLayer(e),l=this.getLayer(e);return{layer:l,layerId:e,isEventLayer:r,isNetworkLayer:n,isCalibrationPointLayer:o,isCenterlineLayer:i,isIntersectionLayer:a,isRedlineLayer:s,isTable:u,isNonLRSLayer:c,isLrsLayer:t,shapeField:l?ro(l.fields):null,idField:l?oo(l.fields):null}},t.prototype.isLrsLayer=function(e){return Boolean(this.getLrsLayer(e))},t.prototype.isNetworkLayer=function(e){return Boolean(js(e,this.networkLayers))},t.prototype.isEventLayer=function(e){return Boolean(js(e,this.eventLayers))},t.prototype.isIntersectionLayer=function(e){return Boolean(js(e,this.intersectionLayers))},t.prototype.isRedlineLayer=function(e){return Boolean(js(e,this.redlineLayers))},t.prototype.isCenterlineLayer=function(e){return Boolean(js(e,this.centerlineLayers))},t.prototype.isCalibrationPointLayer=function(e){return Boolean(js(e,this.calibrationPointLayers))},t.prototype.isNonLRSLayer=function(e){return Boolean(js(e,this.nonLRSLayers))},t.prototype.isTable=function(e){return Boolean(js(e,this.tables))},t.prototype.mergeMapMetadata=function(e){return qs(this,e),this},t.prototype.deepMergeMapMetadata=function(e){return Ws(this,e),this},t.prototype.mergeLrsMetadata=function(e){return Hs(this,e),this},t.prototype.getNetworkLayer=function(e){return js(e,this.networkLayers)},t.prototype.getEventLayer=function(e){return js(e,this.eventLayers)},t.prototype.getIntersectionLayer=function(e){return js(e,this.intersectionLayers)},t.prototype.getLrsLayers=function(){return this.eventLayers.concat(this.networkLayers).concat(this.redlineLayers)},t.prototype.getFeatureClassLayers=function(){return this.eventLayers.concat(this.networkLayers).concat(this.redlineLayers).concat(this.calibrationPointLayers).concat(this.centerlineLayers).concat(this.nonLRSLayers)},t.prototype.getAllLayers=function(){return this.getFeatureClassLayers().concat(this.tables).concat(this.layers)},t.prototype.getNetworkIdForLayer=function(t){var r=null;if(this.isEventLayer(t.id)){var e=t;r=e.parentNetwork?e.parentNetwork.id:null}return ce(r)&&this.networkLayers.forEach(function(e){e.eventLayers.find(function(e){return e.id===t.id})&&(r=e.id)}),r},t.prototype.getEventLayersByNetwork=function(e){var r=this.getNetworkLayer(e);return this.eventLayers.filter(function(t){return t.parentNetwork&&t.parentNetwork.id===e||r.eventLayers&&r.eventLayers.find(function(e){return e.id===t.id})})},t.prototype.rebuildLayers=function(){var t=this;return this.eventLayers=this.eventLayers.map(function(e){return new Is(js(e.id,t.layers),e)}),this.networkLayers=this.networkLayers.map(function(e){return new Cs(js(e.id,t.layers),e)}),this.redlineLayers=this.redlineLayers.map(function(e){return new ws(js(e.id,t.layers),e)}),this.centerlineLayers=this.centerlineLayers.map(function(e){return new ys(e)}),this.calibrationPointLayers=this.calibrationPointLayers.map(function(e){return new hs(e)}),this.intersectionLayers=this.intersectionLayers.map(function(e){return new Ps(e)}),this.nonLRSLayers=this.nonLRSLayers.map(function(e){return new _s(js(e.id,t.layers),e)}),this.assignCodedValueDomainsToFields()},t.prototype.assignCodedValueDomainsToFields=function(){var t=this;return this.domains.length&&this.getFeatureClassLayers().forEach(function(e){return e.applyFieldDomains(t.domains)}),this},t.prototype.assign=function(e){return Object.assign(this,e),this},t.prototype.clone=function(){var e=Ot(this);return(new t).assign(e).rebuildLayers()},t.prototype.validate=function(){return Ds.check(this)},t}(Ts);function ks(e){e.fields=e.fields||[]}function As(e){e&&(e.hierarchyFilter=e.hierarchyFilter||[])}function Fs(e,t){mr(e,t,{ignoreArrays:!0}),e&&e.codedValues&&t&&t.codedValues&&vr(e.codedValues,t.codedValues,{identifier:"code"})}function Us(e,t){vr(e=e||[],t=t||[],{identifier:"name",beforeMerge:function(e,t){if(e.domain&&t.domain&&t.domain.codedValues){var r=t.domain.codedValues.filter(function(e){return me(e.order)});if(r&&r.length)return Fs(e.domain,t.domain),!1}}})}function xs(e,t){if(e&&t){var r=e,n=t,o=r.capturePositions||[],i=n.capturePositions||[],a=r.drawingInfo,s=n.drawingInfo,u=Boolean(a||s),c=new ra(r.drawingInfo,n.drawingInfo);mr(e,t,{ignoreArrays:!0}),Us(e.fields,t.fields),u&&(e.drawingInfo=c),!o.length&&i.length&&(r.capturePositions=i)}}function Gs(o,e,i,t,r){void 0===t&&(t=!0),void 0===r&&(r=null),e=e||[],(o=o||[]).forEach(function(t){ks(t),xs(t,e.find(function(e){return e.id===t.id}))}),e.filter(function(t){return!o.find(function(e){return t.id===e.id})}).forEach(function(e){var t=e;if(i){var r=function n(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return Ms.apply(void 0,P([e],t))}(e.id,i.tables,i.layers,i.nonLRSLayers);xs(t=Object.assign({},r),e)}ks(t),o.push(t)}),t&&o.sort(function(e,t){return e.order-t.order}),r&&o.forEach(function(t){r(t,e.find(function(e){return e.id===t.id}))})}function Vs(e,t,r){Gs(e,t,r,!0,Bs)}function Bs(e,t){As(e),As(t),e&&t&&vr(e.hierarchyFilter,t.hierarchyFilter,{identifier:"name"})}function Hs(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];e.forEach(function(e){var t=e.dataSource||r.dataSource;mr(r,e,{ignoreArrays:!0}),t&&(r.dataSource=t),Vs(r.networkLayers,e.networkLayers,r),Gs(r.eventLayers,e.eventLayers,r),Gs(r.calibrationPointLayers,e.calibrationPointLayers,r),Gs(r.intersectionLayers,e.intersectionLayers,r),Gs(r.centerlineLayers,e.centerlineLayers,r),Gs(r.redlineLayers,e.redlineLayers,r),Gs(r.nonLRSLayers,e.nonLRSLayers,r),Gs(r.layers,e.layers),Gs(r.tables,e.tables)})}function qs(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];e.forEach(function(e){Object.assign(t,e)})}function Ws(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];e.forEach(function(e){e.layers.forEach(function(e){var t=n.getLrsLayer(e.id);if(t){var r=P(e.fields);Us(r,t.fields),t.fields=r,e.geometryType&&(t.geometryType=e.geometryType),t.drawingInfo=new ra(e.drawingInfo,t.drawingInfo)}})})}function Ys(e,t,r,n){var o=Boolean(r),i=r||t||new Ns(e);return i.mergeMapMetadata(n),i.dataSource=i.dataSource||e,i.dataSourceId=i.dataSourceId||e.id,o?i.mergeLrsMetadata(t):i.deepMergeMapMetadata(n),i.rebuildLayers(),i}var Qs=function(){function e(e,t,r,n,o,i){this.http=e,this.mapServer=t,this.dataSourceService=r,this.dataSourceLrsMetadataService=n,this.notify=o,this.log=i}return e.prototype.withDataSource=function(e){return O(e)?this.dataSourceId=e:(this.dataSource=e,this.dataSourceId=this.dataSource.id),this},e.prototype.withLrsMetadata=function(e){return this.dataSourceLrsMetadata=e,this},e.prototype.retrieve=function(){if(!this.dataSourceId)throw new Error("A data source ID must be supplied");return l.of(null).pipe(y.mergeMap(this.getDataSource.bind(this)),y.mergeMap(this.getDataSourceLrsMetadata.bind(this)),y.mergeMap(this.getMapServiceLayers.bind(this)),y.mergeMap(this.getMapServiceLrsMetadata.bind(this)),y.mergeMap(this.mergeAll.bind(this)))},e.prototype.getDataSource=function(){var t=this,e=this.dataSource?l.of(this.dataSource):this.dataSourceService.get(this.dataSourceId).pipe(y.tap(function(e){return t.dataSource=e}));return this.notify["with"](e).error("Failed to retrieve data source by ID: "+this.dataSourceId+": {error}").source},e.prototype.getDataSourceLrsMetadata=function(){var t=this,e=this.dataSourceLrsMetadata?l.of(this.dataSourceLrsMetadata):this.dataSourceLrsMetadataService.get(this.dataSourceId).pipe(y.tap(function(e){t.dataSourceLrsMetadata=new Ns(t.dataSource).assign(e),e||(t.dataSourceLrsMetadata.serviceHasLrsMeta=!0)}));return this.notify["with"](e).error("Failed to retrieve data source LRS metadata by data source ID: "+this.dataSourceId+": {error}").source},e.prototype.getMapServiceLayers=function(){var t=this,e=this.mapServerMetadata||!this.dataSource.serviceUrl?l.of(this.mapServerMetadata):this.mapServer.getMapLayers(this.dataSource.serviceUrl).pipe(y.tap(function(e){return t.mapServerMetadata=(new Ts).assign(e)}));return this.notify["with"](e).error("Failed to retrieve map service metadata from URL: "+this.dataSource.serviceUrl+": {error}").source},e.prototype.getMapServiceLrsMetadata=function(){var t=this,e=this.dataSource.serviceUrl&&this.dataSourceLrsMetadata.serviceHasLrsMeta?l.forkJoin([this.mapServer.getLrsServer(this.dataSource.serviceUrl),this.mapServer.getLrsLayers(this.dataSource.serviceUrl)]).pipe(y.map(function(e){var t=S(e,2),r=t[0],n=t[1],o=Object.assign({},r,n);return(new Ns).assign(o)}),y.tap(function(e){return t.mapServerLrsMetadata=(new Ns).assign(e)})):l.of(this.mapServerLrsMetadata);return this.notify["with"](e).error("Failed to retrieve map service LRS metadata from URL: "+this.dataSource.serviceUrl+": {error}").source},e.prototype.mergeAll=function(){var e=Ys(this.dataSource,this.dataSourceLrsMetadata,this.mapServerLrsMetadata,this.mapServerMetadata);return l.of(e)},e}(),zs=function(){function e(e,t,r,n,o,i,a){this.http=e,this.mapServer=t,this.dataSourceService=r,this.dataSourceLrsMetadataService=n,this.notify=o,this.config=i,this.log=a,this.lrsCache=[]}return e.prototype.get=function(e,t){var r=this,n=_n(e),o=this.lrsCache.find(function(e){return e.dataSourceId===n});return o?l.of(o.metaData):new Qs(this.http,this.mapServer,this.dataSourceService,this.dataSourceLrsMetadataService,this.notify,this.log).withDataSource(e).withLrsMetadata(t).retrieve().pipe(y.tap(function(e){return r.tryCacheLrsMetadata(e)}))},e.prototype.tryCacheLrsMetadata=function(e){this.config.cacheInSessionLrsMetadata&&this.lrsCache.push({dataSourceId:e.dataSourceId,metaData:e})},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:la},{type:On},{type:bs},{type:Pr},{type:vs},{type:z}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(la),s.inject(On),s.inject(bs),s.inject(Pr),s.inject(vs),s.inject(z))},token:e,providedIn:"root"}),e}(),Ks=function(n){function o(e,t){var r=n.call(this,e,t)||this;return r.routeId=r.getValue(t.routeIdFieldName),r.fromMeasure=r.getValue(t.fromMeasureFieldName),r.toMeasure=r.getValue(t.toMeasureFieldName),r.isLinear=Boolean(t.toMeasureFieldName),r}return v(o,n),o.create=function(e,t,r){return void 0===t&&(t={}),void 0===r&&(r=null),new o(oi(t,r),e)},o.prototype.setFromMeasure=function(e){return this.fromMeasure=e,this.setValue(this.layer.fromMeasureFieldName,e)},o.prototype.setToMeasure=function(e){if(!this.isLinear)throw new Error("Cannot set to measure for a point-based feature");return this.toMeasure=e,this.setValue(this.layer.toMeasureFieldName,e)},o.prototype.setMeasureExtent=function(e,t){return this.setFromMeasure(e).setToMeasure(t)},o.prototype.clone=function(){return new o(Ot(this.toFeature()),this.layer)},o.prototype.isGeometryTypeValid=function(){return En(this.geometry)||n.prototype.isGeometryTypeValid.call(this)},o}(ri),Xs=function Su(){this.fields=[],this.indexes=[],this.relationships=[]},$s=function(){function e(){}return e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("MapsConfig")],e)}(),Js=function(){function e(){this.allowMotionMocking=!0}return e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("MotionConfig")],e)}(),Zs=function(){function e(e){var t=this;this.config=e,this.motionChangeSource=new l.Subject,this.motionChange=this.motionChangeSource.asObservable(),l.fromEvent(window,"ondevicemotion").subscribe(function(e){return t.emitMotionChange(e)})}return e.prototype.mockMotion=function(e){if(!this.config.allowMotionMocking)throw new Error("Permission denied to mock device motion");return this.motionChangeSource.next(e),this},e.prototype.emitMotionChange=function(e){this.motionChangeSource.next({x:e.acceleration.x,y:e.acceleration.y,z:e.acceleration.z,withGravityX:e.accelerationIncludingGravity.x,withGravityY:e.accelerationIncludingGravity.y,withGravityZ:e.accelerationIncludingGravity.z,rotationRateAlpha:e.rotationRate.alpha,rotationRateBeta:e.rotationRate.beta,rotationRateGamma:e.rotationRate.gamma})},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:Js}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(Js))},token:e,providedIn:"root"}),e}(),eu=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule],declarations:[],exports:[],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}();function tu(e){var t=ci(e.alpha),r=ci(e.beta),n=ci(e.gamma),o=Math.cos(t),i=Math.sin(t),a=Math.sin(r),s=Math.cos(n),u=Math.sin(n),c=-o*u-i*a*s,l=-i*u+o*a*s,p=Math.atan(c/l);return p=es(p=p+=l<0?Math.PI:2*Math.PI)}var ru=function(){function e(){this.allowOrientationMocking=!0,this.allowHeadingMocking=!0}return e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("OrientationConfig")],e)}(),nu=function(){function e(e){var t=this;this.config=e,this.internalDeviceNeedsCalibrated=!1,this.headingChangeSource=new l.Subject,this.orientationChangeSource=new l.Subject,this.orientationChange=this.orientationChangeSource.asObservable(),this.headingChange=l.merge(this.headingChangeSource,this.orientationChange.pipe(y.map(function(e){return e.heading}))),l.fromEvent(window,"deviceorientation").subscribe(function(e){return t.emitOrientationChange(e)}),l.fromEvent(window,"oncompassneedscalibration").subscribe(function(){return t.internalDeviceNeedsCalibrated=!0}),l.fromEvent(window,"compassneedscalibration").subscribe(function(){return t.internalDeviceNeedsCalibrated=!0})}return Object.defineProperty(e.prototype,"deviceNeedsCalibrated",{get:function(){return this.internalDeviceNeedsCalibrated},enumerable:!0,configurable:!0}),e.prototype.mockOrientation=function(e){if(!this.config.allowOrientationMocking)throw new Error("Permission denied to mock device orientation");return this.orientationChangeSource.next(e),this},e.prototype.mockHeading=function(e){if(!this.config.allowHeadingMocking)throw new Error("Permission denied to mock heading");return this.headingChangeSource.next(e),this},e.prototype.emitOrientationChange=function(e){this.orientationChangeSource.next({alpha:e.alpha,beta:e.beta,gamma:e.gamma,heading:tu(e)})},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:ru}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(ru))},token:e,providedIn:"root"}),e}(),ou=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule],declarations:[],exports:[],providers:[],schemas:[s.CUSTOM_ELEMENTS_SCHEMA]}]}],e}(),iu=function(){function e(){this.isWorking=!1,this.isCanceled=!1,this.id=nn.newGuid().value}return Object.defineProperty(e.prototype,"isComplete",{get:function(){return!this.isWorking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ellapsedSeconds",{get:function(){return qt(new Date,this.startTime)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalProcessed",{get:function(){return this.totalComplete+this.totalFailed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recordsProcessedPerSecond",{get:function(){return this.totalComplete/this.ellapsedSeconds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recordsProcessedPerMinute",{get:function(){return 60*this.recordsProcessedPerSecond},enumerable:!0,configurable:!0}),e.prototype.start=function(){return this.reset(),this.startTime=new Date,this.isWorking=!0,this},e.prototype.reset=function(){return this.isWorking=!1,this.isCanceled=!1,this.totalComplete=0,this.totalFailed=0,this.startTime=null,this.endTime=null,this},e.prototype.calculateRemainingSeconds=function(e){return this.isComplete?0:jr(this.totalProcessed,this.ellapsedSeconds,e)},e.prototype.complete=function(){return this.endTime=new Date,this.isWorking=!1,this},e.prototype.cancel=function(){return this.isCanceled=!0,this.isWorking=!1,this},e}(),au={UnitOfWorkStarted:0,UnitOfWorkComplete:1,UnitOfWorkStatusUpdate:2,QueueWorkerStarted:3,QueueWorkerComplete:4,QueueStarted:5,QueueComplete:6};au[au.UnitOfWorkStarted]="UnitOfWorkStarted",au[au.UnitOfWorkComplete]="UnitOfWorkComplete",au[au.UnitOfWorkStatusUpdate]="UnitOfWorkStatusUpdate",au[au.QueueWorkerStarted]="QueueWorkerStarted",au[au.QueueWorkerComplete]="QueueWorkerComplete",au[au.QueueStarted]="QueueStarted",au[au.QueueComplete]="QueueComplete";var su=function(){function e(){this.totalQueueSize=0,this.workers=[]}return Object.defineProperty(e.prototype,"workerCount",{get:function(){return this.workers.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"percentComplete",{get:function(){return 0<=this.totalQueueSize&&Math.round(this.totalProcessed/this.totalQueueSize*100)||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalComplete",{get:function(){return this.workers.reduce(function(e,t){return e+t.totalComplete},0)||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalFailed",{get:function(){return this.workers.reduce(function(e,t){return e+t.totalFailed},0)||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalProcessed",{get:function(){return this.totalComplete+this.totalFailed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWorking",{get:function(){return Boolean(this.runningWorkerCount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isComplete",{get:function(){return this.startTime&&!this.isWorking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCanceled",{get:function(){var e=this.workers.filter(function(e){return e.isCanceled}).length;return Boolean(e&&e===this.workers.length)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"runningWorkerCount",{get:function(){return this.workers.filter(function(e){return e.isWorking}).length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){var e=this.workers.filter(function(e){return e.startTime}).map(function(e){return e.startTime?e.startTime.getTime():null});return new Date(Math.min.apply(Math,P(e)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endTime",{get:function(){var e=this.workers.filter(function(e){return e.startTime}).map(function(e){return e.startTime?e.startTime.getTime():null});return new Date(Math.max.apply(Math,P(e)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"remainingQueueSize",{get:function(){return this.totalQueueSize-this.totalProcessed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"estimatedSecondsLeft",{get:function(){var t=this.remainingQueueSize;return t?Dr(this.workers.map(function(e){return e.calculateRemainingSeconds(t)})):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"averageRecordsProcessedPerMinute",{get:function(){return Dr(this.workers.map(function(e){return e.recordsProcessedPerMinute}))},enumerable:!0,configurable:!0}),e.prototype.setQueueSize=function(e){return this.totalQueueSize=e,this},e.prototype.complete=function(){return this.workers.splice(0,this.workers.length),this.totalQueueSize=0,this},e.prototype.addWorker=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.forEach(function(e){t.workers.push(e)}),this},e.prototype.getStatus=function(){return{isWorking:this.isWorking,isCanceled:this.isCanceled,isComplete:this.isComplete,totalProcessed:this.totalProcessed,startTime:this.startTime,endTime:this.endTime,percentComplete:this.percentComplete,totalQueueSize:this.totalQueueSize,remainingQueueSize:this.remainingQueueSize,totalComplete:this.totalComplete,totalFailed:this.totalFailed,estimatedSecondsLeft:this.estimatedSecondsLeft,workerCount:this.workers.length}},e}(),uu={autoStartWorkers:!0,workerCount:1},cu=function(){function e(e,t){var r=this;this.log=e,this.workerTokens=[],this.tracker=new su,this.options=Object.assign({},uu),this.setOptions(t),this.queueChangeObserver=new l.Subject,this.queueChange=this.queueChangeObserver.pipe(),this.queueStarted=this.queueChangeObserver.pipe(y.filter(function(e){return e.event===au.QueueStarted})),this.queueComplete=this.queueChangeObserver.pipe(y.filter(function(e){return e.event===au.QueueComplete})),this.options.autoStartWorkers&&setTimeout(function(){return r.startWork()})}return Object.defineProperty(e.prototype,"isWorking",{get:function(){return this.tracker.isWorking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this.tracker.getStatus()},enumerable:!0,configurable:!0}),e.prototype.setOptions=function(e){return Object.assign(this.options,e),this},e.prototype.startWork=function(){var n=this,e=l.iif(function(){return!n.isWorking},this.getRemainingQueueCount().pipe(y.tap(function(e){return n.tracker.setQueueSize(e)})));this.onReady().pipe(y.mergeMap(function(){return e})).subscribe(function(){var e=n.options.workerCount-n.workerTokens.length;0<e&&n.emitQueueChange(null,au.QueueStarted);for(var t=0;t<e;t++){var r=(new iu).start();n.tracker.addWorker(r),n.workerTokens.push(r),n.emitQueueChange(r,au.QueueWorkerStarted),n.getNextAndDoWork(r)}})},e.prototype.stopWork=function(){this.workerTokens.forEach(function(e){return e.cancel()})},e.prototype.onReady=function(){return l.of(null)},e.prototype.onBeforeWorkStarted=function(e){return l.of(e)},e.prototype.onWorkComplete=function(e){return l.of(e)},e.prototype.onWorkFailed=function(e,t){return l.of(e,t)},e.prototype.getRemainingQueueCount=function(){return l.of(-1)},e.prototype.emitQueueChange=function(e,t,r,n){this.queueChangeObserver.next({event:t,input:r,output:n,status:this.tracker.getStatus(),tokenId:e?e.id:null})},e.prototype.emitWorkStarted=function(e,t,r){this.emitQueueChange(e,au.UnitOfWorkStarted,t,r)},e.prototype.emitWorkComplete=function(e,t,r){this.emitQueueChange(e,au.UnitOfWorkComplete,t,r)},e.prototype.onWorkerCompleted=function(e){if(!e.isComplete){var t=this.workerTokens.indexOf(e);e.complete(),-1!==t&&this.workerTokens.splice(t,1),this.emitQueueChange(e,au.QueueWorkerComplete),0===this.workerTokens.length&&(this.emitQueueChange(e,au.QueueComplete),this.tracker.complete())}},e.prototype.checkIfWorkerComplete=function(e,t){ce(t)&&this.onWorkerCompleted(e)},e.prototype.getNextAndDoWork=function(t){var r=this;t.isCanceled&&(this.log.debug("Canceling worker due to canceled toke: "+t.id),this.onWorkerCompleted(t)),this.log.trace("Retrieving next queue item to start processing");var n={input:null,output:null};this.getNext().pipe(y.tap(function(e){return n.input=e}),y.tap(function(e){return r.checkIfWorkerComplete(t,e)}),y.takeWhile(function(e){return J(e)&&!t.isCanceled}),y.tap(function(e){return r.emitWorkStarted(t,e)}),y.mergeMap(function(e){return r.onBeforeWorkStarted(e)}),y.mergeMap(function(e){return r.doWork(e)}),y.tap(function(e){return n.output=e}),y.map(function(){return n}),y.mergeMap(function(e){return r.onWorkComplete(e)})).subscribe(function(e){r.log.trace("Completed work for item"),t.totalComplete++,r.emitWorkComplete(t,e.input,e.output),r.getNextAndDoWork(t)},function(e){r.log.error("Failed to process item. {error}",e),t.totalFailed++,r.onWorkFailed(n,e).toPromise().then(function(){return r.getNextAndDoWork(t)})})},e}(),lu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.options=Object.assign({autoDequeu:!0},uu),e}return v(e,t),e.prototype.enqueuMany=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e.map(function(e){return t.enqueue(e)});return l.forkJoin(n).pipe(y.map(function(e){return e.pop()}))},e.prototype.dequeuMany=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e.map(function(e){return t.dequeue(e)});return l.forkJoin(n).pipe(y.map(function(e){return e.pop()}))},e.prototype.onWorkComplete=function(e){return l.forkJoin(t.prototype.onWorkComplete.call(this,e),this.dequeue(e.input)).pipe(y.map(function(e){return e[0]}))},e}(cu),pu={Queued:0,InProgress:1,Complete:2,Canceled:3,Failed:4};pu[pu.Queued]="Queued",pu[pu.InProgress]="InProgress",pu[pu.Complete]="Complete",pu[pu.Canceled]="Canceled",pu[pu.Failed]="Failed";var fu=function(){function e(){}return e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=b([D("QueueConfig")],e)}(),du=function(n){function e(e,t){var r=n.call(this,e,{url:N(t.serviceUrl,t.privilegesEndpoint)})||this;return r.http=e,r}return v(e,n),e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:ge}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(ge))},token:e,providedIn:"root"}),e}(Ie),hu="Missing role ID parameter",gu="Missing privilege identifier parameter",yu=function(n){function e(e,t){var r=n.call(this,e,{url:N(t.serviceUrl,t.rolesPrivilegesEndpoint),idFieldName:"roleId"})||this;return r.http=e,r}return v(e,n),e.prototype.query=function(e,t){if(!e||!e.roleId)throw new Error(hu);return n.prototype.query.call(this,e,t)},e.prototype.get=function(e,t,r){throw new Error(H)},e.prototype.create=function(e,t,r){throw new Error(q)},e.prototype.update=function(e,t,r){if(!t||!t.roleId)throw new Error(hu);if(!t.privilegeId)throw new Error(gu);return n.prototype.update.call(this,null,t,r)},e.prototype["delete"]=function(e,t,r){if(!t||!t.roleId)throw new Error(hu);if(!t.privilegeId)throw new Error(gu);return n.prototype["delete"].call(this,e,t,r)},e.prototype.privilegesByRole=function(e,t){return this.query({roleId:e},t)},e.prototype.addPrivilegeToRole=function(e,t){return this.update(null,{roleId:e,privilegeId:t})},e.prototype.removePrivilegeFromRole=function(e,t){return this["delete"](e,{roleId:e,privilegeId:t})},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:ge}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(ge))},token:e,providedIn:"root"}),e}(Ie),mu=function(n){function e(e,t){var r=n.call(this,e,{url:N(t.serviceUrl,t.rolesEndpoint)})||this;return r.http=e,r}return v(e,n),e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:ge}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(ge))},token:e,providedIn:"root"}),e}(Ie),vu="Missing user ID parameter",bu=function(n){function e(e,t){var r=n.call(this,e,{url:N(t.serviceUrl,t.userRolesEndpoint),idFieldName:"userId"})||this;return r.http=e,r}return v(e,n),e.prototype.query=function(e,t){if(!e||!e.userId)throw new Error(vu);return n.prototype.query.call(this,e,t)},e.prototype.get=function(e,t,r){throw new Error(H)},e.prototype.create=function(e,t,r){throw new Error(q)},e.prototype.update=function(e,t,r){if(!t||!t.userId)throw new Error(vu);if(!t.roleName)throw new Error(hu);return n.prototype.update.call(this,null,t,r)},e.prototype["delete"]=function(e,t,r){if(!t||!t.userId)throw new Error(vu);if(!t.roleName)throw new Error(hu);return n.prototype["delete"].call(this,e,t,r)},e.prototype.rolesByUser=function(e,t){return this.query({userId:e},t)},e.prototype.addUserToRole=function(e,t,r){return n.prototype.update.call(this,t,{userId:e,roleName:"_"},r)},e.prototype.addUserToRoleByName=function(e,t,r){return t=decodeURIComponent(t),this.update(null,{userId:e,roleName:t},r)},e.prototype.removeUserFromRole=function(e,t,r){return this.removeUserFromRoleByName(e,t.name,r)},e.prototype.removeUserFromRoleByName=function(e,t,r){return t=decodeURIComponent(t),this["delete"](e,{userId:e,roleName:t},r)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:ge}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(ge))},token:e,providedIn:"root"}),e}(Ie),Eu=function(n){function e(e,t){var r=n.call(this,e,{url:N(t.serviceUrl,t.usersEndpoint)})||this;return r.http=e,r}return v(e,n),e.prototype.usersByRoleId=function(e,t){return t=(t||new m.HttpParams).set("filterByRoleId",e),this.query({},t)},e.prototype.usersByRoleName=function(e,t){return t=(t||new m.HttpParams).set("filterByRoleName",e),this.query({},t)},e.prototype.search=function(e,t){return t=(t||new m.HttpParams).set("search",e),this.query({},t)},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:m.HttpClient},{type:ge}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(m.HttpClient),s.inject(ge))},token:e,providedIn:"root"}),e}(Ie);e.ApiService=Q,e.AppInitializerFactory=Me,e.AppInitializerService=Pe,e.AppProfileService=Se,e.ALL_APPS_QUERY_ID="all",e.TssAppSpatialModule=ft,e.DEFAULT_APP_ID="all",e.DEFAULT_PROFILE_ID=_,e.AppConfig=j,e.TssAppModule=pt,e.AppSettingService=dt,e.ALL_APP_SETTINGS_QUERY_ID="all",e.CachePersistence={Persistent:"persistent",InMemory:"in-memory"},e.CacheStrategy=ht,e.CacheConfig=gt,e.CACHE_ONLY_NO_DATA_EXC_MSG=yt,e.CacheInterceptor=Ct,e.TssCacheModule=wt,e.CacheService=bt,e.CACHE_STORAGE_KEY_PREFIX=mt,e.PersistentCacheStorage=vt,e.addIfNotExist=function Pu(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];e.forEach(function(e){-1===t.indexOf(e)&&t.push(e)})},e.addRangeToBeginning=function Mu(e,t){e.unshift.apply(e,P(t))},e.addRange=Tt,e.getLastItem=ie,e.removeDuplicates=function Cu(e){return e.filter(function(e,t,r){return r.indexOf(e)===t})},e.removeItem=Lt,e.removeWhere=Rt,e.AutoConfig=D,e.clone=Ot,e.hexToRgb=function wu(e){var t=null;e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,r,n){return t+t+r+r+n+n});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r&&(t=[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]),t},e.isHexColor=function Tu(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},e.rgbToHex=Dt,e.transparencyToOpacity=_t,e.getCookie=function Lu(t){var r=t.length+1;return document.cookie.split(";").map(function(e){return e.trim()}).filter(function(e){return e.substring(0,r)===t+"="}).map(function(e){return decodeURIComponent(e.substring(r))})[0]||null},e.CoreConfig=L,e.TssCoreModule=We,e.addDays=kt,e.addHours=At,e.addMilliseconds=jt,e.addMinutes=Nt,e.addSeconds=Ft,e.millisecondsToDays=Ve,e.millisecondsToHours=Ge,e.millisecondsToMinutes=xe,e.millisecondsToSeconds=Ue,e.toMilliseconds=Fe,e.toStandardizedQueryDateFormat=function Ru(e){return xt(e=Ut(e),Te)},e.toUtcDate=Ut,e.toUtcEpochDate=Gt,e.STANDARDIZED_QUERY_DATE_FORMAT=Te,e.ORACLE_DATE_FORMAT=Le,e.DEFAULT_DATE_FORMAT=Re,e.HOURS_PER_DAY=Oe,e.MINUTES_PER_HOUR=De,e.SECONDS_PER_MINUTE=60,e.MILLISECONDS_PER_SECOND=_e,e.MILLISECONDS_PER_MINUTE=je,e.MILLISECONDS_PER_HOUR=Ne,e.MILLISECONDS_PER_DAY=ke,e.READABLE_TIME_SUFFIX_MAP=Ae,e.formatDateForQuery=Vt,e.formatDate=xt,e.SqlDateFormat=Bt,e.getCurrentDateAsUtc=function Ou(){return Ut(new Date)},e.getCurrentDateEpochAsUtc=function Du(){return Ut(new Date).getTime()},e.getElapsedMilliseconds=Ht,e.getElapsedSeconds=qt,e.ReadableTimePipe=He,e.secondsToReadableTime=function _u(e,t){return void 0===t&&(t={}),Be(e*_e,t)},e.toReadableTime=Be,e.setDateToBeginningOfDay=Wt,e.setDateToEndOfDay=function ju(e){e.setHours(23,59,59)},e.subtractDays=function Nu(e,t){return kt(-1*e,t)},e.subtractMinutes=function ku(e,t){return Nt(-1*e,t)},e.subtractSeconds=function Au(e,t){return Ft(-1*e,t)},e.subtractHours=function Fu(e,t){return At(-1*e,t)},e.subtractMilliseconds=function Uu(e,t){return jt(-1*e,t)},e.hasLocalStorage=function xu(){return re()&&Boolean(window.localStorage)},e.hasWindow=re,e.OnlineOfflineService=Yt,e.almostEqual=zt,e.DEFAULT_POINT_EQUALITY_PRECISION=Qt,e.pointsAlmostEqual=Kt,e.errorMsg=$t,e.DEFAULT_ERROR_MSG=Xt,e.formatNumber=Jt,e.format=G,e.FIRST_LETTER_SEPERATED_BY_SPACE_MATCH_REGEX=Zt,e.PASCAL_CASE_FIRST_LETTER_MATCH_REGEX=er,e.LEADING_AND_TRAILING_UNDERSCORE_MATCH_REGEX=tr,e.LEADING_AND_TRAILING_HYPHEN_MATCH_REGEX=rr,e.UNDERSCORE_MATCH_REGEX=nr,e.HYPHEN_MATCH_REGEX=or,e.humanize=function Gu(e,t){void 0===t&&(t=!0);var r=(e||"").split(er).join(" ").replace(tr,"").replace(rr,"").replace(nr," ").replace(or," ").toLowerCase();return t?ir(r):ar(r)},e.lowerCaseFirst=de,e.trimEnd=sr,e.trim=function Vu(e,t){return void 0===t&&(t=" "),e=sr(e=ur(e,t),t)},e.trimStart=ur,e.upperCaseEachWord=ir,e.upperCaseFirstLetter=ar,e.groupBy=function Bu(e,n){var o=new Map;return e.forEach(function(e){var t=n(e),r=o.get(t);r?r.push(e):o.set(t,[e])}),o},e.KeysPipe=Ce,e.typeToLevel=w,e.levelToType=function Hu(e){if(e===C.Trace)return"trace";if(e===C.Debug)return"debug";if(e===C.Info)return"info";if(e===C.Warn)return"warn";if(e===C.Error)return"error";if(e===C.Fatal)return"fatal";throw new Error("Unknown log level: '"+e+"'")},e.LogLevel=C,e.Logger=z,e.base64MimeType=fr,e.base64toBlob=gr,e.base64toByteArray=hr,e.BASE_64_METADATA_REGEX=cr,e.JSON_MIME_TYPE=lr,e.TEXT_MIME_TYPE=pr,e.TEXT_FILE_EXTENSION=".txt",e.AUDIO_WEBM_MIME_TYPE="audio/webm",e.AUDIO_MP3_MIME_TYPE="audio/mpeg-3",e.AUDIO_MP3_FILE_EXTENSION=".mp3",e.VIDEO_WEBM_MIME_TYPE="video/webm;codecs=h264",e.VIDEO_MP4_MIME_TYPE="video/mp4",e.VIDEO_MP4_FILE_EXTENSION=".mp4",e.IMAGE_PNG_FILE_EXTENSION=".png",e.IMAGE_PNG_MIME_TYPE="image/png",e.IMAGE_JPEG_FILE_EXTENSION=".jpeg",e.IMAGE_JPEG_MIME_TYPE="image/jpeg",e.stripBase64Metadata=dr,e.mergeDeepArray=vr,e.mergeDeep=mr,e.BaseNotificationTracker=br,e.NotificationPromiseTracker=Er,e.NotificationSubscriptionTracker=Ir,e.NotifyType=Sr,e.NotifyService=Pr,e.assignValidValues=function qu(t,r){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];return 0===e.length&&(e=Object.keys(r)),e.filter(function(e){return J(r[e])}).forEach(function(e){return t[e]=r[e]}),t},e.getValue=function Wu(e,t){for(var r=t.split(".");r.length&&e;)e=e[r.shift()];return e},e.setValue=he,e.getRandomInteger=function Yu(e,t){return void 0===e&&(e=0),void 0===t&&(t=1e3),Math.floor(Math.random()*(t-e+1))+e},e.getRandomNumber=function Qu(e,t){return void 0===e&&(e=0),void 0===t&&(t=10),Math.random()*(t-e)+e},e.BaseEmptyResourceService=Y,e.BaseResourceService=Ie,e.NO_URL_ERROR_MSG=B,e.UNSUPPORTED_GET_EXCEPTION_MSG=H,e.UNSUPPORTED_CREATE_EXCEPTION_MSG=q,e.EMPTY_PARAM_VALUE=W,e.ResourceConfig=M,e.round=function zu(e,t){return void 0===t&&(t=3),me(e)?Number(e.toFixed(t)):e},e.SafeUrlPipe=qe,e.sortAndReorder=function Ku(e){Mr(e),e.forEach(function(e,t){return e.order=t+1})},e.sortByOrder=Mr,e.SortDirection=Cr,e.sortAscending=wr,e.sortDescending=function Xu(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return Tr.apply(void 0,P([e,Cr.Descending],t))},e.sort=Tr,e.average=Dr,e.calculateCrossProduct=_r,e.calculatePercentComplete=function $u(e,t){return 100*e/t},e.calculateRemainingSeconds=jr,e.isNumberBetweenOrEqual=Nr,e.isNumberBetween=function Ju(e,t,r){var n=Math.min(t,r),o=Math.max(t,r);return n<e&&e<o},e.StatsTracker=Ar,e.sumProperty=function Zu(e,t){return kr(e,function(e){return e[t]})},e.sumValues=Fr,e.sum=kr,e.BaseStorage=ee,e.FileSizePipe=we,e.formatByteSize=Z,e.getByteSize=K,e.InMemoryStorage=Ur,e.PersistentStorage=te,e.STORAGE_FORMAT_UNITS=X,e.NO_BYTES_FORMATTED="0 KB",e.extractTokenExpressions=Gr,e.extractTokenValuesFromTemplate=Pt,e.extractTokens=xr,e.hasTokens=Et,e.replaceToken=x,e.replaceTokens=U,e.standardizeTokens=It,e.stripTokenBraces=St,e.TOKEN_EXPRESSION=k,e.FULL_TOKEN_EXPRESSION=A,e.WILDCARD_EXPRESSION_VALUE=F,e.canBeNumber=pe,e.canNotBeNumber=le,e.isArray=ye,e.isBoolean=Vr,e.isDate=ue,e.isDefined=$,e.isFunction=it,e.isNotArray=Br,e.isNotBoolean=function ec(e){return!Vr(e)},e.isNotDate=function tc(e){return!ue(e)},e.isNotDefined=function rc(e){return!$(e)},e.isNotFunction=Hr,e.isNotNumber=qr,e.isNotObject=function nc(e){return!yr(e)},e.isNotPrimitive=function oc(e){return!Wr(e)},e.isNotString=function ic(e){return!O(e)},e.isNotType=function ac(e,t){return!R(e,t)},e.isNotValue=ce,e.isNumber=me,e.isObject=yr,e.isPrimitive=Wr,e.isString=O,e.isType=R,e.isValue=J,e.toPrimitiveType=fe,e.AreaUnit={Acres:"acres",Hectares:"hectares",SquareFeet:"square-feet",SquareMeters:"square-meters",SquareMiles:"square-miles"},e.convertAreaUnits=function sc(e,t){throw new Error("'convertAreaUnits' is not implemented yet")},e.convertLengthUnits=Xr,e.fromMeters=Kr,e.LengthUnit=Yr,e.MeasurementUnit=T,e.metersPerSecondToKilometersPerHour=function uc(e){return 3.6*e},e.metersPerSecondToMilesPerHour=function cc(e){return 2.237*e},e.toMeters=zr,e.LENGTH_UNIT_METER_CONVERSION_FACTOR=Qr,e.clean=V,e.ensureProtocol=function lc(e){return re()&&String(e).startsWith("//")&&(e=""+window.location.protocol+e),e},e.getBaseUrl=function pc(e){var t=S(V(e).split("#"),1)[0];return t=S(t.split("?"),1)[0]},e.getFirstHashRoutePath=se,e.getFullUrl=ne,e.getPostHashRoutePaths=ae,e.getQueryParams=oe,e.joinAndFomat=$r,e.join=N,e.parametersToString=function fc(t){return Object.keys(t).filter(function(e){return J(t[e])}).map(function(e){return e+"="+(yr(t[e])?JSON.stringify(t[e]):t[e])}).join("&")},e.removeEmptyParams=function dc(e){return e.replace(Jr,"")},e.stripTrailingSlash=Zr,e.EMPTY_PARAMS_REGEX=Jr,e.using=function hc(t,r){return function e(t,a,s,u){return new(s||(s=Promise))(function(e,r){function n(e){try{i(u.next(e))}catch(t){r(t)}}function o(e){try{i(u["throw"](e))}catch(t){r(t)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,o)}i((u=u.apply(t,a||[])).next())})}(this,void 0,void 0,function(){return I(this,function(e){switch(e.label){case 0:return e.trys.push([0,,2,4]),[4,r(t)];case 1:return e.sent(),[3,4];case 2:return[4,t.dispose()];case 3:return e.sent(),[7];case 4:return[2]}})})},e.INVALID_GUID_ERROR_MSG=en,e.Guid=nn,e.uuidValueReplacer=tn,e.uuid=rn,e.ValidationCheck=sn,e.ValidationResult=on,e.CsvConfig=un,e.CSV_NEW_LINE=cn,e.CSV_SEPARATOR=ln,e.TssCsvModule=pn,e.geometryToCsv=function gc(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o=[],n=[];if(dn(e))n=yn(e);else if(mn(e))n=bn(e);else{if(!En(e))throw new Error("Unknown or unsupported geometry type provided");n=yn(e.coordinates)}return n.map(function(r){var n={};o.push(n),t&&t.length||(t=["x","y"],2<r.length&&t.push("z"),3<r.length&&t.push("m")),t.forEach(function(e,t){n[e]=r[t]})}),fn(o)},e.toCsv=fn,e.APPLY_EDITS_SEED_POD_FILE_EXTENSION=".tssedits",e.DataSourceEditService=Sn,e.AttachmentType=Pn,e.AttachmentService=wn,e.ATTACHMENT_FILE_FORM_KEY="file",e.ATTACHMENT_DATA_FORM_KEY=Cn,e.DataSourceConfig=In,e.DataSourceProviderType=Tn,e.SELECT_ALL_WHERE_CLAUSE="1=1",e.DATA_SOURCE_PROVIDERS=Ln,e.DATA_SOURCE_EXAMPLES=Rn,e.TssDataSourceModule=Qe,e.DataSourceService=On,e.stripTableName=Dn,e.getDataSourceId=_n,e.getDateFormatForProvider=Nn,e.isEnterpriseProvider=function yc(e){return e===Tn.SqlServer||e===Tn.Oracle||e===Tn.OracleDevArt},e.isOracleProvider=jn,e.SEED_POD_FILE_EXTENSION=".tss",e.BaseEsriService=To,e.EsriConfig=Lo,e.EsriMapServerService=la,e.getEsriMapServiceHttOptions=Ei,e.addParamsToHttpOptions=Ii,e.MAP_SERVER_SERVICE_MATCH_IDENTIFIER=Pi,e.MAP_SERVER_SERVICE_IDENTIFIER=Mi,e.FEATURE_SERVER_SERVICE_IDENTIFIER=Ci,e.IMAGE_SERVER_SERVICE_IDENTIFIER=/(ImageServer|ImageServer\/)$'/,e.FEATURE_SERVER_LAYER_SERVICE_IDENTIFIER=wi,e.MAP_SERVER_LAYER_SERVICE_MATCH_IDENTIFIER=Ti,e.MAP_SERVER_LAYER_SERVICE_IDENTIFIER=Li,e.LRS_SERVER_SERVICE_IDENTIFIER=Ri,e.LRS_SERVER_LAYERS_SERVICE_IDENTIFIER=Oi,e.MAP_LAYERS_SERVICE_ENDPOINT="layers",e.MAP_LAYER_SERVICE_ENDPOINT=Di,e.MAP_LAYER_QUERY_SERVICE_ENDPOINT=_i,e.MAP_LAYER_QUERY_RELATED_RECORDS_SERVICE_ENDPOINT="layers/{layerId}/queryRelatedRecords",e.LRS_SERVER_META_ENDPOINT=ji,e.LRS_LAYERS_SERVICE_ENDPOINT=Ni,e.LRS_SERVER_APPLY_EDITS_ENDPOINT=ki,e.LRS_GEOMETRY_TO_MEASURE=Ai,e.PORTAL_SHARING_ENDPOINT=Fi,e.PORTAL_OAUTH_AUTHORIZE_ENDPOINT=Ui,e.PORTAL_OAUTH_TOKEN_ENDPOINT=xi,e.PORTAL_GENERATE_TOKEN_ENDPOINT=Gi,e.PORTAL_REDIRECT_URL_PARAMS_BREAK_CHARACTER="#",e.DEFAULT_PORTAL_OAUTH_REDIRECT_OPTIONS=Vi,e.TssEsriModule=ze,e.isFeatureServerLayerUrl=function mc(e){return wi.test(e)},e.isFeatureServerServiceUrl=pa,e.DEFAULT_GEOMETRY_TO_MEASURE_OPTIONS=Bi,e.getGeometryToMeasureOptions=Hi,e.isCacheableEsriServiceRoute=function vc(e,t){return t=S((t||"").split("?"),1)[0],Boolean(e&&t&&new RegExp(e,"gi").test(t)&&fa(t)||pa(t)||da(t)||ha(t))},e.joinAndFomatWithLayer=Ki,e.isLrsServerLayersServiceUrl=ha,e.isLrsServerServiceUrl=da,e.extractMapServerLayerId=function bc(e){var t=null,r=S((e||"").split(Ti),3)[2];return r&&(r=r.replace("/",""),t=Number(r)),t},e.extractMapServerUrl=function Ec(e){var t=S((e||"").split(Pi),1)[0];return t===e?null:N(t,"MapServer")},e.isMapServerLayerUrl=function Ic(e){return Li.test(e)},e.isMapServerServiceUrl=fa,e.doesPathIncludePortalAccessCode=function Sc(e){return e.includes("code=")},e.doesPathIncludePortalAccessToken=function Pc(e){return e.includes("access_token=")&&e.includes("expires_in=")},e.EsriPortalService=ba,e.extractPortalAccessToken=function Mc(e){void 0===e&&(e=window.location.hash);var t=e.lastIndexOf("#"),r=oe(ur(e.substr(t)));return ya({accessToken:r.access_token,username:r.username,expiresIn:Number(r.expires_in),isSecure:Boolean(r.ssl)})},e.getPortalOAuthRedirectUrl=function Cc(e,t,r){void 0===r&&(r={}),r=Object.assign({},Vi,r),e=ga(e);var n=encodeURIComponent(""+r.redirectUrl+r.urlParamsBreak);return N(e,Ui)+"?client_id="+t+"&redirect_uri="+n+"&response_type="+r.responseType},e.getPortalSharingUrl=function wc(e){return N(ga(e),Fi)},e.getPortalUrl=ga,e.removePortalAccessTokenFromHash=va,e.toEsriPortalAccessToken=ya,e.DEFAULT_MAP_QUERY_OPTIONS=qi,e.getMapQueryOptions=Wi,e.toHttpQueryParams=Yi,e.toEsriServerToken=ma,e.tryStripGdbVersion=Qi,e.ExportConfig=Ea,e.DEFAULT_EXPORT_GEOJSON_FILE_NAME=Ia,e.TssExportModule=Sa,e.ExportService=Pa,e.GeolocationConfig=Ma,e.PATH_BUILDER_EMPTY_CALIBRATION_MEASURE_VALUE=null,e.PATH_BUILDER_CALCULATED_M_DEVICE_SOURCE=Ca,e.GEOLOCATOR_REGISTRY=wa,e.GEOLOCATION_GEOLOCATOR_ID=Ta,e.TssGeolocationModule=Na,e.GeolocationService=Ha,e.BaseGeolocator=Oa,e.Geolocatable=La,e.GeolocationGeolocator=ja,e.GeolocatorAccuracyUnit=Ra,e.GeolocatorCapability=_a,e.GeolocatorSourceService=qa,e.gpsPositionToPoint=Fa,e.gpsPositionsAlmostEqual=Ba,e.gpsPositionsToPoint=function Tc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.map(function(e){return Fa(e)})},e.isNotValidLatitude=function Lc(e){return!Ua(e)},e.isNotValidLocation=Va,e.isNotValidLongitude=function Rc(e){return!xa(e)},e.isPositionError=Aa,e.isValidLatitude=Ua,e.isValidLocation=Ga,e.isValidLongitude=xa,e.positionToGpsPosition=Da,e.isPositionAcceptable=ka,e.PositionPathBuilder=Za,e.degreesToRadians=ci,e.getMeasureExtent=Ho,e.isLine=dn,e.isPoint=mn,e.isPolygon=En,e.radiansToDegrees=es,e.setMeasuresByGeometricLength=Qa,e.GeometryConfig=ts,e.SORTED_BY_MEASURE_PROPERTY_FLAG=Ro,e.EARTH_RADIUS_IN_KILOMETERS=Oo,e.EARTH_RADIUS_IN_METERS=6371008.8,e.WGS_84_SRID=Do,e.TssGeometryModule=Ye,e.extractMeasuresFromLine=function Oc(e){var r=[];return gn(e).forEach(function(e){var t=e.map(function(e){return Go(e)});Tt(r,t)}),r},e.flattenLine=yn,e.getDistanceToLine=is,e.getMeasureExtentFromLine=Vo,e.getMeasureFromFlatCoordinateSystem=function Dc(e,t,r){return gi(e,t,Object.assign({coordinateSystem:"flat"},r))},e.getMeasureFromLatLng=function _c(e,t,r,n){return this.getMeasure(e,[r,t],n)},e.getMeasure=gi,e.getVerticeeInfos=as,e.getClosestVerticees=ss,e.getClosestVerticee=function jc(e,t,r){return void 0===r&&(r=!0),S(ss(e,t,r),1)[0]},e.getPoint=ii,e.hasMeasureValues=function Nc(e){return Uo(gn(e))},e.singleLineHasMeasureValues=Fo,e.multiLineHasMeasureValues=Uo,e.isLineWithinBounds=function kc(e,t,r,n){var o=r<e&&t<n,i=r===e&&n===t,a=us(e,t,r),s=us(e,t,n);return o||i||a||s||e===r&&e<=n||t===n&&r<=t},e.isMultiPartLine=hn,e.isPointOnLineString=function Ac(e,t){return ls(e.coordinates[0],ie(e.coordinates),t)},e.isLatLngOnLineString=function Fc(e,t,r){var n=S(e.coordinates[0],2),o=(n[0],n[1],S(ie(e.coordinates),2));o[0];return cs(0,0,o[1])},e.isLatLngOnLine=cs,e.isPointOnLine=ls,e.multiLineToCoordinates=Ao,e.singleLineToCoordinates=ko,e.sortLineByMeasure=xo,e.toLineOrMultiLineString=ui,e.toLineString=si,e.toMultiLineString=ai,e.toMultiPartPaths=gn,e.isPointWithinBounds=function Uc(e,t,r){return e<=r&&r<=t},e.isPointWithinButNotIncludingBounds=us,e.calculateCrossProductByPoints=function xc(e,t,r){var n=S(_o(e),2),o=n[0],i=n[1],a=S(_o(t),2),s=a[0],u=a[1],c=S(_o(r),2);return _r(o,i,s,u,c[0],c[1])},e.getDistanceBetweenPoints=li,e.getDistanceBetweenPointValues=pi,e.getKilometersBetweenLatLng=fi,e.getMetersBetweenLatLng=di,e.getFeetBetweenLatLng=function Gc(e,t,r,n){return hi(e,t,r,n,Yr.Foot)},e.getMilesBetweenLatLng=function Vc(e,t,r,n){return hi(e,t,r,n,Yr.Mile)},e.getDistanceBetweenLatLng=hi,e.getMeasureExtentFromPoint=Bo,e.getMeasureFromPoint=Go,e.isMultiPartPoint=vn,e.getSortResultForPoints=jo,e.sortPointsByMeasure=No,e.toMultiPartPoint=bn,e.toSinglePartPointArray=_o,e.GpsGateGeolocator=fs,e.GpsGateConfig=ps,e.TssGpsGateModule=ds,e.HttpParamInterceptor=ut,e.HttpConfig=st,e.TssHttpModule=ct,e.isRouteMatch=at,e.toFormDataString=Mn,e.toFormData=Si,e.CalibrationPointLayer=hs,e.CapturePosition=gs,e.CenterlineLayer=ys,e.evaluteFeatureDataExpression=ei,e.extractFeatureDataByLayer=Xo,e.extractFeatureData=$o,e.ALL_FIELD_CRITERIA=Ko,e.isDynamicDataExpression=zo,e.DYNAMIC_DATA_REGEX=Qo,e.LrsDataService=ms,e.DataSourceLrsMetadataService=bs,e.EventFeatureCollection=vi,e.EventFeature=ni,e.EventLayer=Is,e.toLrsFeature=function Bc(e,t,r){var n,o=r.getLayerDetail(t);return o.isNetworkLayer?n=new yi(e,o.layer):o.isEventLayer&&(n=new ni(e,o.layer)),n},e.toFeature=oi,e.generateHierarchyFilters=Ss,e.IntersectionLayer=Ps,e.findLayer=Ms,e.LrsFeatureCollection=mi,e.LrsFeature=ri,e.getLayerTableName=function Hc(e,t){void 0===t&&(t=!1);var r=e?e.featureClassName||e.datasetName:null;return t&&(r=Dn(r)),r},e.LrsLayer=Es,e.mergeFieldDomains=Fs,e.mergeFields=Us,e.mergeLayer=xs,e.mergeLayers=Gs,e.mergeNetworkLayers=Vs,e.onMergeNetworkLayerComplete=Bs,e.mergeLrsMetadata=Hs,e.mergeMapMetadata=qs,e.deepMergeMapMetadata=Ws,e.mergeLrsMetadataSources=Ys,e.LrsMetadataRetriever=Qs,e.LRS_LAYER_VALIDATIONS=Ls,e.LRS_NETWORK_LAYER_VALIDATIONS=Rs,e.LRS_EVENT_LAYER_VALIDATIONS=Os,e.LRS_METADATA_VALIDATIONS=Ds,e.LrsMetadataService=zs,e.LrsMetadata=Ns,e.getLrsViewDateWhereStatement=Co,e.NO_TEMPORAL_LAYER_SUPPLIED_ERROR_MSG=Eo,e.NO_REFERENCE_LAYER_SUPPLIED_ERROR_MSG=Io,e.LRS_DATE_WHERE_CLAUSE_TEMPLATE=So,e.LRS_POINT_EVENT_WHERE_CLAUSE_TEMPLATE=Po,e.LRS_LINEAR_EVENT_WHERE_CLAUSE_TEMPLATE=Mo,e.LrsWhereClauseBuilder=wo,e.LrsConfig=vs,e.TssLrsModule=Je,e.NetworkFeatureCollection=bi,e.NetworkFeature=yi,e.NetworkLayer=Cs,e.NonLrsLayer=_s,e.RedlineFeature=Ks,e.RedlineLayer=ws,e.isClassBreakInfoEmpty=Xi,e.isRendererSymbolDefault=Zi,e.DEFAULT_UNIQUE_VALUE_INFO=null,e.DEFAULT_CLASS_BREAK_VALUE_INFO=null,e.DEFAULT_RENDERER_SYMBOL=Ji,e.LayerDrawingInfoRenderer=ea,e.LayerDrawingInfo=ra,e.LAYER_RENDER_TYPES=Ke,e.LayerRendererTypePipe=Xe,e.SYMBOL_LOCATION_TYPES=[{alias:"Left",locationType:"left"},{alias:"Right",locationType:"right"},{alias:"Top",locationType:"top"},{alias:"Bottom",locationType:"bottom"}],e.isUniqueValueInfoEmpty=$i,e.isPointGeometryType=aa,e.isLinearGeometryType=sa,e.isPolygonGeometryType=ua,e.POINT_GEOMETRY_TYPES=na,e.LINEAR_GEOMETRY_TYPES=oa,e.POLYGON_GEOMETRY_TYPES=ia,e.FeatureClassLayer=ca,e.getCodedValue=qo,e.getCodedValueNameOrDefault=Yo,e.getCodedValueName=Wo,e.isFieldGeometryType=eo,e.isObjectIdType=to,e.getGeometryField=ro,e.getGeometryFieldName=no,e.getIdField=oo,e.getIdFieldFieldName=io,e.isFieldExpression=ao,e.toFieldType=so,e.toFieldName=uo,e.getField=co,e.getFieldAlias=lo,e.isFieldNumeric=po,e.isFieldValueNumeric=fo,e.FIELD_TYPE_OID="id",e.FIELD_TYPE_OID_STRING=kn,e.FIELD_TYPE_STRING="string",e.FIELD_TYPE_NUMBER="number",e.FIELD_TYPE_XML="xml",e.FIELD_TYPE_BLOB="blob",e.FIELD_TYPE_DATE="date",e.FIELD_TYPE_DOUBLE="double",e.FIELD_TYPE_GUID="guid",e.FIELD_TYPE_GEOMETRY=An,e.FIELD_TYPE_GLOBALID=Fn,e.FIELD_TYPE_INTEGER=Un,e.FIELD_TYPE_RASTER="raster",e.FIELD_TYPE_SINGLE="single",e.FIELD_TYPE_SMALL_INTEGER="int",e.ESRI_FIELD_TYPE_OID=xn,e.ESRI_FIELD_TYPE_STRING=Gn,e.ESRI_FIELD_TYPE_NUMBER=Vn,e.ESRI_FIELD_TYPE_XML=Bn,e.ESRI_FIELD_TYPE_BLOB=Hn,e.ESRI_FIELD_TYPE_DATE=qn,e.ESRI_FIELD_TYPE_DOUBLE=Wn,e.ESRI_FIELD_TYPE_GUID=Yn,e.ESRI_FIELD_TYPE_GEOMETRY=Qn,e.ESRI_FIELD_TYPE_GLOBALID=zn,e.ESRI_FIELD_TYPE_INTEGER=Kn,e.ESRI_FIELD_TYPE_RASTER=Xn,e.ESRI_FIELD_TYPE_SINGLE=$n,e.ESRI_FIELD_TYPE_SMALL_INTEGER=Jn,e.FIELD_METADATA=Zn,e.MapFeature=ti,e.MapServerMetadata=Ts,e.MapTable=Xs,e.TssMapsModule=$e,e.MapsConfig=$s,e.toLayerId=zi,e.FIELD_QUOTE='"',e.CriteriaOperator=ho,e.TargetOperator=go,e.ValueOperator=yo,e.GroupingOperator={OpenParenthesis:"(",ClosedParenthesis:")",Parenthesis:"()"},e.CombiningOperator=mo,e.DefaultWhereClauseBuilderOptions=vo,e.WhereClauseBuilder=bo,e.DeviceMotionService=Zs,e.MotionConfig=Js,e.TssMotionModule=eu,e.DeviceOrientationService=nu,e.getHeadingFromOrientation=tu,e.OrientationConfig=ru,e.TssOrientationModule=ou,e.TssPolyfillModule=nt,e.PreventDefaultLinkDirective=rt,e.QueuableWorkQueueManager=lu,e.QueueItemStatus=pu,e.QueueWorkerToken=iu,e.QueueConfig=fu,e.TssQueueModule=ot,e.DEFAULT_WORK_QUEUE_OPTIONS=uu,e.WorkQueueManager=cu,e.WorkQueueStatusEventType=au,e.WorkQueueStatusTracker=su,e.SignInState=be,e.AuthService=Ee,e.HasRolesDirective=et,e.PrivilegeService=du,e.RoleManagerService=ve,e.MISSING_PRIVILEGE_PARAM_EXCEPTION_MSG=gu,e.RolePrivilegeService=yu,e.RoleService=mu,e.MISSING_ROLE_PARAM_EXCEPTION_MSG=hu,e.UserRoleService=bu,e.SecurityConfig=ge,e.MISSING_USER_PARAM_EXCEPTION_MSG=vu,e.TssSecurityModule=tt,e.TokenInterceptor=Ze,e.UserService=Eu,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=tss-sdk.umd.min.js.map