/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { isDynamicDataExpression, DYNAMIC_DATA_REGEX } from './is-dynamic-data-expression.function';
import { extractFeatureDataByLayer } from './extract-feature-data.function';
import { isNumber } from 'util';
import { sumValues } from '../../core/stats/sum-values.function';
import { average } from '../../core/stats/average.function';
import { isObject } from '../../core/type-check/is-object.function';
import { extractTokenExpressions } from '../../core/tokens/extract-token-expressions.function';
import { replaceToken } from '../../core/tokens/replace-token.function';
import { format } from '../../core/formatting/format.function';
/**
 * @param {?} dataValues
 * @return {?}
 */
function dataValuesToNumbers(dataValues) {
    return dataValues
        .filter((/**
     * @param {?} value
     * @return {?}
     */
    value => isNumber(value)))
        .map((/**
     * @param {?} value
     * @return {?}
     */
    value => Number(value)));
}
/**
 * @param {?} expression
 * @param {...?} features
 * @return {?}
 */
function evaluateSingleDynamicDataExpression(expression, ...features) {
    /** @type {?} */
    const parsedValue = expression.match(DYNAMIC_DATA_REGEX);
    /** @type {?} */
    let expressionValue;
    if (parsedValue && parsedValue.length > 2) {
        /** @type {?} */
        const layerId = Number(parsedValue[1]);
        /** @type {?} */
        const field = parsedValue[2];
        /** @type {?} */
        const subsetKeyword = (/** @type {?} */ ((parsedValue[3] || 'first').toLocaleLowerCase()));
        /** @type {?} */
        const dataValues = extractFeatureDataByLayer(layerId, field, ...features);
        if (subsetKeyword === 'first') {
            expressionValue = dataValues[0];
        }
        else if (subsetKeyword === 'last') {
            expressionValue = dataValues[dataValues.length - 1];
        }
        else if (subsetKeyword === 'sum' || subsetKeyword === 'add') {
            /** @type {?} */
            const numberValues = dataValuesToNumbers(dataValues);
            expressionValue = sumValues(numberValues);
        }
        else if (subsetKeyword === 'avg' || subsetKeyword === 'average') {
            /** @type {?} */
            const numberValues = dataValuesToNumbers(dataValues);
            expressionValue = average(numberValues);
        }
        else if (subsetKeyword === 'concat') {
            expressionValue = dataValues.join(', ');
        }
        else if (subsetKeyword === 'min') {
            /** @type {?} */
            const numberValues = dataValuesToNumbers(dataValues);
            expressionValue = Math.min(...numberValues);
        }
        else if (subsetKeyword === 'max') {
            /** @type {?} */
            const numberValues = dataValuesToNumbers(dataValues);
            expressionValue = Math.max(...numberValues);
        }
        else {
            throw new Error(`Unsupported dynamic data expression subset keyword '${subsetKeyword}'`);
        }
        return isObject(expressionValue)
            ? JSON.stringify(expressionValue)
            : String(expressionValue);
    }
}
/**
 * @param {?} expression
 * @param {...?} features
 * @return {?}
 */
function evaluateDynamicDataExpression(expression, ...features) {
    /** @type {?} */
    const tokenExpressions = extractTokenExpressions(expression);
    /** @type {?} */
    let evaluationResult = expression;
    tokenExpressions
        .filter((/**
     * @param {?} tokenExpression
     * @return {?}
     */
    tokenExpression => isDynamicDataExpression(tokenExpression)))
        .forEach((/**
     * @param {?} tokenExpression
     * @return {?}
     */
    tokenExpression => {
        /** @type {?} */
        const value = evaluateSingleDynamicDataExpression(tokenExpression, ...features);
        evaluationResult = replaceToken(evaluationResult, tokenExpression, value);
    }));
    return evaluationResult;
}
/**
 * @param {?} expression
 * @param {...?} features
 * @return {?}
 */
export function evaluteFeatureDataExpression(expression, ...features) {
    /** @type {?} */
    const evaluationResult = evaluateDynamicDataExpression(expression, ...features);
    /** @type {?} */
    const firstFeatureProperties = features && features.length
        ? features[0].properties
        : {};
    /** @type {?} */
    const replaceTokens = Object.assign({}, firstFeatureProperties, {
        RecordCount: features.length,
    });
    return format(evaluationResult, replaceTokens);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXZhbHVhdGUtZmVhdHVyZS1kYXRhLWV4cHJlc3Npb24uZnVuY3Rpb24uanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AdHNzL3Nkay8iLCJzb3VyY2VzIjpbImxpYi9scnMvZGF0YS9ldmFsdWF0ZS1mZWF0dXJlLWRhdGEtZXhwcmVzc2lvbi5mdW5jdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLHVCQUF1QixFQUFFLGtCQUFrQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDcEcsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFDNUUsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUVoQyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFDakUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBQzVELE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUNwRSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSxzREFBc0QsQ0FBQztBQUMvRixPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sMENBQTBDLENBQUM7QUFDeEUsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLHVDQUF1QyxDQUFDOzs7OztBQUkvRCxTQUFTLG1CQUFtQixDQUFDLFVBQWlCO0lBQzVDLE9BQU8sVUFBVTtTQUNkLE1BQU07Ozs7SUFBQyxLQUFLLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBQztTQUNoQyxHQUFHOzs7O0lBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUMsQ0FBQztBQUNqQyxDQUFDOzs7Ozs7QUFFRCxTQUFTLG1DQUFtQyxDQUFDLFVBQWtCLEVBQUUsR0FBRyxRQUFzQjs7VUFDbEYsV0FBVyxHQUFHLFVBQVUsQ0FBQyxLQUFLLENBQUMsa0JBQWtCLENBQUM7O1FBQ3BELGVBQW1C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Q3pFLHNCQUFzQixHQUFHLFFBQVEsSUFBSSxRQUFRLENBQUMsTUFBTTtRQUN4RCxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVU7UUFDeEIsQ0FBQyxDQUFDLEVBQUU7O1VBRUEsYUFBYSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLHNCQUFzQixFQUFFO1FBQzlELFdBQVcsRUFBRSxRQUFRLENBQUMsTUFBTTtLQUM3QixDQUFDO0lBRUYsT0FBTyxNQUFNLENBQUMsZ0JBQWdCLEVBQUUsYUFBYSxDQUFDLENBQUM7QUFDakQsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzRHluYW1pY0RhdGFFeHByZXNzaW9uLCBEWU5BTUlDX0RBVEFfUkVHRVggfSBmcm9tICcuL2lzLWR5bmFtaWMtZGF0YS1leHByZXNzaW9uLmZ1bmN0aW9uJztcbmltcG9ydCB7IGV4dHJhY3RGZWF0dXJlRGF0YUJ5TGF5ZXIgfSBmcm9tICcuL2V4dHJhY3QtZmVhdHVyZS1kYXRhLmZ1bmN0aW9uJztcbmltcG9ydCB7IGlzTnVtYmVyIH0gZnJvbSAndXRpbCc7XG5pbXBvcnQgeyBNYXBGZWF0dXJlIH0gZnJvbSAnLi4vLi4vbWFwcy9tYXAtZmVhdHVyZSc7XG5pbXBvcnQgeyBzdW1WYWx1ZXMgfSBmcm9tICcuLi8uLi9jb3JlL3N0YXRzL3N1bS12YWx1ZXMuZnVuY3Rpb24nO1xuaW1wb3J0IHsgYXZlcmFnZSB9IGZyb20gJy4uLy4uL2NvcmUvc3RhdHMvYXZlcmFnZS5mdW5jdGlvbic7XG5pbXBvcnQgeyBpc09iamVjdCB9IGZyb20gJy4uLy4uL2NvcmUvdHlwZS1jaGVjay9pcy1vYmplY3QuZnVuY3Rpb24nO1xuaW1wb3J0IHsgZXh0cmFjdFRva2VuRXhwcmVzc2lvbnMgfSBmcm9tICcuLi8uLi9jb3JlL3Rva2Vucy9leHRyYWN0LXRva2VuLWV4cHJlc3Npb25zLmZ1bmN0aW9uJztcbmltcG9ydCB7IHJlcGxhY2VUb2tlbiB9IGZyb20gJy4uLy4uL2NvcmUvdG9rZW5zL3JlcGxhY2UtdG9rZW4uZnVuY3Rpb24nO1xuaW1wb3J0IHsgZm9ybWF0IH0gZnJvbSAnLi4vLi4vY29yZS9mb3JtYXR0aW5nL2Zvcm1hdC5mdW5jdGlvbic7XG5cbmV4cG9ydCB0eXBlIER5bmFtaWNEYXRhU3Vic2V0S2V5d29yZCA9ICdmaXJzdCcgfCAnbGFzdCcgfCAnc3VtJyB8ICdhZGQnIHwgJ2F2ZycgfCAnYXZlcmFnZScgfCAnY29uY2F0JztcblxuZnVuY3Rpb24gZGF0YVZhbHVlc1RvTnVtYmVycyhkYXRhVmFsdWVzOiBhbnlbXSk6IG51bWJlcltdIHtcbiAgcmV0dXJuIGRhdGFWYWx1ZXNcbiAgICAuZmlsdGVyKHZhbHVlID0+IGlzTnVtYmVyKHZhbHVlKSlcbiAgICAubWFwKHZhbHVlID0+IE51bWJlcih2YWx1ZSkpO1xufVxuXG5mdW5jdGlvbiBldmFsdWF0ZVNpbmdsZUR5bmFtaWNEYXRhRXhwcmVzc2lvbihleHByZXNzaW9uOiBzdHJpbmcsIC4uLmZlYXR1cmVzOiBNYXBGZWF0dXJlW10pOiBzdHJpbmcgfCAnJyB7XG4gIGNvbnN0IHBhcnNlZFZhbHVlID0gZXhwcmVzc2lvbi5tYXRjaChEWU5BTUlDX0RBVEFfUkVHRVgpO1xuICBsZXQgZXhwcmVzc2lvblZhbHVlOiB7fTtcblxuICBpZiAocGFyc2VkVmFsdWUgJiYgcGFyc2VkVmFsdWUubGVuZ3RoID4gMikge1xuICAgIGNvbnN0IGxheWVySWQgPSBOdW1iZXIocGFyc2VkVmFsdWVbMV0pO1xuICAgIGNvbnN0IGZpZWxkID0gcGFyc2VkVmFsdWVbMl07XG4gICAgY29uc3Qgc3Vic2V0S2V5d29yZDogRHluYW1pY0RhdGFTdWJzZXRLZXl3b3JkID0gKHBhcnNlZFZhbHVlWzNdIHx8ICdmaXJzdCcpLnRvTG9jYWxlTG93ZXJDYXNlKCkgYXMgRHluYW1pY0RhdGFTdWJzZXRLZXl3b3JkO1xuICAgIGNvbnN0IGRhdGFWYWx1ZXMgPSBleHRyYWN0RmVhdHVyZURhdGFCeUxheWVyKGxheWVySWQsIGZpZWxkLCAuLi5mZWF0dXJlcyk7XG5cbiAgICBpZiAoc3Vic2V0S2V5d29yZCA9PT0gJ2ZpcnN0Jykge1xuICAgICAgZXhwcmVzc2lvblZhbHVlID0gZGF0YVZhbHVlc1swXTtcbiAgICB9IGVsc2UgaWYgKHN1YnNldEtleXdvcmQgPT09ICdsYXN0Jykge1xuICAgICAgZXhwcmVzc2lvblZhbHVlID0gZGF0YVZhbHVlc1tkYXRhVmFsdWVzLmxlbmd0aCAtIDFdO1xuICAgIH0gZWxzZSBpZiAoc3Vic2V0S2V5d29yZCA9PT0gJ3N1bScgfHwgc3Vic2V0S2V5d29yZCA9PT0gJ2FkZCcpIHtcbiAgICAgIGNvbnN0IG51bWJlclZhbHVlcyA9IGRhdGFWYWx1ZXNUb051bWJlcnMoZGF0YVZhbHVlcyk7XG4gICAgICBleHByZXNzaW9uVmFsdWUgPSBzdW1WYWx1ZXMobnVtYmVyVmFsdWVzKTtcbiAgICB9IGVsc2UgaWYgKHN1YnNldEtleXdvcmQgPT09ICdhdmcnIHx8IHN1YnNldEtleXdvcmQgPT09ICdhdmVyYWdlJykge1xuICAgICAgY29uc3QgbnVtYmVyVmFsdWVzID0gZGF0YVZhbHVlc1RvTnVtYmVycyhkYXRhVmFsdWVzKTtcbiAgICAgIGV4cHJlc3Npb25WYWx1ZSA9IGF2ZXJhZ2UobnVtYmVyVmFsdWVzKTtcbiAgICB9IGVsc2UgaWYgKHN1YnNldEtleXdvcmQgPT09ICdjb25jYXQnKSB7XG4gICAgICBleHByZXNzaW9uVmFsdWUgPSBkYXRhVmFsdWVzLmpvaW4oJywgJyk7XG4gICAgfSBlbHNlIGlmIChzdWJzZXRLZXl3b3JkID09PSAnbWluJykge1xuICAgICAgY29uc3QgbnVtYmVyVmFsdWVzID0gZGF0YVZhbHVlc1RvTnVtYmVycyhkYXRhVmFsdWVzKTtcbiAgICAgIGV4cHJlc3Npb25WYWx1ZSA9IE1hdGgubWluKC4uLm51bWJlclZhbHVlcyk7XG4gICAgfSBlbHNlIGlmIChzdWJzZXRLZXl3b3JkID09PSAnbWF4Jykge1xuICAgICAgY29uc3QgbnVtYmVyVmFsdWVzID0gZGF0YVZhbHVlc1RvTnVtYmVycyhkYXRhVmFsdWVzKTtcbiAgICAgIGV4cHJlc3Npb25WYWx1ZSA9IE1hdGgubWF4KC4uLm51bWJlclZhbHVlcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgZHluYW1pYyBkYXRhIGV4cHJlc3Npb24gc3Vic2V0IGtleXdvcmQgJyR7c3Vic2V0S2V5d29yZH0nYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGlzT2JqZWN0KGV4cHJlc3Npb25WYWx1ZSlcbiAgICAgID8gSlNPTi5zdHJpbmdpZnkoZXhwcmVzc2lvblZhbHVlKVxuICAgICAgOiBTdHJpbmcoZXhwcmVzc2lvblZhbHVlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBldmFsdWF0ZUR5bmFtaWNEYXRhRXhwcmVzc2lvbihleHByZXNzaW9uOiBzdHJpbmcsIC4uLmZlYXR1cmVzOiBNYXBGZWF0dXJlW10pOiBzdHJpbmcgfCAnJyB7XG4gIGNvbnN0IHRva2VuRXhwcmVzc2lvbnMgPSBleHRyYWN0VG9rZW5FeHByZXNzaW9ucyhleHByZXNzaW9uKTtcbiAgbGV0IGV2YWx1YXRpb25SZXN1bHQgPSBleHByZXNzaW9uO1xuXG4gIHRva2VuRXhwcmVzc2lvbnNcbiAgICAuZmlsdGVyKHRva2VuRXhwcmVzc2lvbiA9PiBpc0R5bmFtaWNEYXRhRXhwcmVzc2lvbih0b2tlbkV4cHJlc3Npb24pKVxuICAgIC5mb3JFYWNoKHRva2VuRXhwcmVzc2lvbiA9PiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGV2YWx1YXRlU2luZ2xlRHluYW1pY0RhdGFFeHByZXNzaW9uKHRva2VuRXhwcmVzc2lvbiwgLi4uZmVhdHVyZXMpO1xuICAgICAgZXZhbHVhdGlvblJlc3VsdCA9IHJlcGxhY2VUb2tlbihldmFsdWF0aW9uUmVzdWx0LCB0b2tlbkV4cHJlc3Npb24sIHZhbHVlKTtcbiAgICB9KTtcblxuICByZXR1cm4gZXZhbHVhdGlvblJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV2YWx1dGVGZWF0dXJlRGF0YUV4cHJlc3Npb24oZXhwcmVzc2lvbjogc3RyaW5nLCAuLi5mZWF0dXJlczogTWFwRmVhdHVyZVtdKTogc3RyaW5nIHtcbiAgY29uc3QgZXZhbHVhdGlvblJlc3VsdCA9IGV2YWx1YXRlRHluYW1pY0RhdGFFeHByZXNzaW9uKGV4cHJlc3Npb24sIC4uLmZlYXR1cmVzKTtcbiAgY29uc3QgZmlyc3RGZWF0dXJlUHJvcGVydGllcyA9IGZlYXR1cmVzICYmIGZlYXR1cmVzLmxlbmd0aFxuICAgID8gZmVhdHVyZXNbMF0ucHJvcGVydGllc1xuICAgIDoge307XG5cbiAgY29uc3QgcmVwbGFjZVRva2VucyA9IE9iamVjdC5hc3NpZ24oe30sIGZpcnN0RmVhdHVyZVByb3BlcnRpZXMsIHtcbiAgICBSZWNvcmRDb3VudDogZmVhdHVyZXMubGVuZ3RoLFxuICB9KTtcblxuICByZXR1cm4gZm9ybWF0KGV2YWx1YXRpb25SZXN1bHQsIHJlcGxhY2VUb2tlbnMpO1xufVxuIl19